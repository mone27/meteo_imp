<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.242">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="code for plotting results and comparing with MDS and ERA gap filling">

<title>meteo_imp - Results</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="meteo_imp - Results">
<meta property="og:description" content="code for plotting results and comparing with MDS and ERA gap filling">
<meta property="og:site-name" content="meteo_imp">
<meta name="twitter:title" content="meteo_imp - Results">
<meta name="twitter:description" content="code for plotting results and comparing with MDS and ERA gap filling">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">meteo_imp</span>
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./results.html">Results</a></li></ol></nav>
      <a class="flex-grow-1" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GPFA Imputation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Distributions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kalman_filter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kalman Filter</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./training.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Implement Kalman model using FastAI</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./filter_performance_stability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Filter Perfomance and Stability</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./results.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Results</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./utils.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Utils</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Fluxnet</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Fluxnet/gap_finder.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Find Gaps in Fluxnet data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Fluxnet/hainich.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fluxnet Hainich</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#imputation-methods" id="toc-imputation-methods" class="nav-link active" data-scroll-target="#imputation-methods">Imputation Methods</a>
  <ul class="collapse">
  <li><a href="#kalman-filter" id="toc-kalman-filter" class="nav-link" data-scroll-target="#kalman-filter">Kalman Filter</a></li>
  <li><a href="#predictlossvar" id="toc-predictlossvar" class="nav-link" data-scroll-target="#predictlossvar">PredictLossVar</a></li>
  <li><a href="#predictlikelihoodvar" id="toc-predictlikelihoodvar" class="nav-link" data-scroll-target="#predictlikelihoodvar">PredictLikelihoodVar</a></li>
  <li><a href="#multimetrics" id="toc-multimetrics" class="nav-link" data-scroll-target="#multimetrics">MultiMetrics</a></li>
  <li><a href="#kalmanimputation-1" id="toc-kalmanimputation-1" class="nav-link" data-scroll-target="#kalmanimputation-1">KalmanImputation</a></li>
  <li><a href="#kalmanimputationvar" id="toc-kalmanimputationvar" class="nav-link" data-scroll-target="#kalmanimputationvar">KalmanImputationVar</a></li>
  <li><a href="#mds" id="toc-mds" class="nav-link" data-scroll-target="#mds">MDS</a></li>
  <li><a href="#importr_install" id="toc-importr_install" class="nav-link" data-scroll-target="#importr_install">importr_install</a></li>
  <li><a href="#setupr" id="toc-setupr" class="nav-link" data-scroll-target="#setupr">setupR</a></li>
  <li><a href="#r2pd" id="toc-r2pd" class="nav-link" data-scroll-target="#r2pd">R2pd</a></li>
  <li><a href="#pd2r" id="toc-pd2r" class="nav-link" data-scroll-target="#pd2r">pd2R</a></li>
  <li><a href="#add_buffer" id="toc-add_buffer" class="nav-link" data-scroll-target="#add_buffer">add_buffer</a></li>
  <li><a href="#item2reddy" id="toc-item2reddy" class="nav-link" data-scroll-target="#item2reddy">item2REddy</a></li>
  <li><a href="#gap_fill_item" id="toc-gap_fill_item" class="nav-link" data-scroll-target="#gap_fill_item">gap_fill_item</a></li>
  <li><a href="#mdsimputation-1" id="toc-mdsimputation-1" class="nav-link" data-scroll-target="#mdsimputation-1">MDSImputation</a></li>
  <li><a href="#era-imputation" id="toc-era-imputation" class="nav-link" data-scroll-target="#era-imputation">ERA Imputation</a></li>
  <li><a href="#eraimputation" id="toc-eraimputation" class="nav-link" data-scroll-target="#eraimputation">ERAImputation</a></li>
  </ul></li>
  <li><a href="#metrics" id="toc-metrics" class="nav-link" data-scroll-target="#metrics">Metrics</a>
  <ul class="collapse">
  <li><a href="#maskedmetric" id="toc-maskedmetric" class="nav-link" data-scroll-target="#maskedmetric">MaskedMetric</a></li>
  <li><a href="#rmse" id="toc-rmse" class="nav-link" data-scroll-target="#rmse">rmse</a></li>
  <li><a href="#normalizedmetric" id="toc-normalizedmetric" class="nav-link" data-scroll-target="#normalizedmetric">NormalizedMetric</a></li>
  <li><a href="#normalize" id="toc-normalize" class="nav-link" data-scroll-target="#normalize">normalize</a></li>
  <li><a href="#validation-imputations" id="toc-validation-imputations" class="nav-link" data-scroll-target="#validation-imputations">Validation Imputations</a></li>
  </ul></li>
  <li><a href="#comparison" id="toc-comparison" class="nav-link" data-scroll-target="#comparison">Comparison</a>
  <ul class="collapse">
  <li><a href="#prep-visualization" id="toc-prep-visualization" class="nav-link" data-scroll-target="#prep-visualization">prep visualization</a></li>
  <li><a href="#gaplen2hours" id="toc-gaplen2hours" class="nav-link" data-scroll-target="#gaplen2hours">gaplen2hours</a></li>
  <li><a href="#prep_df" id="toc-prep_df" class="nav-link" data-scroll-target="#prep_df">prep_df</a></li>
  <li><a href="#aggregation" id="toc-aggregation" class="nav-link" data-scroll-target="#aggregation">Aggregation</a></li>
  <li><a href="#rmseagg" id="toc-rmseagg" class="nav-link" data-scroll-target="#rmseagg">RMSEAgg</a></li>
  <li><a href="#timeseriesagg" id="toc-timeseriesagg" class="nav-link" data-scroll-target="#timeseriesagg">timeseriesAgg</a></li>
  <li><a href="#imp-methods" id="toc-imp-methods" class="nav-link" data-scroll-target="#imp-methods">Imp Methods</a></li>
  <li><a href="#impcomparison" id="toc-impcomparison" class="nav-link" data-scroll-target="#impcomparison">ImpComparison</a></li>
  <li><a href="#l_model" id="toc-l_model" class="nav-link" data-scroll-target="#l_model">l_model</a></li>
  <li><a href="#kalman-filters" id="toc-kalman-filters" class="nav-link" data-scroll-target="#kalman-filters">Kalman Filters</a></li>
  <li><a href="#kalmanimpcomparison" id="toc-kalmanimpcomparison" class="nav-link" data-scroll-target="#kalmanimpcomparison">KalmanImpComparison</a></li>
  <li><a href="#l_model-1" id="toc-l_model-1" class="nav-link" data-scroll-target="#l_model-1">l_model</a></li>
  </ul></li>
  <li><a href="#plotting" id="toc-plotting" class="nav-link" data-scroll-target="#plotting">Plotting</a>
  <ul class="collapse">
  <li><a href="#facet_wrap" id="toc-facet_wrap" class="nav-link" data-scroll-target="#facet_wrap">facet_wrap</a></li>
  <li><a href="#facet_grid" id="toc-facet_grid" class="nav-link" data-scroll-target="#facet_grid">facet_grid</a></li>
  <li><a href="#the-plot" id="toc-the-plot" class="nav-link" data-scroll-target="#the-plot">The Plot</a></li>
  <li><a href="#the_plot" id="toc-the_plot" class="nav-link" data-scroll-target="#the_plot">the_plot</a></li>
  <li><a href="#the_plot_stand" id="toc-the_plot_stand" class="nav-link" data-scroll-target="#the_plot_stand">the_plot_stand</a></li>
  <li><a href="#the_plot_stand2" id="toc-the_plot_stand2" class="nav-link" data-scroll-target="#the_plot_stand2">the_plot_stand2</a></li>
  <li><a href="#custom_boxplot_nooutlier" id="toc-custom_boxplot_nooutlier" class="nav-link" data-scroll-target="#custom_boxplot_nooutlier">custom_boxplot_nooutlier</a></li>
  <li><a href="#the_plot_stand3" id="toc-the_plot_stand3" class="nav-link" data-scroll-target="#the_plot_stand3">the_plot_stand3</a></li>
  <li><a href="#gap-length" id="toc-gap-length" class="nav-link" data-scroll-target="#gap-length">Gap Length</a></li>
  <li><a href="#agg_gap_len" id="toc-agg_gap_len" class="nav-link" data-scroll-target="#agg_gap_len">agg_gap_len</a></li>
  <li><a href="#plot_gap_len" id="toc-plot_gap_len" class="nav-link" data-scroll-target="#plot_gap_len">plot_gap_len</a></li>
  <li><a href="#control" id="toc-control" class="nav-link" data-scroll-target="#control">Control</a></li>
  <li><a href="#plot_compare" id="toc-plot_compare" class="nav-link" data-scroll-target="#plot_compare">plot_compare</a></li>
  <li><a href="#plot_control" id="toc-plot_control" class="nav-link" data-scroll-target="#plot_control">plot_control</a></li>
  <li><a href="#plot_control_loss" id="toc-plot_control_loss" class="nav-link" data-scroll-target="#plot_control_loss">plot_control_loss</a></li>
  <li><a href="#plot_control_lh" id="toc-plot_control_lh" class="nav-link" data-scroll-target="#plot_control_lh">plot_control_lh</a></li>
  <li><a href="#gap-multiple-variables" id="toc-gap-multiple-variables" class="nav-link" data-scroll-target="#gap-multiple-variables">Gap Multiple variables</a></li>
  <li><a href="#plot_other_var" id="toc-plot_other_var" class="nav-link" data-scroll-target="#plot_other_var">plot_other_var</a></li>
  <li><a href="#single-var-vs-generic" id="toc-single-var-vs-generic" class="nav-link" data-scroll-target="#single-var-vs-generic">Single var vs Generic</a></li>
  <li><a href="#l_model-2" id="toc-l_model-2" class="nav-link" data-scroll-target="#l_model-2">l_model</a></li>
  <li><a href="#plot_generic" id="toc-plot_generic" class="nav-link" data-scroll-target="#plot_generic">plot_generic</a></li>
  <li><a href="#short-gaps-vs-generic" id="toc-short-gaps-vs-generic" class="nav-link" data-scroll-target="#short-gaps-vs-generic">Short gaps vs Generic</a></li>
  <li><a href="#timeseries" id="toc-timeseries" class="nav-link" data-scroll-target="#timeseries">Timeseries</a></li>
  <li><a href="#unnest_predictions" id="toc-unnest_predictions" class="nav-link" data-scroll-target="#unnest_predictions">unnest_predictions</a></li>
  <li><a href="#plot_timeseries" id="toc-plot_timeseries" class="nav-link" data-scroll-target="#plot_timeseries">plot_timeseries</a></li>
  <li><a href="#scatter-plot" id="toc-scatter-plot" class="nav-link" data-scroll-target="#scatter-plot">Scatter plot</a></li>
  </ul></li>
  <li><a href="#table" id="toc-table" class="nav-link" data-scroll-target="#table">Table</a>
  <ul class="collapse">
  <li><a href="#the-table" id="toc-the-table" class="nav-link" data-scroll-target="#the-table">The Table</a></li>
  <li><a href="#style_the_table" id="toc-style_the_table" class="nav-link" data-scroll-target="#style_the_table">style_the_table</a></li>
  <li><a href="#highlight_min_method" id="toc-highlight_min_method" class="nav-link" data-scroll-target="#highlight_min_method">highlight_min_method</a></li>
  <li><a href="#the_table" id="toc-the_table" class="nav-link" data-scroll-target="#the_table">the_table</a></li>
  <li><a href="#the_table_latex" id="toc-the_table_latex" class="nav-link" data-scroll-target="#the_table_latex">the_table_latex</a></li>
  <li><a href="#table-compare" id="toc-table-compare" class="nav-link" data-scroll-target="#table-compare">Table compare</a></li>
  <li><a href="#table_compare" id="toc-table_compare" class="nav-link" data-scroll-target="#table_compare">table_compare</a></li>
  <li><a href="#table_compare_latex" id="toc-table_compare_latex" class="nav-link" data-scroll-target="#table_compare_latex">table_compare_latex</a></li>
  <li><a href="#table-gap-single" id="toc-table-gap-single" class="nav-link" data-scroll-target="#table-gap-single">Table gap single</a></li>
  <li><a href="#table_compare3" id="toc-table_compare3" class="nav-link" data-scroll-target="#table_compare3">table_compare3</a></li>
  <li><a href="#table_compare3_latex" id="toc-table_compare3_latex" class="nav-link" data-scroll-target="#table_compare3_latex">table_compare3_latex</a></li>
  <li><a href="#gap-len-table" id="toc-gap-len-table" class="nav-link" data-scroll-target="#gap-len-table">Gap len table</a></li>
  <li><a href="#table_gap_len" id="toc-table_gap_len" class="nav-link" data-scroll-target="#table_gap_len">table_gap_len</a></li>
  <li><a href="#table_gap_len_latex" id="toc-table_gap_len_latex" class="nav-link" data-scroll-target="#table_gap_len_latex">table_gap_len_latex</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/mone27/meteo_imp/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Results</h1>
</div>

<div>
  <div class="description">
    code for plotting results and comparing with MDS and ERA gap filling
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> altair <span class="im">as</span> alt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> altair</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>load data for testing</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>reset_seed()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>hai <span class="op">=</span> pd.read_parquet(hai_big_path)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>hai_era <span class="op">=</span> pd.read_parquet(hai_era_big_path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> imp_dataloader(hai, hai_era, var_sel <span class="op">=</span> <span class="st">'TA'</span>, gap_len<span class="op">=</span><span class="dv">5</span>, block_len<span class="op">=</span><span class="dv">100</span>, control_lags <span class="op">=</span> [<span class="dv">1</span>], n_rep<span class="op">=</span><span class="dv">1</span>, bs<span class="op">=</span><span class="dv">1</span>).cpu()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>item <span class="op">=</span> MeteoImpItem(<span class="dv">1</span>,<span class="dv">2</span>, <span class="st">'TA'</span>, gap_len<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>items <span class="op">=</span> [item]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>targ <span class="op">=</span> orig_target(dls, items)[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">input</span>, _ <span class="op">=</span> one_batch_with_items(dls, items)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="imputation-methods" class="level2">
<h2 class="anchored" data-anchor-id="imputation-methods">Imputation Methods</h2>
<section id="kalman-filter" class="level3">
<h3 class="anchored" data-anchor-id="kalman-filter">Kalman Filter</h3>
<p>take a <code>MeteoImp Df</code> and gap fill it using the given model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> torch.load(here(<span class="st">"analysis/results/trained_13feb/1_gap_varying_12-336_v1.pickle"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>preds, targs <span class="op">=</span> predict_items(model, dls<span class="op">=</span>dls, items <span class="op">=</span> items)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>preds[<span class="dv">0</span>].mean[targs[<span class="dv">0</span>].mask] <span class="op">=</span> targs[<span class="dv">0</span>].data[targs[<span class="dv">0</span>].mask]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="kalmanimputation" class="level4">
<h4 class="anchored" data-anchor-id="kalmanimputation">KalmanImputation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>_n_tuple</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;function meteo_imp.kalman.fastai._n_tuple(x, n, unsqueeze=True)&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="bu">input</span>[<span class="dv">1</span>].shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>torch.Size([1, 100, 9])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>preds_raw <span class="op">=</span> model(<span class="bu">input</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(preds_raw.mean[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>10</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>_extract_var(preds_raw.mean, <span class="dv">1</span>, <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[[tensor([-0.7555], dtype=torch.float64, grad_fn=&lt;IndexBackward0&gt;),
  tensor([-0.7765], dtype=torch.float64, grad_fn=&lt;IndexBackward0&gt;),
  tensor([-0.8153], dtype=torch.float64, grad_fn=&lt;IndexBackward0&gt;),
  tensor([-0.8653], dtype=torch.float64, grad_fn=&lt;IndexBackward0&gt;),
  tensor([-0.8660], dtype=torch.float64, grad_fn=&lt;IndexBackward0&gt;),
  tensor([-0.8712], dtype=torch.float64, grad_fn=&lt;IndexBackward0&gt;),
  tensor([-0.8551], dtype=torch.float64, grad_fn=&lt;IndexBackward0&gt;),
  tensor([-0.8420], dtype=torch.float64, grad_fn=&lt;IndexBackward0&gt;),
  tensor([-0.8442], dtype=torch.float64, grad_fn=&lt;IndexBackward0&gt;),
  tensor([-0.8536], dtype=torch.float64, grad_fn=&lt;IndexBackward0&gt;)]]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>_extract_var(preds_raw.cov, <span class="dv">1</span>, <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[[tensor([[0.0227]], dtype=torch.float64, grad_fn=&lt;IndexBackward0&gt;),
  tensor([[0.0307]], dtype=torch.float64, grad_fn=&lt;IndexBackward0&gt;),
  tensor([[0.0359]], dtype=torch.float64, grad_fn=&lt;IndexBackward0&gt;),
  tensor([[0.0392]], dtype=torch.float64, grad_fn=&lt;IndexBackward0&gt;),
  tensor([[0.0409]], dtype=torch.float64, grad_fn=&lt;IndexBackward0&gt;),
  tensor([[0.0409]], dtype=torch.float64, grad_fn=&lt;IndexBackward0&gt;),
  tensor([[0.0393]], dtype=torch.float64, grad_fn=&lt;IndexBackward0&gt;),
  tensor([[0.0361]], dtype=torch.float64, grad_fn=&lt;IndexBackward0&gt;),
  tensor([[0.0310]], dtype=torch.float64, grad_fn=&lt;IndexBackward0&gt;),
  tensor([[0.0230]], dtype=torch.float64, grad_fn=&lt;IndexBackward0&gt;)]]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>items_all <span class="op">=</span> [MeteoImpItem(<span class="dv">1</span>,<span class="dv">2</span>, <span class="bu">list</span>(hai.columns), gap_len<span class="op">=</span><span class="dv">3</span>)] <span class="op">*</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>input_all, _ <span class="op">=</span> one_batch_with_items(dls, items_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>preds_raw_all <span class="op">=</span> model(input_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>_extract_var(preds_raw_all.mean, <span class="dv">3</span>, <span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[[tensor([-0.5650], dtype=torch.float64, grad_fn=&lt;SliceBackward0&gt;),
  tensor([-0.5887], dtype=torch.float64, grad_fn=&lt;SliceBackward0&gt;),
  tensor([-0.6259], dtype=torch.float64, grad_fn=&lt;SliceBackward0&gt;)],
 [tensor([-0.5650], dtype=torch.float64, grad_fn=&lt;SliceBackward0&gt;),
  tensor([-0.5887], dtype=torch.float64, grad_fn=&lt;SliceBackward0&gt;),
  tensor([-0.6259], dtype=torch.float64, grad_fn=&lt;SliceBackward0&gt;)],
 [tensor([-0.5650], dtype=torch.float64, grad_fn=&lt;SliceBackward0&gt;),
  tensor([-0.5887], dtype=torch.float64, grad_fn=&lt;SliceBackward0&gt;),
  tensor([-0.6259], dtype=torch.float64, grad_fn=&lt;SliceBackward0&gt;)]]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>buffer_pred(preds_raw_all.mean, input_all[<span class="dv">1</span>]).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>torch.Size([3, 100, 9])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>_extract_var(preds_raw_all.cov, <span class="dv">3</span>, <span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[[tensor([[0.1189]], dtype=torch.float64, grad_fn=&lt;SliceBackward0&gt;),
  tensor([[0.1717]], dtype=torch.float64, grad_fn=&lt;SliceBackward0&gt;),
  tensor([[0.1251]], dtype=torch.float64, grad_fn=&lt;SliceBackward0&gt;)],
 [tensor([[0.1189]], dtype=torch.float64, grad_fn=&lt;SliceBackward0&gt;),
  tensor([[0.1717]], dtype=torch.float64, grad_fn=&lt;SliceBackward0&gt;),
  tensor([[0.1251]], dtype=torch.float64, grad_fn=&lt;SliceBackward0&gt;)],
 [tensor([[0.1189]], dtype=torch.float64, grad_fn=&lt;SliceBackward0&gt;),
  tensor([[0.1717]], dtype=torch.float64, grad_fn=&lt;SliceBackward0&gt;),
  tensor([[0.1251]], dtype=torch.float64, grad_fn=&lt;SliceBackward0&gt;)]]</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/training.py#L867" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
</section>
<section id="predictlossvar" class="level3">
<h3 class="anchored" data-anchor-id="predictlossvar">PredictLossVar</h3>
<blockquote class="blockquote">
<pre><code> PredictLossVar (only_gap:bool, var:int)</code></pre>
</blockquote>
<p>loss (negative log likelihood) for only for one variable for each batch</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>PredictLossVar(<span class="va">True</span>, <span class="dv">3</span>)(preds_raw_all, input_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[tensor(-0.2252, dtype=torch.float64, grad_fn=&lt;MeanBackward0&gt;),
 tensor(-0.2252, dtype=torch.float64, grad_fn=&lt;MeanBackward0&gt;),
 tensor(-0.2252, dtype=torch.float64, grad_fn=&lt;MeanBackward0&gt;)]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>input_all[<span class="dv">1</span>].shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>torch.Size([3, 100, 9])</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L89" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="predictlikelihoodvar" class="level3">
<h3 class="anchored" data-anchor-id="predictlikelihoodvar">PredictLikelihoodVar</h3>
<blockquote class="blockquote">
<pre><code> PredictLikelihoodVar (only_gap:bool, var:int)</code></pre>
</blockquote>
<p>mean between timesteps of Likelihood for only for one variable for each batch</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>PredictLikelihoodVar(<span class="va">True</span>, <span class="dv">3</span>)(preds_raw_all, input_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[tensor(1.1569, dtype=torch.float64, grad_fn=&lt;MeanBackward0&gt;),
 tensor(1.1569, dtype=torch.float64, grad_fn=&lt;MeanBackward0&gt;),
 tensor(1.1569, dtype=torch.float64, grad_fn=&lt;MeanBackward0&gt;)]</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L110" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="multimetrics" class="level3">
<h3 class="anchored" data-anchor-id="multimetrics">MultiMetrics</h3>
<blockquote class="blockquote">
<pre><code> MultiMetrics (**metrics)</code></pre>
</blockquote>
<p>Initialize self. See help(type(self)) for accurate signature.</p>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L115" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="kalmanimputation-1" class="level3">
<h3 class="anchored" data-anchor-id="kalmanimputation-1">KalmanImputation</h3>
<blockquote class="blockquote">
<pre><code> KalmanImputation (model)</code></pre>
</blockquote>
<p>Initialize self. See help(type(self)) for accurate signature.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>k_imp <span class="op">=</span> KalmanImputation(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> k_imp(item, dls<span class="op">=</span>dls)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>display_as_row({<span class="st">'pred'</span>: pred[<span class="dv">45</span>:<span class="dv">55</span>],<span class="st">'data'</span>: targ.data[<span class="dv">45</span>:<span class="dv">55</span>], <span class="st">'mask'</span>: targ.mask[<span class="dv">45</span>:<span class="dv">55</span>]}, hide_idx<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<p style="font-size: 1.5rem; font-decoration: bold"></p><p></p><div style="display: flex; column-gap: 20px; flex-wrap: wrap;" class="table table-striped table-sm"> <div> <p style="font-size: 1.3rem;">pred</p> <style type="text/css">
</style>

<table id="T_f1c5e" data-quarto-postprocess="true" class="table table-sm table-striped">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_f1c5e_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">TA</th>
<th id="T_f1c5e_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">SW_IN</th>
<th id="T_f1c5e_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">LW_IN</th>
<th id="T_f1c5e_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">VPD</th>
<th id="T_f1c5e_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">WS</th>
<th id="T_f1c5e_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">PA</th>
<th id="T_f1c5e_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">P</th>
<th id="T_f1c5e_level0_col7" class="col_heading level0 col7" data-quarto-table-cell-role="th">SWC</th>
<th id="T_f1c5e_level0_col8" class="col_heading level0 col8" data-quarto-table-cell-role="th">TS</th>
</tr>
<tr class="odd">
<th class="index_name level0" data-quarto-table-cell-role="th">time</th>
<th class="blank col0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col1" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col2" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col3" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col4" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col5" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col6" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col7" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col8" data-quarto-table-cell-role="th">&nbsp;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_f1c5e_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">2000-01-04 02:30:00</td>
<td id="T_f1c5e_row0_col0" class="data row0 col0">2.3467</td>
<td id="T_f1c5e_row0_col1" class="data row0 col1">0.0000</td>
<td id="T_f1c5e_row0_col2" class="data row0 col2">304.7310</td>
<td id="T_f1c5e_row0_col3" class="data row0 col3">0.9520</td>
<td id="T_f1c5e_row0_col4" class="data row0 col4">5.3900</td>
<td id="T_f1c5e_row0_col5" class="data row0 col5">96.3000</td>
<td id="T_f1c5e_row0_col6" class="data row0 col6">0.0000</td>
<td id="T_f1c5e_row0_col7" class="data row0 col7">43.0800</td>
<td id="T_f1c5e_row0_col8" class="data row0 col8">1.3100</td>
</tr>
<tr class="even">
<td id="T_f1c5e_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">2000-01-04 03:00:00</td>
<td id="T_f1c5e_row1_col0" class="data row1 col0">2.1803</td>
<td id="T_f1c5e_row1_col1" class="data row1 col1">0.0000</td>
<td id="T_f1c5e_row1_col2" class="data row1 col2">304.7310</td>
<td id="T_f1c5e_row1_col3" class="data row1 col3">0.9710</td>
<td id="T_f1c5e_row1_col4" class="data row1 col4">5.5900</td>
<td id="T_f1c5e_row1_col5" class="data row1 col5">96.3000</td>
<td id="T_f1c5e_row1_col6" class="data row1 col6">0.0000</td>
<td id="T_f1c5e_row1_col7" class="data row1 col7">43.0800</td>
<td id="T_f1c5e_row1_col8" class="data row1 col8">1.3100</td>
</tr>
<tr class="odd">
<td id="T_f1c5e_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2000-01-04 03:30:00</td>
<td id="T_f1c5e_row2_col0" class="data row2 col0">1.8728</td>
<td id="T_f1c5e_row2_col1" class="data row2 col1">0.0000</td>
<td id="T_f1c5e_row2_col2" class="data row2 col2">304.7310</td>
<td id="T_f1c5e_row2_col3" class="data row2 col3">0.9580</td>
<td id="T_f1c5e_row2_col4" class="data row2 col4">5.6700</td>
<td id="T_f1c5e_row2_col5" class="data row2 col5">96.2900</td>
<td id="T_f1c5e_row2_col6" class="data row2 col6">0.0000</td>
<td id="T_f1c5e_row2_col7" class="data row2 col7">43.0800</td>
<td id="T_f1c5e_row2_col8" class="data row2 col8">1.3100</td>
</tr>
<tr class="even">
<td id="T_f1c5e_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">2000-01-04 04:00:00</td>
<td id="T_f1c5e_row3_col0" class="data row3 col0">1.4769</td>
<td id="T_f1c5e_row3_col1" class="data row3 col1">0.0000</td>
<td id="T_f1c5e_row3_col2" class="data row3 col2">304.7310</td>
<td id="T_f1c5e_row3_col3" class="data row3 col3">0.9380</td>
<td id="T_f1c5e_row3_col4" class="data row3 col4">6.6100</td>
<td id="T_f1c5e_row3_col5" class="data row3 col5">96.2600</td>
<td id="T_f1c5e_row3_col6" class="data row3 col6">0.0000</td>
<td id="T_f1c5e_row3_col7" class="data row3 col7">43.0800</td>
<td id="T_f1c5e_row3_col8" class="data row3 col8">1.3100</td>
</tr>
<tr class="odd">
<td id="T_f1c5e_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">2000-01-04 04:30:00</td>
<td id="T_f1c5e_row4_col0" class="data row4 col0">1.4710</td>
<td id="T_f1c5e_row4_col1" class="data row4 col1">0.0000</td>
<td id="T_f1c5e_row4_col2" class="data row4 col2">315.0050</td>
<td id="T_f1c5e_row4_col3" class="data row4 col3">0.7850</td>
<td id="T_f1c5e_row4_col4" class="data row4 col4">6.6500</td>
<td id="T_f1c5e_row4_col5" class="data row4 col5">96.2600</td>
<td id="T_f1c5e_row4_col6" class="data row4 col6">0.0000</td>
<td id="T_f1c5e_row4_col7" class="data row4 col7">43.0800</td>
<td id="T_f1c5e_row4_col8" class="data row4 col8">1.3100</td>
</tr>
<tr class="even">
<td id="T_f1c5e_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">2000-01-04 05:00:00</td>
<td id="T_f1c5e_row5_col0" class="data row5 col0">1.4303</td>
<td id="T_f1c5e_row5_col1" class="data row5 col1">0.0000</td>
<td id="T_f1c5e_row5_col2" class="data row5 col2">315.0050</td>
<td id="T_f1c5e_row5_col3" class="data row5 col3">0.5290</td>
<td id="T_f1c5e_row5_col4" class="data row5 col4">6.1200</td>
<td id="T_f1c5e_row5_col5" class="data row5 col5">96.2700</td>
<td id="T_f1c5e_row5_col6" class="data row5 col6">0.0000</td>
<td id="T_f1c5e_row5_col7" class="data row5 col7">43.0800</td>
<td id="T_f1c5e_row5_col8" class="data row5 col8">1.3000</td>
</tr>
<tr class="odd">
<td id="T_f1c5e_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">2000-01-04 05:30:00</td>
<td id="T_f1c5e_row6_col0" class="data row6 col0">1.5573</td>
<td id="T_f1c5e_row6_col1" class="data row6 col1">0.0000</td>
<td id="T_f1c5e_row6_col2" class="data row6 col2">315.0050</td>
<td id="T_f1c5e_row6_col3" class="data row6 col3">0.4500</td>
<td id="T_f1c5e_row6_col4" class="data row6 col4">5.5800</td>
<td id="T_f1c5e_row6_col5" class="data row6 col5">96.2600</td>
<td id="T_f1c5e_row6_col6" class="data row6 col6">0.2900</td>
<td id="T_f1c5e_row6_col7" class="data row6 col7">43.1300</td>
<td id="T_f1c5e_row6_col8" class="data row6 col8">1.3000</td>
</tr>
<tr class="even">
<td id="T_f1c5e_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">2000-01-04 06:00:00</td>
<td id="T_f1c5e_row7_col0" class="data row7 col0">1.6616</td>
<td id="T_f1c5e_row7_col1" class="data row7 col1">0.0000</td>
<td id="T_f1c5e_row7_col2" class="data row7 col2">315.0050</td>
<td id="T_f1c5e_row7_col3" class="data row7 col3">0.4990</td>
<td id="T_f1c5e_row7_col4" class="data row7 col4">4.7000</td>
<td id="T_f1c5e_row7_col5" class="data row7 col5">96.2500</td>
<td id="T_f1c5e_row7_col6" class="data row7 col6">0.0000</td>
<td id="T_f1c5e_row7_col7" class="data row7 col7">43.1300</td>
<td id="T_f1c5e_row7_col8" class="data row7 col8">1.2900</td>
</tr>
<tr class="odd">
<td id="T_f1c5e_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">2000-01-04 06:30:00</td>
<td id="T_f1c5e_row8_col0" class="data row8 col0">1.6438</td>
<td id="T_f1c5e_row8_col1" class="data row8 col1">0.0000</td>
<td id="T_f1c5e_row8_col2" class="data row8 col2">315.0050</td>
<td id="T_f1c5e_row8_col3" class="data row8 col3">0.3820</td>
<td id="T_f1c5e_row8_col4" class="data row8 col4">5.0700</td>
<td id="T_f1c5e_row8_col5" class="data row8 col5">96.2300</td>
<td id="T_f1c5e_row8_col6" class="data row8 col6">0.0000</td>
<td id="T_f1c5e_row8_col7" class="data row8 col7">43.1300</td>
<td id="T_f1c5e_row8_col8" class="data row8 col8">1.2900</td>
</tr>
<tr class="even">
<td id="T_f1c5e_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">2000-01-04 07:00:00</td>
<td id="T_f1c5e_row9_col0" class="data row9 col0">1.5697</td>
<td id="T_f1c5e_row9_col1" class="data row9 col1">0.0000</td>
<td id="T_f1c5e_row9_col2" class="data row9 col2">315.0050</td>
<td id="T_f1c5e_row9_col3" class="data row9 col3">0.3130</td>
<td id="T_f1c5e_row9_col4" class="data row9 col4">5.2300</td>
<td id="T_f1c5e_row9_col5" class="data row9 col5">96.2400</td>
<td id="T_f1c5e_row9_col6" class="data row9 col6">0.0000</td>
<td id="T_f1c5e_row9_col7" class="data row9 col7">43.1300</td>
<td id="T_f1c5e_row9_col8" class="data row9 col8">1.2900</td>
</tr>
</tbody>
</table>
<div>
<p>data</p>
<table id="T_296c4" data-quarto-postprocess="true" class="table table-sm table-striped">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_296c4_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">TA</th>
<th id="T_296c4_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">SW_IN</th>
<th id="T_296c4_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">LW_IN</th>
<th id="T_296c4_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">VPD</th>
<th id="T_296c4_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">WS</th>
<th id="T_296c4_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">PA</th>
<th id="T_296c4_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">P</th>
<th id="T_296c4_level0_col7" class="col_heading level0 col7" data-quarto-table-cell-role="th">SWC</th>
<th id="T_296c4_level0_col8" class="col_heading level0 col8" data-quarto-table-cell-role="th">TS</th>
</tr>
<tr class="odd">
<th class="index_name level0" data-quarto-table-cell-role="th">time</th>
<th class="blank col0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col1" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col2" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col3" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col4" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col5" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col6" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col7" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col8" data-quarto-table-cell-role="th">&nbsp;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_296c4_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">2000-01-04 02:30:00</td>
<td id="T_296c4_row0_col0" class="data row0 col0">2.1900</td>
<td id="T_296c4_row0_col1" class="data row0 col1">0.0000</td>
<td id="T_296c4_row0_col2" class="data row0 col2">304.7310</td>
<td id="T_296c4_row0_col3" class="data row0 col3">0.9520</td>
<td id="T_296c4_row0_col4" class="data row0 col4">5.3900</td>
<td id="T_296c4_row0_col5" class="data row0 col5">96.3000</td>
<td id="T_296c4_row0_col6" class="data row0 col6">0.0000</td>
<td id="T_296c4_row0_col7" class="data row0 col7">43.0800</td>
<td id="T_296c4_row0_col8" class="data row0 col8">1.3100</td>
</tr>
<tr class="even">
<td id="T_296c4_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">2000-01-04 03:00:00</td>
<td id="T_296c4_row1_col0" class="data row1 col0">2.2700</td>
<td id="T_296c4_row1_col1" class="data row1 col1">0.0000</td>
<td id="T_296c4_row1_col2" class="data row1 col2">304.7310</td>
<td id="T_296c4_row1_col3" class="data row1 col3">0.9710</td>
<td id="T_296c4_row1_col4" class="data row1 col4">5.5900</td>
<td id="T_296c4_row1_col5" class="data row1 col5">96.3000</td>
<td id="T_296c4_row1_col6" class="data row1 col6">0.0000</td>
<td id="T_296c4_row1_col7" class="data row1 col7">43.0800</td>
<td id="T_296c4_row1_col8" class="data row1 col8">1.3100</td>
</tr>
<tr class="odd">
<td id="T_296c4_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2000-01-04 03:30:00</td>
<td id="T_296c4_row2_col0" class="data row2 col0">2.3200</td>
<td id="T_296c4_row2_col1" class="data row2 col1">0.0000</td>
<td id="T_296c4_row2_col2" class="data row2 col2">304.7310</td>
<td id="T_296c4_row2_col3" class="data row2 col3">0.9580</td>
<td id="T_296c4_row2_col4" class="data row2 col4">5.6700</td>
<td id="T_296c4_row2_col5" class="data row2 col5">96.2900</td>
<td id="T_296c4_row2_col6" class="data row2 col6">0.0000</td>
<td id="T_296c4_row2_col7" class="data row2 col7">43.0800</td>
<td id="T_296c4_row2_col8" class="data row2 col8">1.3100</td>
</tr>
<tr class="even">
<td id="T_296c4_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">2000-01-04 04:00:00</td>
<td id="T_296c4_row3_col0" class="data row3 col0">2.3400</td>
<td id="T_296c4_row3_col1" class="data row3 col1">0.0000</td>
<td id="T_296c4_row3_col2" class="data row3 col2">304.7310</td>
<td id="T_296c4_row3_col3" class="data row3 col3">0.9380</td>
<td id="T_296c4_row3_col4" class="data row3 col4">6.6100</td>
<td id="T_296c4_row3_col5" class="data row3 col5">96.2600</td>
<td id="T_296c4_row3_col6" class="data row3 col6">0.0000</td>
<td id="T_296c4_row3_col7" class="data row3 col7">43.0800</td>
<td id="T_296c4_row3_col8" class="data row3 col8">1.3100</td>
</tr>
<tr class="odd">
<td id="T_296c4_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">2000-01-04 04:30:00</td>
<td id="T_296c4_row4_col0" class="data row4 col0">2.2400</td>
<td id="T_296c4_row4_col1" class="data row4 col1">0.0000</td>
<td id="T_296c4_row4_col2" class="data row4 col2">315.0050</td>
<td id="T_296c4_row4_col3" class="data row4 col3">0.7850</td>
<td id="T_296c4_row4_col4" class="data row4 col4">6.6500</td>
<td id="T_296c4_row4_col5" class="data row4 col5">96.2600</td>
<td id="T_296c4_row4_col6" class="data row4 col6">0.0000</td>
<td id="T_296c4_row4_col7" class="data row4 col7">43.0800</td>
<td id="T_296c4_row4_col8" class="data row4 col8">1.3100</td>
</tr>
<tr class="even">
<td id="T_296c4_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">2000-01-04 05:00:00</td>
<td id="T_296c4_row5_col0" class="data row5 col0">2.0000</td>
<td id="T_296c4_row5_col1" class="data row5 col1">0.0000</td>
<td id="T_296c4_row5_col2" class="data row5 col2">315.0050</td>
<td id="T_296c4_row5_col3" class="data row5 col3">0.5290</td>
<td id="T_296c4_row5_col4" class="data row5 col4">6.1200</td>
<td id="T_296c4_row5_col5" class="data row5 col5">96.2700</td>
<td id="T_296c4_row5_col6" class="data row5 col6">0.0000</td>
<td id="T_296c4_row5_col7" class="data row5 col7">43.0800</td>
<td id="T_296c4_row5_col8" class="data row5 col8">1.3000</td>
</tr>
<tr class="odd">
<td id="T_296c4_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">2000-01-04 05:30:00</td>
<td id="T_296c4_row6_col0" class="data row6 col0">1.9400</td>
<td id="T_296c4_row6_col1" class="data row6 col1">0.0000</td>
<td id="T_296c4_row6_col2" class="data row6 col2">315.0050</td>
<td id="T_296c4_row6_col3" class="data row6 col3">0.4500</td>
<td id="T_296c4_row6_col4" class="data row6 col4">5.5800</td>
<td id="T_296c4_row6_col5" class="data row6 col5">96.2600</td>
<td id="T_296c4_row6_col6" class="data row6 col6">0.2900</td>
<td id="T_296c4_row6_col7" class="data row6 col7">43.1300</td>
<td id="T_296c4_row6_col8" class="data row6 col8">1.3000</td>
</tr>
<tr class="even">
<td id="T_296c4_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">2000-01-04 06:00:00</td>
<td id="T_296c4_row7_col0" class="data row7 col0">2.0700</td>
<td id="T_296c4_row7_col1" class="data row7 col1">0.0000</td>
<td id="T_296c4_row7_col2" class="data row7 col2">315.0050</td>
<td id="T_296c4_row7_col3" class="data row7 col3">0.4990</td>
<td id="T_296c4_row7_col4" class="data row7 col4">4.7000</td>
<td id="T_296c4_row7_col5" class="data row7 col5">96.2500</td>
<td id="T_296c4_row7_col6" class="data row7 col6">0.0000</td>
<td id="T_296c4_row7_col7" class="data row7 col7">43.1300</td>
<td id="T_296c4_row7_col8" class="data row7 col8">1.2900</td>
</tr>
<tr class="odd">
<td id="T_296c4_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">2000-01-04 06:30:00</td>
<td id="T_296c4_row8_col0" class="data row8 col0">2.0400</td>
<td id="T_296c4_row8_col1" class="data row8 col1">0.0000</td>
<td id="T_296c4_row8_col2" class="data row8 col2">315.0050</td>
<td id="T_296c4_row8_col3" class="data row8 col3">0.3820</td>
<td id="T_296c4_row8_col4" class="data row8 col4">5.0700</td>
<td id="T_296c4_row8_col5" class="data row8 col5">96.2300</td>
<td id="T_296c4_row8_col6" class="data row8 col6">0.0000</td>
<td id="T_296c4_row8_col7" class="data row8 col7">43.1300</td>
<td id="T_296c4_row8_col8" class="data row8 col8">1.2900</td>
</tr>
<tr class="even">
<td id="T_296c4_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">2000-01-04 07:00:00</td>
<td id="T_296c4_row9_col0" class="data row9 col0">2.0300</td>
<td id="T_296c4_row9_col1" class="data row9 col1">0.0000</td>
<td id="T_296c4_row9_col2" class="data row9 col2">315.0050</td>
<td id="T_296c4_row9_col3" class="data row9 col3">0.3130</td>
<td id="T_296c4_row9_col4" class="data row9 col4">5.2300</td>
<td id="T_296c4_row9_col5" class="data row9 col5">96.2400</td>
<td id="T_296c4_row9_col6" class="data row9 col6">0.0000</td>
<td id="T_296c4_row9_col7" class="data row9 col7">43.1300</td>
<td id="T_296c4_row9_col8" class="data row9 col8">1.2900</td>
</tr>
</tbody>
</table>
</div>
<div>
<p>mask</p>
<table id="T_614f4" data-quarto-postprocess="true" class="table table-sm table-striped">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_614f4_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">TA</th>
<th id="T_614f4_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">SW_IN</th>
<th id="T_614f4_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">LW_IN</th>
<th id="T_614f4_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">VPD</th>
<th id="T_614f4_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">WS</th>
<th id="T_614f4_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">PA</th>
<th id="T_614f4_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">P</th>
<th id="T_614f4_level0_col7" class="col_heading level0 col7" data-quarto-table-cell-role="th">SWC</th>
<th id="T_614f4_level0_col8" class="col_heading level0 col8" data-quarto-table-cell-role="th">TS</th>
</tr>
<tr class="odd">
<th class="index_name level0" data-quarto-table-cell-role="th">time</th>
<th class="blank col0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col1" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col2" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col3" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col4" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col5" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col6" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col7" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col8" data-quarto-table-cell-role="th">&nbsp;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_614f4_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">2000-01-04 02:30:00</td>
<td id="T_614f4_row0_col0" class="data row0 col0">False</td>
<td id="T_614f4_row0_col1" class="data row0 col1">True</td>
<td id="T_614f4_row0_col2" class="data row0 col2">True</td>
<td id="T_614f4_row0_col3" class="data row0 col3">True</td>
<td id="T_614f4_row0_col4" class="data row0 col4">True</td>
<td id="T_614f4_row0_col5" class="data row0 col5">True</td>
<td id="T_614f4_row0_col6" class="data row0 col6">True</td>
<td id="T_614f4_row0_col7" class="data row0 col7">True</td>
<td id="T_614f4_row0_col8" class="data row0 col8">True</td>
</tr>
<tr class="even">
<td id="T_614f4_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">2000-01-04 03:00:00</td>
<td id="T_614f4_row1_col0" class="data row1 col0">False</td>
<td id="T_614f4_row1_col1" class="data row1 col1">True</td>
<td id="T_614f4_row1_col2" class="data row1 col2">True</td>
<td id="T_614f4_row1_col3" class="data row1 col3">True</td>
<td id="T_614f4_row1_col4" class="data row1 col4">True</td>
<td id="T_614f4_row1_col5" class="data row1 col5">True</td>
<td id="T_614f4_row1_col6" class="data row1 col6">True</td>
<td id="T_614f4_row1_col7" class="data row1 col7">True</td>
<td id="T_614f4_row1_col8" class="data row1 col8">True</td>
</tr>
<tr class="odd">
<td id="T_614f4_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2000-01-04 03:30:00</td>
<td id="T_614f4_row2_col0" class="data row2 col0">False</td>
<td id="T_614f4_row2_col1" class="data row2 col1">True</td>
<td id="T_614f4_row2_col2" class="data row2 col2">True</td>
<td id="T_614f4_row2_col3" class="data row2 col3">True</td>
<td id="T_614f4_row2_col4" class="data row2 col4">True</td>
<td id="T_614f4_row2_col5" class="data row2 col5">True</td>
<td id="T_614f4_row2_col6" class="data row2 col6">True</td>
<td id="T_614f4_row2_col7" class="data row2 col7">True</td>
<td id="T_614f4_row2_col8" class="data row2 col8">True</td>
</tr>
<tr class="even">
<td id="T_614f4_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">2000-01-04 04:00:00</td>
<td id="T_614f4_row3_col0" class="data row3 col0">False</td>
<td id="T_614f4_row3_col1" class="data row3 col1">True</td>
<td id="T_614f4_row3_col2" class="data row3 col2">True</td>
<td id="T_614f4_row3_col3" class="data row3 col3">True</td>
<td id="T_614f4_row3_col4" class="data row3 col4">True</td>
<td id="T_614f4_row3_col5" class="data row3 col5">True</td>
<td id="T_614f4_row3_col6" class="data row3 col6">True</td>
<td id="T_614f4_row3_col7" class="data row3 col7">True</td>
<td id="T_614f4_row3_col8" class="data row3 col8">True</td>
</tr>
<tr class="odd">
<td id="T_614f4_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">2000-01-04 04:30:00</td>
<td id="T_614f4_row4_col0" class="data row4 col0">False</td>
<td id="T_614f4_row4_col1" class="data row4 col1">True</td>
<td id="T_614f4_row4_col2" class="data row4 col2">True</td>
<td id="T_614f4_row4_col3" class="data row4 col3">True</td>
<td id="T_614f4_row4_col4" class="data row4 col4">True</td>
<td id="T_614f4_row4_col5" class="data row4 col5">True</td>
<td id="T_614f4_row4_col6" class="data row4 col6">True</td>
<td id="T_614f4_row4_col7" class="data row4 col7">True</td>
<td id="T_614f4_row4_col8" class="data row4 col8">True</td>
</tr>
<tr class="even">
<td id="T_614f4_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">2000-01-04 05:00:00</td>
<td id="T_614f4_row5_col0" class="data row5 col0">False</td>
<td id="T_614f4_row5_col1" class="data row5 col1">True</td>
<td id="T_614f4_row5_col2" class="data row5 col2">True</td>
<td id="T_614f4_row5_col3" class="data row5 col3">True</td>
<td id="T_614f4_row5_col4" class="data row5 col4">True</td>
<td id="T_614f4_row5_col5" class="data row5 col5">True</td>
<td id="T_614f4_row5_col6" class="data row5 col6">True</td>
<td id="T_614f4_row5_col7" class="data row5 col7">True</td>
<td id="T_614f4_row5_col8" class="data row5 col8">True</td>
</tr>
<tr class="odd">
<td id="T_614f4_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">2000-01-04 05:30:00</td>
<td id="T_614f4_row6_col0" class="data row6 col0">False</td>
<td id="T_614f4_row6_col1" class="data row6 col1">True</td>
<td id="T_614f4_row6_col2" class="data row6 col2">True</td>
<td id="T_614f4_row6_col3" class="data row6 col3">True</td>
<td id="T_614f4_row6_col4" class="data row6 col4">True</td>
<td id="T_614f4_row6_col5" class="data row6 col5">True</td>
<td id="T_614f4_row6_col6" class="data row6 col6">True</td>
<td id="T_614f4_row6_col7" class="data row6 col7">True</td>
<td id="T_614f4_row6_col8" class="data row6 col8">True</td>
</tr>
<tr class="even">
<td id="T_614f4_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">2000-01-04 06:00:00</td>
<td id="T_614f4_row7_col0" class="data row7 col0">False</td>
<td id="T_614f4_row7_col1" class="data row7 col1">True</td>
<td id="T_614f4_row7_col2" class="data row7 col2">True</td>
<td id="T_614f4_row7_col3" class="data row7 col3">True</td>
<td id="T_614f4_row7_col4" class="data row7 col4">True</td>
<td id="T_614f4_row7_col5" class="data row7 col5">True</td>
<td id="T_614f4_row7_col6" class="data row7 col6">True</td>
<td id="T_614f4_row7_col7" class="data row7 col7">True</td>
<td id="T_614f4_row7_col8" class="data row7 col8">True</td>
</tr>
<tr class="odd">
<td id="T_614f4_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">2000-01-04 06:30:00</td>
<td id="T_614f4_row8_col0" class="data row8 col0">False</td>
<td id="T_614f4_row8_col1" class="data row8 col1">True</td>
<td id="T_614f4_row8_col2" class="data row8 col2">True</td>
<td id="T_614f4_row8_col3" class="data row8 col3">True</td>
<td id="T_614f4_row8_col4" class="data row8 col4">True</td>
<td id="T_614f4_row8_col5" class="data row8 col5">True</td>
<td id="T_614f4_row8_col6" class="data row8 col6">True</td>
<td id="T_614f4_row8_col7" class="data row8 col7">True</td>
<td id="T_614f4_row8_col8" class="data row8 col8">True</td>
</tr>
<tr class="even">
<td id="T_614f4_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">2000-01-04 07:00:00</td>
<td id="T_614f4_row9_col0" class="data row9 col0">False</td>
<td id="T_614f4_row9_col1" class="data row9 col1">True</td>
<td id="T_614f4_row9_col2" class="data row9 col2">True</td>
<td id="T_614f4_row9_col3" class="data row9 col3">True</td>
<td id="T_614f4_row9_col4" class="data row9 col4">True</td>
<td id="T_614f4_row9_col5" class="data row9 col5">True</td>
<td id="T_614f4_row9_col6" class="data row9 col6">True</td>
<td id="T_614f4_row9_col7" class="data row9 col7">True</td>
<td id="T_614f4_row9_col8" class="data row9 col8">True</td>
</tr>
</tbody>
</table>
</div>

 </div></div>
</div>
</div>
<section id="kalman-imputation---specialized-variables" class="level4">
<h4 class="anchored" data-anchor-id="kalman-imputation---specialized-variables">Kalman Imputation - Specialized Variables</h4>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L130" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
</section>
<section id="kalmanimputationvar" class="level3">
<h3 class="anchored" data-anchor-id="kalmanimputationvar">KalmanImputationVar</h3>
<blockquote class="blockquote">
<pre><code> KalmanImputationVar (models)</code></pre>
</blockquote>
<p>Initialize self. See help(type(self)) for accurate signature.</p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>models</td>
<td>dataframe with 2 columns <code>model</code> and <code>var</code></td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>k_impVar <span class="op">=</span> KalmanImputationVar(pd.DataFrame({<span class="st">'model'</span>: [model], <span class="st">'var'</span>: <span class="st">'TA'</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> k_impVar(var<span class="op">=</span> <span class="st">'TA'</span>, item<span class="op">=</span>item, dls<span class="op">=</span>dls)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>display_as_row({<span class="st">'pred'</span>: pred[<span class="dv">45</span>:<span class="dv">55</span>],<span class="st">'data'</span>: targ.data[<span class="dv">45</span>:<span class="dv">55</span>], <span class="st">'mask'</span>: targ.mask[<span class="dv">45</span>:<span class="dv">55</span>]}, hide_idx<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<p style="font-size: 1.5rem; font-decoration: bold"></p><p></p><div style="display: flex; column-gap: 20px; flex-wrap: wrap;" class="table table-striped table-sm"> <div> <p style="font-size: 1.3rem;">pred</p> <style type="text/css">
</style>

<table id="T_aa267" data-quarto-postprocess="true" class="table table-sm table-striped">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_aa267_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">TA</th>
<th id="T_aa267_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">SW_IN</th>
<th id="T_aa267_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">LW_IN</th>
<th id="T_aa267_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">VPD</th>
<th id="T_aa267_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">WS</th>
<th id="T_aa267_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">PA</th>
<th id="T_aa267_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">P</th>
<th id="T_aa267_level0_col7" class="col_heading level0 col7" data-quarto-table-cell-role="th">SWC</th>
<th id="T_aa267_level0_col8" class="col_heading level0 col8" data-quarto-table-cell-role="th">TS</th>
</tr>
<tr class="odd">
<th class="index_name level0" data-quarto-table-cell-role="th">time</th>
<th class="blank col0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col1" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col2" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col3" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col4" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col5" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col6" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col7" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col8" data-quarto-table-cell-role="th">&nbsp;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_aa267_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">2000-01-04 02:30:00</td>
<td id="T_aa267_row0_col0" class="data row0 col0">2.3467</td>
<td id="T_aa267_row0_col1" class="data row0 col1">0.0000</td>
<td id="T_aa267_row0_col2" class="data row0 col2">304.7310</td>
<td id="T_aa267_row0_col3" class="data row0 col3">0.9520</td>
<td id="T_aa267_row0_col4" class="data row0 col4">5.3900</td>
<td id="T_aa267_row0_col5" class="data row0 col5">96.3000</td>
<td id="T_aa267_row0_col6" class="data row0 col6">0.0000</td>
<td id="T_aa267_row0_col7" class="data row0 col7">43.0800</td>
<td id="T_aa267_row0_col8" class="data row0 col8">1.3100</td>
</tr>
<tr class="even">
<td id="T_aa267_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">2000-01-04 03:00:00</td>
<td id="T_aa267_row1_col0" class="data row1 col0">2.1803</td>
<td id="T_aa267_row1_col1" class="data row1 col1">0.0000</td>
<td id="T_aa267_row1_col2" class="data row1 col2">304.7310</td>
<td id="T_aa267_row1_col3" class="data row1 col3">0.9710</td>
<td id="T_aa267_row1_col4" class="data row1 col4">5.5900</td>
<td id="T_aa267_row1_col5" class="data row1 col5">96.3000</td>
<td id="T_aa267_row1_col6" class="data row1 col6">0.0000</td>
<td id="T_aa267_row1_col7" class="data row1 col7">43.0800</td>
<td id="T_aa267_row1_col8" class="data row1 col8">1.3100</td>
</tr>
<tr class="odd">
<td id="T_aa267_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2000-01-04 03:30:00</td>
<td id="T_aa267_row2_col0" class="data row2 col0">1.8728</td>
<td id="T_aa267_row2_col1" class="data row2 col1">0.0000</td>
<td id="T_aa267_row2_col2" class="data row2 col2">304.7310</td>
<td id="T_aa267_row2_col3" class="data row2 col3">0.9580</td>
<td id="T_aa267_row2_col4" class="data row2 col4">5.6700</td>
<td id="T_aa267_row2_col5" class="data row2 col5">96.2900</td>
<td id="T_aa267_row2_col6" class="data row2 col6">0.0000</td>
<td id="T_aa267_row2_col7" class="data row2 col7">43.0800</td>
<td id="T_aa267_row2_col8" class="data row2 col8">1.3100</td>
</tr>
<tr class="even">
<td id="T_aa267_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">2000-01-04 04:00:00</td>
<td id="T_aa267_row3_col0" class="data row3 col0">1.4769</td>
<td id="T_aa267_row3_col1" class="data row3 col1">0.0000</td>
<td id="T_aa267_row3_col2" class="data row3 col2">304.7310</td>
<td id="T_aa267_row3_col3" class="data row3 col3">0.9380</td>
<td id="T_aa267_row3_col4" class="data row3 col4">6.6100</td>
<td id="T_aa267_row3_col5" class="data row3 col5">96.2600</td>
<td id="T_aa267_row3_col6" class="data row3 col6">0.0000</td>
<td id="T_aa267_row3_col7" class="data row3 col7">43.0800</td>
<td id="T_aa267_row3_col8" class="data row3 col8">1.3100</td>
</tr>
<tr class="odd">
<td id="T_aa267_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">2000-01-04 04:30:00</td>
<td id="T_aa267_row4_col0" class="data row4 col0">1.4710</td>
<td id="T_aa267_row4_col1" class="data row4 col1">0.0000</td>
<td id="T_aa267_row4_col2" class="data row4 col2">315.0050</td>
<td id="T_aa267_row4_col3" class="data row4 col3">0.7850</td>
<td id="T_aa267_row4_col4" class="data row4 col4">6.6500</td>
<td id="T_aa267_row4_col5" class="data row4 col5">96.2600</td>
<td id="T_aa267_row4_col6" class="data row4 col6">0.0000</td>
<td id="T_aa267_row4_col7" class="data row4 col7">43.0800</td>
<td id="T_aa267_row4_col8" class="data row4 col8">1.3100</td>
</tr>
<tr class="even">
<td id="T_aa267_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">2000-01-04 05:00:00</td>
<td id="T_aa267_row5_col0" class="data row5 col0">1.4303</td>
<td id="T_aa267_row5_col1" class="data row5 col1">0.0000</td>
<td id="T_aa267_row5_col2" class="data row5 col2">315.0050</td>
<td id="T_aa267_row5_col3" class="data row5 col3">0.5290</td>
<td id="T_aa267_row5_col4" class="data row5 col4">6.1200</td>
<td id="T_aa267_row5_col5" class="data row5 col5">96.2700</td>
<td id="T_aa267_row5_col6" class="data row5 col6">0.0000</td>
<td id="T_aa267_row5_col7" class="data row5 col7">43.0800</td>
<td id="T_aa267_row5_col8" class="data row5 col8">1.3000</td>
</tr>
<tr class="odd">
<td id="T_aa267_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">2000-01-04 05:30:00</td>
<td id="T_aa267_row6_col0" class="data row6 col0">1.5573</td>
<td id="T_aa267_row6_col1" class="data row6 col1">0.0000</td>
<td id="T_aa267_row6_col2" class="data row6 col2">315.0050</td>
<td id="T_aa267_row6_col3" class="data row6 col3">0.4500</td>
<td id="T_aa267_row6_col4" class="data row6 col4">5.5800</td>
<td id="T_aa267_row6_col5" class="data row6 col5">96.2600</td>
<td id="T_aa267_row6_col6" class="data row6 col6">0.2900</td>
<td id="T_aa267_row6_col7" class="data row6 col7">43.1300</td>
<td id="T_aa267_row6_col8" class="data row6 col8">1.3000</td>
</tr>
<tr class="even">
<td id="T_aa267_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">2000-01-04 06:00:00</td>
<td id="T_aa267_row7_col0" class="data row7 col0">1.6616</td>
<td id="T_aa267_row7_col1" class="data row7 col1">0.0000</td>
<td id="T_aa267_row7_col2" class="data row7 col2">315.0050</td>
<td id="T_aa267_row7_col3" class="data row7 col3">0.4990</td>
<td id="T_aa267_row7_col4" class="data row7 col4">4.7000</td>
<td id="T_aa267_row7_col5" class="data row7 col5">96.2500</td>
<td id="T_aa267_row7_col6" class="data row7 col6">0.0000</td>
<td id="T_aa267_row7_col7" class="data row7 col7">43.1300</td>
<td id="T_aa267_row7_col8" class="data row7 col8">1.2900</td>
</tr>
<tr class="odd">
<td id="T_aa267_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">2000-01-04 06:30:00</td>
<td id="T_aa267_row8_col0" class="data row8 col0">1.6438</td>
<td id="T_aa267_row8_col1" class="data row8 col1">0.0000</td>
<td id="T_aa267_row8_col2" class="data row8 col2">315.0050</td>
<td id="T_aa267_row8_col3" class="data row8 col3">0.3820</td>
<td id="T_aa267_row8_col4" class="data row8 col4">5.0700</td>
<td id="T_aa267_row8_col5" class="data row8 col5">96.2300</td>
<td id="T_aa267_row8_col6" class="data row8 col6">0.0000</td>
<td id="T_aa267_row8_col7" class="data row8 col7">43.1300</td>
<td id="T_aa267_row8_col8" class="data row8 col8">1.2900</td>
</tr>
<tr class="even">
<td id="T_aa267_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">2000-01-04 07:00:00</td>
<td id="T_aa267_row9_col0" class="data row9 col0">1.5697</td>
<td id="T_aa267_row9_col1" class="data row9 col1">0.0000</td>
<td id="T_aa267_row9_col2" class="data row9 col2">315.0050</td>
<td id="T_aa267_row9_col3" class="data row9 col3">0.3130</td>
<td id="T_aa267_row9_col4" class="data row9 col4">5.2300</td>
<td id="T_aa267_row9_col5" class="data row9 col5">96.2400</td>
<td id="T_aa267_row9_col6" class="data row9 col6">0.0000</td>
<td id="T_aa267_row9_col7" class="data row9 col7">43.1300</td>
<td id="T_aa267_row9_col8" class="data row9 col8">1.2900</td>
</tr>
</tbody>
</table>
<div>
<p>data</p>
<table id="T_b4e98" data-quarto-postprocess="true" class="table table-sm table-striped">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_b4e98_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">TA</th>
<th id="T_b4e98_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">SW_IN</th>
<th id="T_b4e98_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">LW_IN</th>
<th id="T_b4e98_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">VPD</th>
<th id="T_b4e98_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">WS</th>
<th id="T_b4e98_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">PA</th>
<th id="T_b4e98_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">P</th>
<th id="T_b4e98_level0_col7" class="col_heading level0 col7" data-quarto-table-cell-role="th">SWC</th>
<th id="T_b4e98_level0_col8" class="col_heading level0 col8" data-quarto-table-cell-role="th">TS</th>
</tr>
<tr class="odd">
<th class="index_name level0" data-quarto-table-cell-role="th">time</th>
<th class="blank col0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col1" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col2" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col3" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col4" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col5" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col6" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col7" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col8" data-quarto-table-cell-role="th">&nbsp;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_b4e98_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">2000-01-04 02:30:00</td>
<td id="T_b4e98_row0_col0" class="data row0 col0">2.1900</td>
<td id="T_b4e98_row0_col1" class="data row0 col1">0.0000</td>
<td id="T_b4e98_row0_col2" class="data row0 col2">304.7310</td>
<td id="T_b4e98_row0_col3" class="data row0 col3">0.9520</td>
<td id="T_b4e98_row0_col4" class="data row0 col4">5.3900</td>
<td id="T_b4e98_row0_col5" class="data row0 col5">96.3000</td>
<td id="T_b4e98_row0_col6" class="data row0 col6">0.0000</td>
<td id="T_b4e98_row0_col7" class="data row0 col7">43.0800</td>
<td id="T_b4e98_row0_col8" class="data row0 col8">1.3100</td>
</tr>
<tr class="even">
<td id="T_b4e98_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">2000-01-04 03:00:00</td>
<td id="T_b4e98_row1_col0" class="data row1 col0">2.2700</td>
<td id="T_b4e98_row1_col1" class="data row1 col1">0.0000</td>
<td id="T_b4e98_row1_col2" class="data row1 col2">304.7310</td>
<td id="T_b4e98_row1_col3" class="data row1 col3">0.9710</td>
<td id="T_b4e98_row1_col4" class="data row1 col4">5.5900</td>
<td id="T_b4e98_row1_col5" class="data row1 col5">96.3000</td>
<td id="T_b4e98_row1_col6" class="data row1 col6">0.0000</td>
<td id="T_b4e98_row1_col7" class="data row1 col7">43.0800</td>
<td id="T_b4e98_row1_col8" class="data row1 col8">1.3100</td>
</tr>
<tr class="odd">
<td id="T_b4e98_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2000-01-04 03:30:00</td>
<td id="T_b4e98_row2_col0" class="data row2 col0">2.3200</td>
<td id="T_b4e98_row2_col1" class="data row2 col1">0.0000</td>
<td id="T_b4e98_row2_col2" class="data row2 col2">304.7310</td>
<td id="T_b4e98_row2_col3" class="data row2 col3">0.9580</td>
<td id="T_b4e98_row2_col4" class="data row2 col4">5.6700</td>
<td id="T_b4e98_row2_col5" class="data row2 col5">96.2900</td>
<td id="T_b4e98_row2_col6" class="data row2 col6">0.0000</td>
<td id="T_b4e98_row2_col7" class="data row2 col7">43.0800</td>
<td id="T_b4e98_row2_col8" class="data row2 col8">1.3100</td>
</tr>
<tr class="even">
<td id="T_b4e98_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">2000-01-04 04:00:00</td>
<td id="T_b4e98_row3_col0" class="data row3 col0">2.3400</td>
<td id="T_b4e98_row3_col1" class="data row3 col1">0.0000</td>
<td id="T_b4e98_row3_col2" class="data row3 col2">304.7310</td>
<td id="T_b4e98_row3_col3" class="data row3 col3">0.9380</td>
<td id="T_b4e98_row3_col4" class="data row3 col4">6.6100</td>
<td id="T_b4e98_row3_col5" class="data row3 col5">96.2600</td>
<td id="T_b4e98_row3_col6" class="data row3 col6">0.0000</td>
<td id="T_b4e98_row3_col7" class="data row3 col7">43.0800</td>
<td id="T_b4e98_row3_col8" class="data row3 col8">1.3100</td>
</tr>
<tr class="odd">
<td id="T_b4e98_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">2000-01-04 04:30:00</td>
<td id="T_b4e98_row4_col0" class="data row4 col0">2.2400</td>
<td id="T_b4e98_row4_col1" class="data row4 col1">0.0000</td>
<td id="T_b4e98_row4_col2" class="data row4 col2">315.0050</td>
<td id="T_b4e98_row4_col3" class="data row4 col3">0.7850</td>
<td id="T_b4e98_row4_col4" class="data row4 col4">6.6500</td>
<td id="T_b4e98_row4_col5" class="data row4 col5">96.2600</td>
<td id="T_b4e98_row4_col6" class="data row4 col6">0.0000</td>
<td id="T_b4e98_row4_col7" class="data row4 col7">43.0800</td>
<td id="T_b4e98_row4_col8" class="data row4 col8">1.3100</td>
</tr>
<tr class="even">
<td id="T_b4e98_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">2000-01-04 05:00:00</td>
<td id="T_b4e98_row5_col0" class="data row5 col0">2.0000</td>
<td id="T_b4e98_row5_col1" class="data row5 col1">0.0000</td>
<td id="T_b4e98_row5_col2" class="data row5 col2">315.0050</td>
<td id="T_b4e98_row5_col3" class="data row5 col3">0.5290</td>
<td id="T_b4e98_row5_col4" class="data row5 col4">6.1200</td>
<td id="T_b4e98_row5_col5" class="data row5 col5">96.2700</td>
<td id="T_b4e98_row5_col6" class="data row5 col6">0.0000</td>
<td id="T_b4e98_row5_col7" class="data row5 col7">43.0800</td>
<td id="T_b4e98_row5_col8" class="data row5 col8">1.3000</td>
</tr>
<tr class="odd">
<td id="T_b4e98_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">2000-01-04 05:30:00</td>
<td id="T_b4e98_row6_col0" class="data row6 col0">1.9400</td>
<td id="T_b4e98_row6_col1" class="data row6 col1">0.0000</td>
<td id="T_b4e98_row6_col2" class="data row6 col2">315.0050</td>
<td id="T_b4e98_row6_col3" class="data row6 col3">0.4500</td>
<td id="T_b4e98_row6_col4" class="data row6 col4">5.5800</td>
<td id="T_b4e98_row6_col5" class="data row6 col5">96.2600</td>
<td id="T_b4e98_row6_col6" class="data row6 col6">0.2900</td>
<td id="T_b4e98_row6_col7" class="data row6 col7">43.1300</td>
<td id="T_b4e98_row6_col8" class="data row6 col8">1.3000</td>
</tr>
<tr class="even">
<td id="T_b4e98_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">2000-01-04 06:00:00</td>
<td id="T_b4e98_row7_col0" class="data row7 col0">2.0700</td>
<td id="T_b4e98_row7_col1" class="data row7 col1">0.0000</td>
<td id="T_b4e98_row7_col2" class="data row7 col2">315.0050</td>
<td id="T_b4e98_row7_col3" class="data row7 col3">0.4990</td>
<td id="T_b4e98_row7_col4" class="data row7 col4">4.7000</td>
<td id="T_b4e98_row7_col5" class="data row7 col5">96.2500</td>
<td id="T_b4e98_row7_col6" class="data row7 col6">0.0000</td>
<td id="T_b4e98_row7_col7" class="data row7 col7">43.1300</td>
<td id="T_b4e98_row7_col8" class="data row7 col8">1.2900</td>
</tr>
<tr class="odd">
<td id="T_b4e98_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">2000-01-04 06:30:00</td>
<td id="T_b4e98_row8_col0" class="data row8 col0">2.0400</td>
<td id="T_b4e98_row8_col1" class="data row8 col1">0.0000</td>
<td id="T_b4e98_row8_col2" class="data row8 col2">315.0050</td>
<td id="T_b4e98_row8_col3" class="data row8 col3">0.3820</td>
<td id="T_b4e98_row8_col4" class="data row8 col4">5.0700</td>
<td id="T_b4e98_row8_col5" class="data row8 col5">96.2300</td>
<td id="T_b4e98_row8_col6" class="data row8 col6">0.0000</td>
<td id="T_b4e98_row8_col7" class="data row8 col7">43.1300</td>
<td id="T_b4e98_row8_col8" class="data row8 col8">1.2900</td>
</tr>
<tr class="even">
<td id="T_b4e98_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">2000-01-04 07:00:00</td>
<td id="T_b4e98_row9_col0" class="data row9 col0">2.0300</td>
<td id="T_b4e98_row9_col1" class="data row9 col1">0.0000</td>
<td id="T_b4e98_row9_col2" class="data row9 col2">315.0050</td>
<td id="T_b4e98_row9_col3" class="data row9 col3">0.3130</td>
<td id="T_b4e98_row9_col4" class="data row9 col4">5.2300</td>
<td id="T_b4e98_row9_col5" class="data row9 col5">96.2400</td>
<td id="T_b4e98_row9_col6" class="data row9 col6">0.0000</td>
<td id="T_b4e98_row9_col7" class="data row9 col7">43.1300</td>
<td id="T_b4e98_row9_col8" class="data row9 col8">1.2900</td>
</tr>
</tbody>
</table>
</div>
<div>
<p>mask</p>
<table id="T_83932" data-quarto-postprocess="true" class="table table-sm table-striped">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_83932_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">TA</th>
<th id="T_83932_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">SW_IN</th>
<th id="T_83932_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">LW_IN</th>
<th id="T_83932_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">VPD</th>
<th id="T_83932_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">WS</th>
<th id="T_83932_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">PA</th>
<th id="T_83932_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">P</th>
<th id="T_83932_level0_col7" class="col_heading level0 col7" data-quarto-table-cell-role="th">SWC</th>
<th id="T_83932_level0_col8" class="col_heading level0 col8" data-quarto-table-cell-role="th">TS</th>
</tr>
<tr class="odd">
<th class="index_name level0" data-quarto-table-cell-role="th">time</th>
<th class="blank col0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col1" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col2" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col3" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col4" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col5" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col6" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col7" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col8" data-quarto-table-cell-role="th">&nbsp;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_83932_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">2000-01-04 02:30:00</td>
<td id="T_83932_row0_col0" class="data row0 col0">False</td>
<td id="T_83932_row0_col1" class="data row0 col1">True</td>
<td id="T_83932_row0_col2" class="data row0 col2">True</td>
<td id="T_83932_row0_col3" class="data row0 col3">True</td>
<td id="T_83932_row0_col4" class="data row0 col4">True</td>
<td id="T_83932_row0_col5" class="data row0 col5">True</td>
<td id="T_83932_row0_col6" class="data row0 col6">True</td>
<td id="T_83932_row0_col7" class="data row0 col7">True</td>
<td id="T_83932_row0_col8" class="data row0 col8">True</td>
</tr>
<tr class="even">
<td id="T_83932_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">2000-01-04 03:00:00</td>
<td id="T_83932_row1_col0" class="data row1 col0">False</td>
<td id="T_83932_row1_col1" class="data row1 col1">True</td>
<td id="T_83932_row1_col2" class="data row1 col2">True</td>
<td id="T_83932_row1_col3" class="data row1 col3">True</td>
<td id="T_83932_row1_col4" class="data row1 col4">True</td>
<td id="T_83932_row1_col5" class="data row1 col5">True</td>
<td id="T_83932_row1_col6" class="data row1 col6">True</td>
<td id="T_83932_row1_col7" class="data row1 col7">True</td>
<td id="T_83932_row1_col8" class="data row1 col8">True</td>
</tr>
<tr class="odd">
<td id="T_83932_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2000-01-04 03:30:00</td>
<td id="T_83932_row2_col0" class="data row2 col0">False</td>
<td id="T_83932_row2_col1" class="data row2 col1">True</td>
<td id="T_83932_row2_col2" class="data row2 col2">True</td>
<td id="T_83932_row2_col3" class="data row2 col3">True</td>
<td id="T_83932_row2_col4" class="data row2 col4">True</td>
<td id="T_83932_row2_col5" class="data row2 col5">True</td>
<td id="T_83932_row2_col6" class="data row2 col6">True</td>
<td id="T_83932_row2_col7" class="data row2 col7">True</td>
<td id="T_83932_row2_col8" class="data row2 col8">True</td>
</tr>
<tr class="even">
<td id="T_83932_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">2000-01-04 04:00:00</td>
<td id="T_83932_row3_col0" class="data row3 col0">False</td>
<td id="T_83932_row3_col1" class="data row3 col1">True</td>
<td id="T_83932_row3_col2" class="data row3 col2">True</td>
<td id="T_83932_row3_col3" class="data row3 col3">True</td>
<td id="T_83932_row3_col4" class="data row3 col4">True</td>
<td id="T_83932_row3_col5" class="data row3 col5">True</td>
<td id="T_83932_row3_col6" class="data row3 col6">True</td>
<td id="T_83932_row3_col7" class="data row3 col7">True</td>
<td id="T_83932_row3_col8" class="data row3 col8">True</td>
</tr>
<tr class="odd">
<td id="T_83932_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">2000-01-04 04:30:00</td>
<td id="T_83932_row4_col0" class="data row4 col0">False</td>
<td id="T_83932_row4_col1" class="data row4 col1">True</td>
<td id="T_83932_row4_col2" class="data row4 col2">True</td>
<td id="T_83932_row4_col3" class="data row4 col3">True</td>
<td id="T_83932_row4_col4" class="data row4 col4">True</td>
<td id="T_83932_row4_col5" class="data row4 col5">True</td>
<td id="T_83932_row4_col6" class="data row4 col6">True</td>
<td id="T_83932_row4_col7" class="data row4 col7">True</td>
<td id="T_83932_row4_col8" class="data row4 col8">True</td>
</tr>
<tr class="even">
<td id="T_83932_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">2000-01-04 05:00:00</td>
<td id="T_83932_row5_col0" class="data row5 col0">False</td>
<td id="T_83932_row5_col1" class="data row5 col1">True</td>
<td id="T_83932_row5_col2" class="data row5 col2">True</td>
<td id="T_83932_row5_col3" class="data row5 col3">True</td>
<td id="T_83932_row5_col4" class="data row5 col4">True</td>
<td id="T_83932_row5_col5" class="data row5 col5">True</td>
<td id="T_83932_row5_col6" class="data row5 col6">True</td>
<td id="T_83932_row5_col7" class="data row5 col7">True</td>
<td id="T_83932_row5_col8" class="data row5 col8">True</td>
</tr>
<tr class="odd">
<td id="T_83932_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">2000-01-04 05:30:00</td>
<td id="T_83932_row6_col0" class="data row6 col0">False</td>
<td id="T_83932_row6_col1" class="data row6 col1">True</td>
<td id="T_83932_row6_col2" class="data row6 col2">True</td>
<td id="T_83932_row6_col3" class="data row6 col3">True</td>
<td id="T_83932_row6_col4" class="data row6 col4">True</td>
<td id="T_83932_row6_col5" class="data row6 col5">True</td>
<td id="T_83932_row6_col6" class="data row6 col6">True</td>
<td id="T_83932_row6_col7" class="data row6 col7">True</td>
<td id="T_83932_row6_col8" class="data row6 col8">True</td>
</tr>
<tr class="even">
<td id="T_83932_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">2000-01-04 06:00:00</td>
<td id="T_83932_row7_col0" class="data row7 col0">False</td>
<td id="T_83932_row7_col1" class="data row7 col1">True</td>
<td id="T_83932_row7_col2" class="data row7 col2">True</td>
<td id="T_83932_row7_col3" class="data row7 col3">True</td>
<td id="T_83932_row7_col4" class="data row7 col4">True</td>
<td id="T_83932_row7_col5" class="data row7 col5">True</td>
<td id="T_83932_row7_col6" class="data row7 col6">True</td>
<td id="T_83932_row7_col7" class="data row7 col7">True</td>
<td id="T_83932_row7_col8" class="data row7 col8">True</td>
</tr>
<tr class="odd">
<td id="T_83932_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">2000-01-04 06:30:00</td>
<td id="T_83932_row8_col0" class="data row8 col0">False</td>
<td id="T_83932_row8_col1" class="data row8 col1">True</td>
<td id="T_83932_row8_col2" class="data row8 col2">True</td>
<td id="T_83932_row8_col3" class="data row8 col3">True</td>
<td id="T_83932_row8_col4" class="data row8 col4">True</td>
<td id="T_83932_row8_col5" class="data row8 col5">True</td>
<td id="T_83932_row8_col6" class="data row8 col6">True</td>
<td id="T_83932_row8_col7" class="data row8 col7">True</td>
<td id="T_83932_row8_col8" class="data row8 col8">True</td>
</tr>
<tr class="even">
<td id="T_83932_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">2000-01-04 07:00:00</td>
<td id="T_83932_row9_col0" class="data row9 col0">False</td>
<td id="T_83932_row9_col1" class="data row9 col1">True</td>
<td id="T_83932_row9_col2" class="data row9 col2">True</td>
<td id="T_83932_row9_col3" class="data row9 col3">True</td>
<td id="T_83932_row9_col4" class="data row9 col4">True</td>
<td id="T_83932_row9_col5" class="data row9 col5">True</td>
<td id="T_83932_row9_col6" class="data row9 col6">True</td>
<td id="T_83932_row9_col7" class="data row9 col7">True</td>
<td id="T_83932_row9_col8" class="data row9 col8">True</td>
</tr>
</tbody>
</table>
</div>

 </div></div>
</div>
</div>
</section>
<section id="mds" class="level3">
<h3 class="anchored" data-anchor-id="mds">MDS</h3>
<p>Need to call R from python</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>r.<span class="bu">print</span>(<span class="st">'here::here("R/REddyProc_tools.R")'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "here::here(\"R/REddyProc_tools.R\")"</code></pre>
</div>
<div class="cell-output cell-output-display">

        <span>StrVector with 1 elements.</span>
        
<table data-quarto-postprocess="true" class="table table-sm table-striped">
<tbody>
<tr class="odd">
<td>'here::here("R/REddyProc_tools.R")'</td>
</tr>
</tbody>
</table>

        
</div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L158" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="importr_install" class="level3">
<h3 class="anchored" data-anchor-id="importr_install">importr_install</h3>
<blockquote class="blockquote">
<pre><code> importr_install (pkg)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L168" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="setupr" class="level3">
<h3 class="anchored" data-anchor-id="setupr">setupR</h3>
<blockquote class="blockquote">
<pre><code> setupR ()</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L184" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="r2pd" class="level3">
<h3 class="anchored" data-anchor-id="r2pd">R2pd</h3>
<blockquote class="blockquote">
<pre><code> R2pd (x)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L180" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="pd2r" class="level3">
<h3 class="anchored" data-anchor-id="pd2r">pd2R</h3>
<blockquote class="blockquote">
<pre><code> pd2R (x)</code></pre>
</blockquote>
<section id="experiment" class="level4">
<h4 class="anchored" data-anchor-id="experiment">Experiment</h4>
<p>The time series needs to be at least 90 days long, we we add 45 days before and after the gap</p>
<p>There is a problem with conversions of timestamps between R and Python, so convert to string in Python and then back to datetime in R</p>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L192" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
</section>
<section id="add_buffer" class="level3">
<h3 class="anchored" data-anchor-id="add_buffer">add_buffer</h3>
<blockquote class="blockquote">
<pre><code> add_buffer (index, inner_index, n)</code></pre>
</blockquote>
<p>Adds a buffer of after and after index so length is at least</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>add_buffer(hai.index, hai.index[:<span class="dv">100</span>], <span class="dv">50</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>add_buffer(hai.index, hai.index[<span class="op">-</span><span class="dv">50</span>:], <span class="dv">50</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L212" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="item2reddy" class="level3">
<h3 class="anchored" data-anchor-id="item2reddy">item2REddy</h3>
<blockquote class="blockquote">
<pre><code> item2REddy (item, var, df)</code></pre>
</blockquote>
<p>Add context around item for supporting REddyProc</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>REddy_df <span class="op">=</span> item2REddy(targ, <span class="st">'TA'</span>, hai)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>REddy_df_r <span class="op">=</span> r.toR_timestamp(pd2R(REddy_df))</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>filled <span class="op">=</span> R2pd(r.fill_gaps_EProc(REddy_df_r, <span class="st">"TA"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>R[write to console]: New sEddyProc class for site 'ID'

R[write to console]: Initialized variable 'TA' with 10 real gaps for gap filling.

R[write to console]: Limited MDS algorithm for gap filling of 'TA.gap_0' with LUT(SW_IN only) and MDC.

R[write to console]: Look up table with window size of 7 days with SW_IN

R[write to console]: 10

R[write to console]: Finished gap filling of 'TA' in 0 seconds. Artificial gaps filled: 4419, real gaps filled: 10, unfilled (long) gaps: 0.
</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>filled</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TA_orig</th>
<th data-quarto-table-cell-role="th">TA_f</th>
<th data-quarto-table-cell-role="th">TA_fqc</th>
<th data-quarto-table-cell-role="th">TA_fall</th>
<th data-quarto-table-cell-role="th">TA_fall_qc</th>
<th data-quarto-table-cell-role="th">TA_fnum</th>
<th data-quarto-table-cell-role="th">TA_fsd</th>
<th data-quarto-table-cell-role="th">TA_fmeth</th>
<th data-quarto-table-cell-role="th">TA_fwin</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.60</td>
<td>-0.60</td>
<td>0.0</td>
<td>-0.60</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.65</td>
<td>-0.65</td>
<td>0.0</td>
<td>-0.65</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>-0.58</td>
<td>-0.58</td>
<td>0.0</td>
<td>-0.58</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.51</td>
<td>-0.51</td>
<td>0.0</td>
<td>-0.51</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>-0.49</td>
<td>-0.49</td>
<td>0.0</td>
<td>-0.49</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4415</td>
<td>3.30</td>
<td>3.30</td>
<td>0.0</td>
<td>3.30</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4416</td>
<td>3.10</td>
<td>3.10</td>
<td>0.0</td>
<td>3.10</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4417</td>
<td>3.05</td>
<td>3.05</td>
<td>0.0</td>
<td>3.05</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4418</td>
<td>3.05</td>
<td>3.05</td>
<td>0.0</td>
<td>3.05</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4419</td>
<td>3.05</td>
<td>3.05</td>
<td>0.0</td>
<td>3.05</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>4419 rows  9 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>REddy_df.set_index(<span class="st">"TIMESTAMP_END"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TA</th>
<th data-quarto-table-cell-role="th">SW_IN</th>
<th data-quarto-table-cell-role="th">LW_IN</th>
<th data-quarto-table-cell-role="th">VPD</th>
<th data-quarto-table-cell-role="th">WS</th>
<th data-quarto-table-cell-role="th">PA</th>
<th data-quarto-table-cell-role="th">P</th>
<th data-quarto-table-cell-role="th">SWC</th>
<th data-quarto-table-cell-role="th">TS</th>
<th data-quarto-table-cell-role="th">gap</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">TIMESTAMP_END</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-01 00:30:00</td>
<td>-0.60</td>
<td>0.0</td>
<td>302.475</td>
<td>0.222</td>
<td>2.05</td>
<td>96.63</td>
<td>0.0</td>
<td>43.00</td>
<td>1.44</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2000-01-01 01:00:00</td>
<td>-0.65</td>
<td>0.0</td>
<td>302.475</td>
<td>0.122</td>
<td>2.53</td>
<td>96.58</td>
<td>0.0</td>
<td>43.00</td>
<td>1.43</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-01 01:30:00</td>
<td>-0.58</td>
<td>0.0</td>
<td>301.677</td>
<td>0.090</td>
<td>3.15</td>
<td>96.56</td>
<td>0.0</td>
<td>43.00</td>
<td>1.43</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2000-01-01 02:00:00</td>
<td>-0.51</td>
<td>0.0</td>
<td>301.677</td>
<td>0.110</td>
<td>3.12</td>
<td>96.56</td>
<td>0.0</td>
<td>43.00</td>
<td>1.45</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-01 02:30:00</td>
<td>-0.49</td>
<td>0.0</td>
<td>301.677</td>
<td>0.102</td>
<td>3.04</td>
<td>96.57</td>
<td>0.0</td>
<td>43.00</td>
<td>1.44</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-04-01 23:30:00</td>
<td>3.30</td>
<td>0.0</td>
<td>283.856</td>
<td>1.092</td>
<td>2.50</td>
<td>95.06</td>
<td>0.0</td>
<td>44.96</td>
<td>4.32</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2000-04-02 00:00:00</td>
<td>3.10</td>
<td>0.0</td>
<td>283.856</td>
<td>1.013</td>
<td>2.09</td>
<td>95.04</td>
<td>0.0</td>
<td>44.96</td>
<td>4.22</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-04-02 00:30:00</td>
<td>3.05</td>
<td>0.0</td>
<td>283.856</td>
<td>0.964</td>
<td>2.42</td>
<td>95.04</td>
<td>0.0</td>
<td>44.96</td>
<td>4.13</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2000-04-02 01:00:00</td>
<td>3.05</td>
<td>0.0</td>
<td>283.856</td>
<td>0.933</td>
<td>3.04</td>
<td>95.04</td>
<td>0.0</td>
<td>44.96</td>
<td>4.04</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-04-02 01:30:00</td>
<td>3.05</td>
<td>0.0</td>
<td>251.387</td>
<td>0.930</td>
<td>2.96</td>
<td>95.03</td>
<td>0.0</td>
<td>44.95</td>
<td>3.94</td>
<td>0.0</td>
</tr>
</tbody>
</table>

<p>4419 rows  10 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>filled <span class="op">=</span> filled.set_index(pd.to_datetime(REddy_df.TIMESTAMP_END))</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>filled_item <span class="op">=</span> filled.loc[targ.data.index]</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> targ.data.copy()</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>pred.loc[<span class="op">~</span>targ.mask[<span class="st">"TA"</span>], <span class="st">"TA"</span>] <span class="op">=</span> filled_item[<span class="st">"TA_f"</span>][<span class="op">~</span>targ.mask[<span class="st">"TA"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>pred[<span class="dv">45</span>:<span class="dv">55</span>], targ.data[<span class="dv">45</span>:<span class="dv">55</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(                           TA  SW_IN    LW_IN    VPD    WS     PA     P  \
 time                                                                      
 2000-01-04 02:30:00  1.853612    0.0  304.731  0.952  5.39  96.30  0.00   
 2000-01-04 03:00:00  1.837083    0.0  304.731  0.971  5.59  96.30  0.00   
 2000-01-04 03:30:00  1.823985    0.0  304.731  0.958  5.67  96.29  0.00   
 2000-01-04 04:00:00  1.809805    0.0  304.731  0.938  6.61  96.26  0.00   
 2000-01-04 04:30:00  1.794282    0.0  315.005  0.785  6.65  96.26  0.00   
 2000-01-04 05:00:00  1.783447    0.0  315.005  0.529  6.12  96.27  0.00   
 2000-01-04 05:30:00  1.771525    0.0  315.005  0.450  5.58  96.26  0.29   
 2000-01-04 06:00:00  1.760362    0.0  315.005  0.499  4.70  96.25  0.00   
 2000-01-04 06:30:00  1.748410    0.0  315.005  0.382  5.07  96.23  0.00   
 2000-01-04 07:00:00  1.737933    0.0  315.005  0.313  5.23  96.24  0.00   
 
                        SWC    TS  
 time                              
 2000-01-04 02:30:00  43.08  1.31  
 2000-01-04 03:00:00  43.08  1.31  
 2000-01-04 03:30:00  43.08  1.31  
 2000-01-04 04:00:00  43.08  1.31  
 2000-01-04 04:30:00  43.08  1.31  
 2000-01-04 05:00:00  43.08  1.30  
 2000-01-04 05:30:00  43.13  1.30  
 2000-01-04 06:00:00  43.13  1.29  
 2000-01-04 06:30:00  43.13  1.29  
 2000-01-04 07:00:00  43.13  1.29  ,
                        TA  SW_IN    LW_IN    VPD    WS     PA     P    SWC  \
 time                                                                         
 2000-01-04 02:30:00  2.19    0.0  304.731  0.952  5.39  96.30  0.00  43.08   
 2000-01-04 03:00:00  2.27    0.0  304.731  0.971  5.59  96.30  0.00  43.08   
 2000-01-04 03:30:00  2.32    0.0  304.731  0.958  5.67  96.29  0.00  43.08   
 2000-01-04 04:00:00  2.34    0.0  304.731  0.938  6.61  96.26  0.00  43.08   
 2000-01-04 04:30:00  2.24    0.0  315.005  0.785  6.65  96.26  0.00  43.08   
 2000-01-04 05:00:00  2.00    0.0  315.005  0.529  6.12  96.27  0.00  43.08   
 2000-01-04 05:30:00  1.94    0.0  315.005  0.450  5.58  96.26  0.29  43.13   
 2000-01-04 06:00:00  2.07    0.0  315.005  0.499  4.70  96.25  0.00  43.13   
 2000-01-04 06:30:00  2.04    0.0  315.005  0.382  5.07  96.23  0.00  43.13   
 2000-01-04 07:00:00  2.03    0.0  315.005  0.313  5.23  96.24  0.00  43.13   
 
                        TS  
 time                       
 2000-01-04 02:30:00  1.31  
 2000-01-04 03:00:00  1.31  
 2000-01-04 03:30:00  1.31  
 2000-01-04 04:00:00  1.31  
 2000-01-04 04:30:00  1.31  
 2000-01-04 05:00:00  1.30  
 2000-01-04 05:30:00  1.30  
 2000-01-04 06:00:00  1.29  
 2000-01-04 06:30:00  1.29  
 2000-01-04 07:00:00  1.29  )</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L219" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="gap_fill_item" class="level3">
<h3 class="anchored" data-anchor-id="gap_fill_item">gap_fill_item</h3>
<blockquote class="blockquote">
<pre><code> gap_fill_item (item, REddy_df, var, filled)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>gap_fill_item(targ, REddy_df, <span class="st">"TA"</span>, filled)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TA</th>
<th data-quarto-table-cell-role="th">SW_IN</th>
<th data-quarto-table-cell-role="th">LW_IN</th>
<th data-quarto-table-cell-role="th">VPD</th>
<th data-quarto-table-cell-role="th">WS</th>
<th data-quarto-table-cell-role="th">PA</th>
<th data-quarto-table-cell-role="th">P</th>
<th data-quarto-table-cell-role="th">SWC</th>
<th data-quarto-table-cell-role="th">TS</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">time</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-03 04:00:00</td>
<td>0.81</td>
<td>0.0</td>
<td>304.148</td>
<td>0.000</td>
<td>3.53</td>
<td>97.00</td>
<td>0.0</td>
<td>43.09</td>
<td>1.37</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2000-01-03 04:30:00</td>
<td>0.95</td>
<td>0.0</td>
<td>304.382</td>
<td>0.000</td>
<td>3.99</td>
<td>96.98</td>
<td>0.0</td>
<td>43.09</td>
<td>1.37</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-03 05:00:00</td>
<td>1.09</td>
<td>0.0</td>
<td>304.382</td>
<td>0.000</td>
<td>3.61</td>
<td>96.96</td>
<td>0.0</td>
<td>43.09</td>
<td>1.37</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2000-01-03 05:30:00</td>
<td>1.18</td>
<td>0.0</td>
<td>304.382</td>
<td>0.009</td>
<td>3.90</td>
<td>96.93</td>
<td>0.0</td>
<td>43.09</td>
<td>1.37</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-03 06:00:00</td>
<td>1.35</td>
<td>0.0</td>
<td>304.382</td>
<td>0.061</td>
<td>4.17</td>
<td>96.91</td>
<td>0.0</td>
<td>43.09</td>
<td>1.38</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-05 03:30:00</td>
<td>4.62</td>
<td>0.0</td>
<td>330.202</td>
<td>1.162</td>
<td>6.53</td>
<td>95.91</td>
<td>0.0</td>
<td>44.12</td>
<td>1.82</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2000-01-05 04:00:00</td>
<td>4.51</td>
<td>0.0</td>
<td>330.202</td>
<td>1.636</td>
<td>5.76</td>
<td>95.94</td>
<td>0.0</td>
<td>44.12</td>
<td>1.85</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-05 04:30:00</td>
<td>4.11</td>
<td>0.0</td>
<td>299.320</td>
<td>1.746</td>
<td>5.79</td>
<td>95.98</td>
<td>0.0</td>
<td>44.12</td>
<td>1.85</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2000-01-05 05:00:00</td>
<td>3.77</td>
<td>0.0</td>
<td>299.320</td>
<td>2.065</td>
<td>6.00</td>
<td>96.03</td>
<td>0.0</td>
<td>44.12</td>
<td>1.83</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-05 05:30:00</td>
<td>3.36</td>
<td>0.0</td>
<td>299.320</td>
<td>1.911</td>
<td>4.76</td>
<td>96.10</td>
<td>0.0</td>
<td>44.11</td>
<td>1.81</td>
</tr>
</tbody>
</table>

<p>100 rows  9 columns</p>
</div>
</div>
</div>
<section id="mdsimputation" class="level4">
<h4 class="anchored" data-anchor-id="mdsimputation">MDSImputation</h4>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L229" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
</section>
<section id="mdsimputation-1" class="level3">
<h3 class="anchored" data-anchor-id="mdsimputation-1">MDSImputation</h3>
<blockquote class="blockquote">
<pre><code> MDSImputation (var, df)</code></pre>
</blockquote>
<p>Initialize self. See help(type(self)) for accurate signature.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>mds_imp <span class="op">=</span> MDSImputation(<span class="st">'TA'</span>, hai)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>mds_imp(targ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TA</th>
<th data-quarto-table-cell-role="th">SW_IN</th>
<th data-quarto-table-cell-role="th">LW_IN</th>
<th data-quarto-table-cell-role="th">VPD</th>
<th data-quarto-table-cell-role="th">WS</th>
<th data-quarto-table-cell-role="th">PA</th>
<th data-quarto-table-cell-role="th">P</th>
<th data-quarto-table-cell-role="th">SWC</th>
<th data-quarto-table-cell-role="th">TS</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">time</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-03 04:00:00</td>
<td>0.81</td>
<td>0.0</td>
<td>304.148</td>
<td>0.000</td>
<td>3.53</td>
<td>97.00</td>
<td>0.0</td>
<td>43.09</td>
<td>1.37</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2000-01-03 04:30:00</td>
<td>0.95</td>
<td>0.0</td>
<td>304.382</td>
<td>0.000</td>
<td>3.99</td>
<td>96.98</td>
<td>0.0</td>
<td>43.09</td>
<td>1.37</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-03 05:00:00</td>
<td>1.09</td>
<td>0.0</td>
<td>304.382</td>
<td>0.000</td>
<td>3.61</td>
<td>96.96</td>
<td>0.0</td>
<td>43.09</td>
<td>1.37</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2000-01-03 05:30:00</td>
<td>1.18</td>
<td>0.0</td>
<td>304.382</td>
<td>0.009</td>
<td>3.90</td>
<td>96.93</td>
<td>0.0</td>
<td>43.09</td>
<td>1.37</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-03 06:00:00</td>
<td>1.35</td>
<td>0.0</td>
<td>304.382</td>
<td>0.061</td>
<td>4.17</td>
<td>96.91</td>
<td>0.0</td>
<td>43.09</td>
<td>1.38</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-05 03:30:00</td>
<td>4.62</td>
<td>0.0</td>
<td>330.202</td>
<td>1.162</td>
<td>6.53</td>
<td>95.91</td>
<td>0.0</td>
<td>44.12</td>
<td>1.82</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2000-01-05 04:00:00</td>
<td>4.51</td>
<td>0.0</td>
<td>330.202</td>
<td>1.636</td>
<td>5.76</td>
<td>95.94</td>
<td>0.0</td>
<td>44.12</td>
<td>1.85</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-05 04:30:00</td>
<td>4.11</td>
<td>0.0</td>
<td>299.320</td>
<td>1.746</td>
<td>5.79</td>
<td>95.98</td>
<td>0.0</td>
<td>44.12</td>
<td>1.85</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2000-01-05 05:00:00</td>
<td>3.77</td>
<td>0.0</td>
<td>299.320</td>
<td>2.065</td>
<td>6.00</td>
<td>96.03</td>
<td>0.0</td>
<td>44.12</td>
<td>1.83</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-05 05:30:00</td>
<td>3.36</td>
<td>0.0</td>
<td>299.320</td>
<td>1.911</td>
<td>4.76</td>
<td>96.10</td>
<td>0.0</td>
<td>44.11</td>
<td>1.81</td>
</tr>
</tbody>
</table>

<p>100 rows  9 columns</p>
</div>
</div>
</div>
</section>
<section id="era-imputation" class="level3">
<h3 class="anchored" data-anchor-id="era-imputation">ERA Imputation</h3>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L242" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="eraimputation" class="level3">
<h3 class="anchored" data-anchor-id="eraimputation">ERAImputation</h3>
<blockquote class="blockquote">
<pre><code> ERAImputation ()</code></pre>
</blockquote>
<p>Initialize self. See help(type(self)) for accurate signature.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>targ.data.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['TA', 'SW_IN', 'LW_IN', 'VPD', 'WS', 'PA', 'P', 'SWC', 'TS'], dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>era_imp <span class="op">=</span> ERAImputation()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>era_imp(targ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TA</th>
<th data-quarto-table-cell-role="th">SW_IN</th>
<th data-quarto-table-cell-role="th">VPD</th>
<th data-quarto-table-cell-role="th">PA</th>
<th data-quarto-table-cell-role="th">P</th>
<th data-quarto-table-cell-role="th">WS</th>
<th data-quarto-table-cell-role="th">LW_IN</th>
<th data-quarto-table-cell-role="th">SWC</th>
<th data-quarto-table-cell-role="th">TS</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">time</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-03 04:00:00</td>
<td>1.702</td>
<td>0.0</td>
<td>0.693</td>
<td>97.016</td>
<td>0.000</td>
<td>2.948</td>
<td>304.148</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2000-01-03 04:30:00</td>
<td>1.762</td>
<td>0.0</td>
<td>0.691</td>
<td>97.002</td>
<td>0.026</td>
<td>2.989</td>
<td>304.382</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-03 05:00:00</td>
<td>1.736</td>
<td>0.0</td>
<td>0.697</td>
<td>96.988</td>
<td>0.000</td>
<td>3.015</td>
<td>304.382</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2000-01-03 05:30:00</td>
<td>1.711</td>
<td>0.0</td>
<td>0.703</td>
<td>96.974</td>
<td>0.000</td>
<td>3.041</td>
<td>304.382</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-03 06:00:00</td>
<td>1.686</td>
<td>0.0</td>
<td>0.709</td>
<td>96.960</td>
<td>0.000</td>
<td>3.066</td>
<td>304.382</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-05 03:30:00</td>
<td>4.945</td>
<td>0.0</td>
<td>0.774</td>
<td>95.910</td>
<td>0.252</td>
<td>6.107</td>
<td>330.202</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2000-01-05 04:00:00</td>
<td>4.789</td>
<td>0.0</td>
<td>0.758</td>
<td>95.926</td>
<td>0.252</td>
<td>6.189</td>
<td>330.202</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-05 04:30:00</td>
<td>4.632</td>
<td>0.0</td>
<td>0.741</td>
<td>95.942</td>
<td>0.044</td>
<td>6.270</td>
<td>299.320</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2000-01-05 05:00:00</td>
<td>4.251</td>
<td>0.0</td>
<td>0.766</td>
<td>95.988</td>
<td>0.000</td>
<td>5.923</td>
<td>299.320</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-05 05:30:00</td>
<td>3.869</td>
<td>0.0</td>
<td>0.790</td>
<td>96.035</td>
<td>0.000</td>
<td>5.576</td>
<td>299.320</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>100 rows  9 columns</p>
</div>
</div>
</div>
<p><span class="math inline">\(\sigma\)</span></p>
</section>
</section>
<section id="metrics" class="level2">
<h2 class="anchored" data-anchor-id="metrics">Metrics</h2>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L256" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="maskedmetric" class="level3">
<h3 class="anchored" data-anchor-id="maskedmetric">MaskedMetric</h3>
<blockquote class="blockquote">
<pre><code> MaskedMetric (metric)</code></pre>
</blockquote>
<p>Initialize self. See help(type(self)) for accurate signature.</p>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L269" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="rmse" class="level3">
<h3 class="anchored" data-anchor-id="rmse">rmse</h3>
<blockquote class="blockquote">
<pre><code> rmse (y_true, y_pred)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L274" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="normalizedmetric" class="level3">
<h3 class="anchored" data-anchor-id="normalizedmetric">NormalizedMetric</h3>
<blockquote class="blockquote">
<pre><code> NormalizedMetric (metric:__main__.MaskedMetric, mean, std)</code></pre>
</blockquote>
<p>Initialize self. See help(type(self)) for accurate signature.</p>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L273" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="normalize" class="level3">
<h3 class="anchored" data-anchor-id="normalize">normalize</h3>
<blockquote class="blockquote">
<pre><code> normalize (x, mean, std)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>rmse_mask(targ, pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([0.3698457])</code></pre>
</div>
</div>
</section>
<section id="validation-imputations" class="level3">
<h3 class="anchored" data-anchor-id="validation-imputations">Validation Imputations</h3>
<p>checks that the values of the imputation makes sense</p>
<p>this is the average error for ERA</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>np.sqrt((hai[<span class="st">'TA'</span>] <span class="op">-</span> hai_era.loc[hai.index][<span class="st">'TA_ERA'</span>]).<span class="bu">pow</span>(<span class="dv">2</span>).mean())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>1.8708585984196093</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>rmse_mask(targ, ERAImputation()(targ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([0.29919709])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>err_era <span class="op">=</span> []</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>):</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>    items <span class="op">=</span> random.choices(dls.items, k <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>    targ <span class="op">=</span> orig_target(dls, items)[<span class="dv">0</span>]</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>    err_era.append(rmse_mask(targ, ERAImputation()(targ)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>np.array(err_era).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>1.3839633283333717</code></pre>
</div>
</div>
</section>
</section>
<section id="comparison" class="level2">
<h2 class="anchored" data-anchor-id="comparison">Comparison</h2>
<p>Take a variable to be filled, makes an artificial gap of given len, tries to fill with 3 methods and return metrics for each of them, repeat <code>n_rep</code> times</p>
<section id="prep-visualization" class="level3">
<h3 class="anchored" data-anchor-id="prep-visualization">prep visualization</h3>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L309" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="gaplen2hours" class="level3">
<h3 class="anchored" data-anchor-id="gaplen2hours">gaplen2hours</h3>
<blockquote class="blockquote">
<pre><code> gaplen2hours (x)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L313" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="prep_df" class="level3">
<h3 class="anchored" data-anchor-id="prep_df">prep_df</h3>
<blockquote class="blockquote">
<pre><code> prep_df (df)</code></pre>
</blockquote>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>df</td>
<td>what a bad name</td>
</tr>
</tbody>
</table>
</section>
<section id="aggregation" class="level3">
<h3 class="anchored" data-anchor-id="aggregation">Aggregation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>hai.std(axis<span class="op">=</span><span class="dv">0</span>)[<span class="st">'TA'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>7.924610764367695</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>get_stats(hai)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(tensor([8.3339e+00, 1.2096e+02, 3.1150e+02, 3.3807e+00, 3.1800e+00, 9.5962e+01,
         4.3427e-02, 3.4843e+01, 7.9349e+00], dtype=torch.float64),
 tensor([  7.9246, 204.0026,  41.9557,   4.3684,   1.6254,   0.8552,   0.2803,
           8.9131,   5.6586], dtype=torch.float64))</code></pre>
</div>
</div>
<p><span class="math display">\[ \text{RMSE}_\text{stand} = \frac{1}{\sigma}\text{RMSE}\]</span></p>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L318" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="rmseagg" class="level3">
<h3 class="anchored" data-anchor-id="rmseagg">RMSEAgg</h3>
<blockquote class="blockquote">
<pre><code> RMSEAgg (df)</code></pre>
</blockquote>
<p>Aggregate to rmse and normalized rmse</p>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L316" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="timeseriesagg" class="level3">
<h3 class="anchored" data-anchor-id="timeseriesagg">timeseriesAgg</h3>
<blockquote class="blockquote">
<pre><code> timeseriesAgg (targ, pred, *args)</code></pre>
</blockquote>
</section>
<section id="imp-methods" class="level3">
<h3 class="anchored" data-anchor-id="imp-methods">Imp Methods</h3>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L328" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="impcomparison" class="level3">
<h3 class="anchored" data-anchor-id="impcomparison">ImpComparison</h3>
<blockquote class="blockquote">
<pre><code> ImpComparison (models:pandas.core.frame.DataFrame, df, control,
                block_len, rmse=True, time_series=False)</code></pre>
</blockquote>
<p>Initialize self. See help(type(self)) for accurate signature.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>base_path <span class="op">=</span> here(<span class="st">"analysis/results/trained_14feb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L620" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="l_model" class="level3">
<h3 class="anchored" data-anchor-id="l_model">l_model</h3>
<blockquote class="blockquote">
<pre><code> l_model (x)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>models_var <span class="op">=</span> [</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'var'</span>: <span class="st">'TA'</span>,    <span class="st">'model'</span>: l_model(<span class="st">"TA_specialized_gap_12-336_v2.pickle.pickle"</span>)},</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'var'</span>: <span class="st">'SW_IN'</span>, <span class="st">'model'</span>: l_model(<span class="st">"SW_IN_specialized_gap_12-336_v2.pickle.pickle"</span>)},</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'var'</span>: <span class="st">'LW_IN'</span>, <span class="st">'model'</span>: l_model(<span class="st">"LW_IN_specialized_gap_12-336_v1.pickle"</span>)},</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'var'</span>: <span class="st">'VPD'</span>,   <span class="st">'model'</span>: l_model(<span class="st">"VPD_specialized_gap_12-336_v1.pickle"</span>)},</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'var'</span>: <span class="st">'WS'</span>,    <span class="st">'model'</span>: l_model(<span class="st">"VPD_specialized_gap_12-336_v1.pickle"</span>)},</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'var'</span>: <span class="st">'PA'</span>,    <span class="st">'model'</span>: l_model(<span class="st">"VPD_specialized_gap_12-336_v3.pickle.pickle"</span>)},</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'var'</span>: <span class="st">'P'</span>,     <span class="st">'model'</span>: l_model(<span class="st">"P_specialized_gap_12-336_v1.pickle"</span>)},</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'var'</span>: <span class="st">'TS'</span>,    <span class="st">'model'</span>: l_model(<span class="st">"TS_specialized_gap_12-336_v2.pickle.pickle"</span>)},</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'var'</span>: <span class="st">'SWC'</span>,   <span class="st">'model'</span>: l_model(<span class="st">"SWC_specialized_gap_12-336_v2.pickle.pickle"</span>)},</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>models_var <span class="op">=</span> pd.DataFrame.from_records(models_var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>comp <span class="op">=</span> ImpComparison(models <span class="op">=</span> models_var, df <span class="op">=</span> hai, control <span class="op">=</span> hai_era, block_len <span class="op">=</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>data_results <span class="op">=</span> comp.compare(gap_len <span class="op">=</span> [<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>, <span class="dv">45</span>], var<span class="op">=</span>[<span class="st">"TA"</span>, <span class="st">"SW_IN"</span>], n_rep<span class="op">=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"67e15417f55f441e95de5b5e9a33c393","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>data_results.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">method</th>
<th data-quarto-table-cell-role="th">var</th>
<th data-quarto-table-cell-role="th">gap_len</th>
<th data-quarto-table-cell-role="th">idx_rep</th>
<th data-quarto-table-cell-role="th">rmse</th>
<th data-quarto-table-cell-role="th">rmse_stand</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>KalmanFilter</td>
<td>TA</td>
<td>2.5</td>
<td>0</td>
<td>0.458599</td>
<td>0.057870</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>KalmanFilter</td>
<td>TA</td>
<td>2.5</td>
<td>1</td>
<td>0.156532</td>
<td>0.019753</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>KalmanFilter</td>
<td>TA</td>
<td>2.5</td>
<td>2</td>
<td>0.174399</td>
<td>0.022007</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>KalmanFilter</td>
<td>TA</td>
<td>2.5</td>
<td>3</td>
<td>0.361323</td>
<td>0.045595</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>KalmanFilter</td>
<td>TA</td>
<td>2.5</td>
<td>4</td>
<td>0.655402</td>
<td>0.082705</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>data_results.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['method', 'var', 'gap_len', 'idx_rep', 'rmse', 'rmse_stand'], dtype='object')</code></pre>
</div>
</div>
</section>
<section id="kalman-filters" class="level3">
<h3 class="anchored" data-anchor-id="kalman-filters">Kalman Filters</h3>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L376" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="kalmanimpcomparison" class="level3">
<h3 class="anchored" data-anchor-id="kalmanimpcomparison">KalmanImpComparison</h3>
<blockquote class="blockquote">
<pre><code> KalmanImpComparison (models:pandas.core.frame.DataFrame,
                      df:pandas.core.frame.DataFrame,
                      control:pandas.core.frame.DataFrame, block_len:int,
                      rmse:bool=True, time_series:bool=False)</code></pre>
</blockquote>
<p>Compare different Kalman filters</p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>models</td>
<td>DataFrame</td>
<td></td>
<td>model, gap_single_var,</td>
</tr>
<tr class="even">
<td>df</td>
<td>DataFrame</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>control</td>
<td>DataFrame</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>block_len</td>
<td>int</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>rmse</td>
<td>bool</td>
<td>True</td>
<td></td>
</tr>
<tr class="even">
<td>time_series</td>
<td>bool</td>
<td>False</td>
<td></td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> pd.DataFrame(columns <span class="op">=</span> [<span class="st">"use_control"</span>, <span class="st">"gap_single_var"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>base_path <span class="op">=</span> here(<span class="st">"analysis/results/trained_13feb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L620" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="l_model-1" class="level3">
<h3 class="anchored" data-anchor-id="l_model-1">l_model</h3>
<blockquote class="blockquote">
<pre><code> l_model (x)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> [</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'use_control'</span>: <span class="va">True</span>,  <span class="st">'gap_single_var'</span>: <span class="va">True</span>,  <span class="st">'model'</span>: l_model(<span class="st">"1_gap_varying_12-336_v1.pickle"</span>)},</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'use_control'</span>: <span class="va">True</span>,  <span class="st">'gap_single_var'</span>: <span class="va">False</span>, <span class="st">'model'</span>: l_model(<span class="st">"All_gap_all_30_v1.pickle"</span>)},</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'use_control'</span>: <span class="va">False</span>, <span class="st">'gap_single_var'</span>: <span class="va">False</span>, <span class="st">'model'</span>: l_model(<span class="st">"1_gap_varying_336_no_control_v1.pickle"</span>)},</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'use_control'</span>: <span class="va">False</span>, <span class="st">'gap_single_var'</span>: <span class="va">True</span>,  <span class="st">'model'</span>: l_model(<span class="st">"1_gap_varying_336_no_control_v1.pickle"</span>)},</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> pd.DataFrame.from_records(models)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>kcomp <span class="op">=</span> KalmanImpComparison(models, hai, hai_era, <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>models</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">use_control</th>
<th data-quarto-table-cell-role="th">gap_single_var</th>
<th data-quarto-table-cell-role="th">model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>True</td>
<td>True</td>
<td>Kalman Filter\n N dim obs: 9,\n N dim state: 18,\n N dim contr: 14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>True</td>
<td>False</td>
<td>Kalman Filter\n N dim obs: 9,\n N dim state: 18,\n N dim contr: 14</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>False</td>
<td>False</td>
<td>Kalman Filter\n N dim obs: 9,\n N dim state: 18,\n N dim contr: 14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>False</td>
<td>True</td>
<td>Kalman Filter\n N dim obs: 9,\n N dim state: 18,\n N dim contr: 14</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>k_results <span class="op">=</span> kcomp.compare(n_rep <span class="op">=</span><span class="dv">3</span>, gap_len <span class="op">=</span> [<span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">24</span>], var <span class="op">=</span> <span class="bu">list</span>(hai.columns))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8728496b95684f1c9a727b4011830616","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>k_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">var</th>
<th data-quarto-table-cell-role="th">loss</th>
<th data-quarto-table-cell-role="th">likelihood</th>
<th data-quarto-table-cell-role="th">gap_len</th>
<th data-quarto-table-cell-role="th">gap_idx</th>
<th data-quarto-table-cell-role="th">use_control</th>
<th data-quarto-table-cell-role="th">gap_single_var</th>
<th data-quarto-table-cell-role="th">rmse</th>
<th data-quarto-table-cell-role="th">rmse_stand</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>TA</td>
<td>-5.280393</td>
<td>2.671731</td>
<td>3.0</td>
<td>0</td>
<td>True</td>
<td>True</td>
<td>0.131880</td>
<td>0.016642</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>TA</td>
<td>-4.566644</td>
<td>2.487593</td>
<td>3.0</td>
<td>1</td>
<td>True</td>
<td>True</td>
<td>0.663002</td>
<td>0.083664</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>TA</td>
<td>-5.032340</td>
<td>2.686779</td>
<td>3.0</td>
<td>2</td>
<td>True</td>
<td>True</td>
<td>0.390265</td>
<td>0.049247</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>TA</td>
<td>-6.865580</td>
<td>4.571592</td>
<td>3.0</td>
<td>0</td>
<td>True</td>
<td>False</td>
<td>0.599223</td>
<td>0.075615</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>TA</td>
<td>-8.085504</td>
<td>4.509787</td>
<td>3.0</td>
<td>1</td>
<td>True</td>
<td>False</td>
<td>0.146722</td>
<td>0.018515</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>TS</td>
<td>34.731586</td>
<td>0.887256</td>
<td>12.0</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>2.722457</td>
<td>0.481115</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>TS</td>
<td>66.913388</td>
<td>0.769370</td>
<td>12.0</td>
<td>2</td>
<td>False</td>
<td>False</td>
<td>20.535604</td>
<td>3.629069</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>TS</td>
<td>7.724566</td>
<td>1.516849</td>
<td>12.0</td>
<td>0</td>
<td>False</td>
<td>True</td>
<td>1.946988</td>
<td>0.344073</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>TS</td>
<td>-0.383060</td>
<td>1.612699</td>
<td>12.0</td>
<td>1</td>
<td>False</td>
<td>True</td>
<td>0.809863</td>
<td>0.143120</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>TS</td>
<td>11.871315</td>
<td>1.390741</td>
<td>12.0</td>
<td>2</td>
<td>False</td>
<td>True</td>
<td>2.392871</td>
<td>0.422870</td>
</tr>
</tbody>
</table>

<p>324 rows  9 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="plotting" class="level2">
<h2 class="anchored" data-anchor-id="plotting">Plotting</h2>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L454" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="facet_wrap" class="level3">
<h3 class="anchored" data-anchor-id="facet_wrap">facet_wrap</h3>
<blockquote class="blockquote">
<pre><code> facet_wrap (data:pandas.core.frame.DataFrame, plot_fn, col:str,
             y_labels:list[str]|None=None, n_cols=3,
             y_resolve='independent')</code></pre>
</blockquote>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>data</td>
<td>DataFrame</td>
<td></td>
<td>full dataset</td>
</tr>
<tr class="even">
<td>plot_fn</td>
<td></td>
<td></td>
<td>function that makes the plot, takes 2 arguments: data and y_label</td>
</tr>
<tr class="odd">
<td>col</td>
<td>str</td>
<td></td>
<td>column to facet</td>
</tr>
<tr class="even">
<td>y_labels</td>
<td>list[str] | None</td>
<td>None</td>
<td>custom labels y axis</td>
</tr>
<tr class="odd">
<td>n_cols</td>
<td>int</td>
<td>3</td>
<td></td>
</tr>
<tr class="even">
<td>y_resolve</td>
<td>str</td>
<td>independent</td>
<td></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L474" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="facet_grid" class="level3">
<h3 class="anchored" data-anchor-id="facet_grid">facet_grid</h3>
<blockquote class="blockquote">
<pre><code> facet_grid (data:pandas.core.frame.DataFrame, plot_fn, col:str, row:str,
             y_labels:list[str]|None=None)</code></pre>
</blockquote>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>data</td>
<td>DataFrame</td>
<td></td>
<td>full dataset</td>
</tr>
<tr class="even">
<td>plot_fn</td>
<td></td>
<td></td>
<td>function that makes the plot, takes 2 arguments: data and y_label</td>
</tr>
<tr class="odd">
<td>col</td>
<td>str</td>
<td></td>
<td>column to facet,</td>
</tr>
<tr class="even">
<td>row</td>
<td>str</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>y_labels</td>
<td>list[str] | None</td>
<td>None</td>
<td>custom labels y axis</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> pd.DataFrame(<span class="bu">list</span>(product([<span class="st">'0'</span>,<span class="st">'1'</span>], [<span class="st">'a'</span>, <span class="st">'b'</span>])), columns <span class="op">=</span> [<span class="st">'row'</span>, <span class="st">'col'</span>])</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>test_data[<span class="st">'text'</span>] <span class="op">=</span> test_data.row <span class="op">+</span> test_data.col</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> test_plot(data, <span class="op">*</span>args): <span class="cf">return</span> alt.Chart(data).mark_text().encode(text<span class="op">=</span><span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>facet_wrap(test_data, test_plot, col <span class="op">=</span> <span class="st">'row'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div id="altair-viz-a4974491e82b4b17b4f742852d0c4166"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-a4974491e82b4b17b4f742852d0c4166") {
      outputDiv = document.getElementById("altair-viz-a4974491e82b4b17b4f742852d0c4166");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.2.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.2.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "vconcat": [{"hconcat": [{"mark": "text", "encoding": {"text": {"field": "text", "type": "nominal"}}, "title": "0"}, {"data": {"name": "data-3b4bb4407d10d355deeefbc25d1c7fb8"}, "mark": "text", "encoding": {"text": {"field": "text", "type": "nominal"}}, "title": "1"}]}], "data": {"name": "data-8c79f6f2a7e784a5debf560bf3815208"}, "resolve": {"scale": {"xOffset": "independent"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.2.0.json", "datasets": {"data-8c79f6f2a7e784a5debf560bf3815208": [{"row": "0", "col": "a", "text": "0a"}, {"row": "0", "col": "b", "text": "0b"}], "data-3b4bb4407d10d355deeefbc25d1c7fb8": [{"row": "1", "col": "a", "text": "1a"}, {"row": "1", "col": "b", "text": "1b"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>facet_grid(test_data, test_plot, col <span class="op">=</span> <span class="st">'col'</span>, row<span class="op">=</span><span class="st">'row'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div id="altair-viz-e9bb600b6aba4f4399e1d84e0b699ca5"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-e9bb600b6aba4f4399e1d84e0b699ca5") {
      outputDiv = document.getElementById("altair-viz-e9bb600b6aba4f4399e1d84e0b699ca5");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.2.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.2.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "vconcat": [{"vconcat": [{"hconcat": [{"mark": "text", "encoding": {"text": {"field": "text", "type": "nominal"}}, "title": "a"}, {"data": {"name": "data-f20217130d2fd3a8bd411768620867f4"}, "mark": "text", "encoding": {"text": {"field": "text", "type": "nominal"}}, "title": "b"}]}], "data": {"name": "data-bcec33718fc2d0107d4dd3cd1ef4de05"}, "resolve": {"scale": {"xOffset": "independent"}}, "title": "0"}, {"vconcat": [{"hconcat": [{"mark": "text", "encoding": {"text": {"field": "text", "type": "nominal"}}, "title": "a"}, {"data": {"name": "data-93362acdbb1f83408b5ea74a7702b071"}, "mark": "text", "encoding": {"text": {"field": "text", "type": "nominal"}}, "title": "b"}]}], "data": {"name": "data-3fa31d7f1c047be528e8fc3c5f4071c1"}, "resolve": {"scale": {"xOffset": "independent"}}, "title": "1"}], "$schema": "https://vega.github.io/schema/vega-lite/v5.2.0.json", "datasets": {"data-bcec33718fc2d0107d4dd3cd1ef4de05": [{"row": "0", "col": "a", "text": "0a"}], "data-f20217130d2fd3a8bd411768620867f4": [{"row": "0", "col": "b", "text": "0b"}], "data-3fa31d7f1c047be528e8fc3c5f4071c1": [{"row": "1", "col": "a", "text": "1a"}], "data-93362acdbb1f83408b5ea74a7702b071": [{"row": "1", "col": "b", "text": "1b"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</section>
<section id="the-plot" class="level3">
<h3 class="anchored" data-anchor-id="the-plot">The Plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_outliers(data, var, groupby):</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Simple but maybe computationally inefficent to remove outliers from boxplot """</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> custom_box_plot(data, x, y, color, xoffset):</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Boxplot for altair without outliers"""</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>    bar <span class="op">=</span> alt.Chart(data).mark_bar().encode(</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span>x,</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>            y<span class="op">=</span><span class="st">'q1:Q'</span>,</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>            y2<span class="op">=</span><span class="st">'q2:Q'</span>,</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span>color,</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>            xoffset<span class="op">=</span>xoffset</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>        ).transform_aggregate(</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>            q1<span class="op">=</span><span class="ss">f'q1(</span><span class="sc">{</span>y<span class="sc">}</span><span class="ss">)'</span>,</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>            q3<span class="op">=</span><span class="ss">f'q1(</span><span class="sc">{</span>y<span class="sc">}</span><span class="ss">)'</span>,</span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>            groupby<span class="op">=</span>[color, xoffset]</span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> bar</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># custom_box_plot(data_results, 'gap_len', 'rmse', 'method', 'method')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L505" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="the_plot" class="level3">
<h3 class="anchored" data-anchor-id="the_plot">the_plot</h3>
<blockquote class="blockquote">
<pre><code> the_plot (data)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>the_plot(data_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div id="altair-viz-94dcdf1bc1474debad07aa639ed97a47"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-94dcdf1bc1474debad07aa639ed97a47") {
      outputDiv = document.getElementById("altair-viz-94dcdf1bc1474debad07aa639ed97a47");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.2.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.2.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}, "legend": {"orient": "bottom"}}, "vconcat": [{"hconcat": [{"mark": {"type": "boxplot", "extent": "min-max"}, "encoding": {"color": {"field": "method", "scale": {"domain": ["KalmanFilter", "ERA", "MDS"], "scheme": "dark2"}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0}, "field": "gap_len", "title": "gap_len [h]", "type": "nominal"}, "xOffset": {"field": "method", "scale": {"domain": ["KalmanFilter", "ERA", "MDS"]}, "sort": ["KalmanFilter", "ERA", "MDS"], "type": "ordinal"}, "y": {"axis": {"grid": true}, "field": "rmse", "title": "rmse TA [\u00b0C]", "type": "quantitative"}}, "height": 200, "title": "TA", "width": 250}, {"data": {"name": "data-90166fd4a71f41e3483e1d308ae1df3f"}, "mark": {"type": "boxplot", "extent": "min-max"}, "encoding": {"color": {"field": "method", "scale": {"domain": ["KalmanFilter", "ERA", "MDS"], "scheme": "dark2"}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0}, "field": "gap_len", "title": "gap_len [h]", "type": "nominal"}, "xOffset": {"field": "method", "scale": {"domain": ["KalmanFilter", "ERA", "MDS"]}, "sort": ["KalmanFilter", "ERA", "MDS"], "type": "ordinal"}, "y": {"axis": {"grid": true}, "field": "rmse", "title": "rmse SW_IN [W m-2]", "type": "quantitative"}}, "height": 200, "title": "SW_IN", "width": 250}]}], "data": {"name": "data-57b235acc3e0da4b249c35ef8dd6de1f"}, "resolve": {"scale": {"xOffset": "independent"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.2.0.json", "datasets": {"data-57b235acc3e0da4b249c35ef8dd6de1f": [{"method": "KalmanFilter", "var": "TA", "gap_len": 2.5, "idx_rep": 0, "rmse": 0.45859917867745875, "rmse_stand": 0.05787024654125715}, {"method": "KalmanFilter", "var": "TA", "gap_len": 2.5, "idx_rep": 1, "rmse": 0.1565318544722203, "rmse_stand": 0.019752623709425807}, {"method": "KalmanFilter", "var": "TA", "gap_len": 2.5, "idx_rep": 2, "rmse": 0.17439920963505967, "rmse_stand": 0.022007290303673988}, {"method": "KalmanFilter", "var": "TA", "gap_len": 2.5, "idx_rep": 3, "rmse": 0.36132286304577765, "rmse_stand": 0.04559502968529807}, {"method": "KalmanFilter", "var": "TA", "gap_len": 2.5, "idx_rep": 4, "rmse": 0.6554024098455221, "rmse_stand": 0.08270468157155182}, {"method": "ERA", "var": "TA", "gap_len": 2.5, "idx_rep": 0, "rmse": 1.4494880475533438, "rmse_stand": 0.18290968359869958}, {"method": "ERA", "var": "TA", "gap_len": 2.5, "idx_rep": 1, "rmse": 2.161609585470975, "rmse_stand": 0.2727717044716518}, {"method": "ERA", "var": "TA", "gap_len": 2.5, "idx_rep": 2, "rmse": 3.079831748651215, "rmse_stand": 0.3886413907544082}, {"method": "ERA", "var": "TA", "gap_len": 2.5, "idx_rep": 3, "rmse": 0.2689706303669617, "rmse_stand": 0.03394117873604142}, {"method": "ERA", "var": "TA", "gap_len": 2.5, "idx_rep": 4, "rmse": 0.9925782588793692, "rmse_stand": 0.12525261976807855}, {"method": "MDS", "var": "TA", "gap_len": 2.5, "idx_rep": 0, "rmse": 3.836379180880156, "rmse_stand": 0.4841094780490788}, {"method": "MDS", "var": "TA", "gap_len": 2.5, "idx_rep": 1, "rmse": 1.4774830321552226, "rmse_stand": 0.1864423472757291}, {"method": "MDS", "var": "TA", "gap_len": 2.5, "idx_rep": 2, "rmse": 1.9375648552665787, "rmse_stand": 0.24449968747722806}, {"method": "MDS", "var": "TA", "gap_len": 2.5, "idx_rep": 3, "rmse": 5.648068036692516, "rmse_stand": 0.712724978504755}, {"method": "MDS", "var": "TA", "gap_len": 2.5, "idx_rep": 4, "rmse": 0.3964013964302305, "rmse_stand": 0.05002156045475621}, {"method": "KalmanFilter", "var": "TA", "gap_len": 5.0, "idx_rep": 0, "rmse": 0.2688583185422039, "rmse_stand": 0.033927006200872516}, {"method": "KalmanFilter", "var": "TA", "gap_len": 5.0, "idx_rep": 1, "rmse": 1.2202396323108624, "rmse_stand": 0.15398101794444732}, {"method": "KalmanFilter", "var": "TA", "gap_len": 5.0, "idx_rep": 2, "rmse": 0.5364031724956462, "rmse_stand": 0.06768826740456896}, {"method": "KalmanFilter", "var": "TA", "gap_len": 5.0, "idx_rep": 3, "rmse": 0.8466554501787661, "rmse_stand": 0.10683874266552962}, {"method": "KalmanFilter", "var": "TA", "gap_len": 5.0, "idx_rep": 4, "rmse": 0.22290406604227006, "rmse_stand": 0.02812807753846262}, {"method": "ERA", "var": "TA", "gap_len": 5.0, "idx_rep": 0, "rmse": 0.6161552564086423, "rmse_stand": 0.07775211612652692}, {"method": "ERA", "var": "TA", "gap_len": 5.0, "idx_rep": 1, "rmse": 2.699802622415201, "rmse_stand": 0.34068583337299324}, {"method": "ERA", "var": "TA", "gap_len": 5.0, "idx_rep": 2, "rmse": 2.47888904552019, "rmse_stand": 0.31280893399412035}, {"method": "ERA", "var": "TA", "gap_len": 5.0, "idx_rep": 3, "rmse": 1.092673418730409, "rmse_stand": 0.13788354421689927}, {"method": "ERA", "var": "TA", "gap_len": 5.0, "idx_rep": 4, "rmse": 0.4736103883995789, "rmse_stand": 0.05976449853273876}, {"method": "MDS", "var": "TA", "gap_len": 5.0, "idx_rep": 0, "rmse": 0.37018423676457685, "rmse_stand": 0.04671323901851145}, {"method": "MDS", "var": "TA", "gap_len": 5.0, "idx_rep": 1, "rmse": 2.5049789719717106, "rmse_stand": 0.31610119997755914}, {"method": "MDS", "var": "TA", "gap_len": 5.0, "idx_rep": 2, "rmse": 1.3607584787271558, "rmse_stand": 0.1717129735690849}, {"method": "MDS", "var": "TA", "gap_len": 5.0, "idx_rep": 3, "rmse": 3.518030450205353, "rmse_stand": 0.44393731816127335}, {"method": "MDS", "var": "TA", "gap_len": 5.0, "idx_rep": 4, "rmse": 0.3487218153797257, "rmse_stand": 0.0440049140265314}, {"method": "KalmanFilter", "var": "TA", "gap_len": 10.0, "idx_rep": 0, "rmse": 0.3093641609454863, "rmse_stand": 0.03903840455313145}, {"method": "KalmanFilter", "var": "TA", "gap_len": 10.0, "idx_rep": 1, "rmse": 1.128727890568843, "rmse_stand": 0.14243322784307175}, {"method": "KalmanFilter", "var": "TA", "gap_len": 10.0, "idx_rep": 2, "rmse": 0.23575566323259534, "rmse_stand": 0.029749809832004575}, {"method": "KalmanFilter", "var": "TA", "gap_len": 10.0, "idx_rep": 3, "rmse": 0.7054704330482424, "rmse_stand": 0.08902272351600249}, {"method": "KalmanFilter", "var": "TA", "gap_len": 10.0, "idx_rep": 4, "rmse": 0.6711296732361712, "rmse_stand": 0.08468929177617732}, {"method": "ERA", "var": "TA", "gap_len": 10.0, "idx_rep": 0, "rmse": 0.6373100109052111, "rmse_stand": 0.0804216168913707}, {"method": "ERA", "var": "TA", "gap_len": 10.0, "idx_rep": 1, "rmse": 3.3073337448766793, "rmse_stand": 0.417349677254536}, {"method": "ERA", "var": "TA", "gap_len": 10.0, "idx_rep": 2, "rmse": 0.5084344598864242, "rmse_stand": 0.06415891896830497}, {"method": "ERA", "var": "TA", "gap_len": 10.0, "idx_rep": 3, "rmse": 1.0420521100213753, "rmse_stand": 0.13149568363746894}, {"method": "ERA", "var": "TA", "gap_len": 10.0, "idx_rep": 4, "rmse": 1.3107373306654544, "rmse_stand": 0.16540084675944816}, {"method": "MDS", "var": "TA", "gap_len": 10.0, "idx_rep": 0, "rmse": 1.909987068089248, "rmse_stand": 0.24101966959403665}, {"method": "MDS", "var": "TA", "gap_len": 10.0, "idx_rep": 1, "rmse": 0.9628557873659838, "rmse_stand": 0.12150196596347405}, {"method": "MDS", "var": "TA", "gap_len": 10.0, "idx_rep": 2, "rmse": 1.2267196441453094, "rmse_stand": 0.15479872521451082}, {"method": "MDS", "var": "TA", "gap_len": 10.0, "idx_rep": 3, "rmse": 2.680745456962698, "rmse_stand": 0.33828102561408196}, {"method": "MDS", "var": "TA", "gap_len": 10.0, "idx_rep": 4, "rmse": 1.3269395749489976, "rmse_stand": 0.16744539440542153}, {"method": "KalmanFilter", "var": "TA", "gap_len": 22.5, "idx_rep": 0, "rmse": 0.5864129798979331, "rmse_stand": 0.07399896314588557}, {"method": "KalmanFilter", "var": "TA", "gap_len": 22.5, "idx_rep": 1, "rmse": 0.2843142695520981, "rmse_stand": 0.03587737972324039}, {"method": "KalmanFilter", "var": "TA", "gap_len": 22.5, "idx_rep": 2, "rmse": 0.7435215897867138, "rmse_stand": 0.09382436713862241}, {"method": "KalmanFilter", "var": "TA", "gap_len": 22.5, "idx_rep": 3, "rmse": 0.5667248001907798, "rmse_stand": 0.07151452822629564}, {"method": "KalmanFilter", "var": "TA", "gap_len": 22.5, "idx_rep": 4, "rmse": 0.3841439659959281, "rmse_stand": 0.048474805566879976}, {"method": "ERA", "var": "TA", "gap_len": 22.5, "idx_rep": 0, "rmse": 1.667383605799484, "rmse_stand": 0.21040574173014598}, {"method": "ERA", "var": "TA", "gap_len": 22.5, "idx_rep": 1, "rmse": 1.3032615922284283, "rmse_stand": 0.16445748958276005}, {"method": "ERA", "var": "TA", "gap_len": 22.5, "idx_rep": 2, "rmse": 2.108127357527423, "rmse_stand": 0.26602282688841067}, {"method": "ERA", "var": "TA", "gap_len": 22.5, "idx_rep": 3, "rmse": 0.9962245284628918, "rmse_stand": 0.12571273947514577}, {"method": "ERA", "var": "TA", "gap_len": 22.5, "idx_rep": 4, "rmse": 0.7051317607369562, "rmse_stand": 0.08897998674048677}, {"method": "MDS", "var": "TA", "gap_len": 22.5, "idx_rep": 0, "rmse": 2.285323794678169, "rmse_stand": 0.28838309699120157}, {"method": "MDS", "var": "TA", "gap_len": 22.5, "idx_rep": 1, "rmse": 2.0471406981319173, "rmse_stand": 0.25832697138094185}, {"method": "MDS", "var": "TA", "gap_len": 22.5, "idx_rep": 2, "rmse": 2.372916288158608, "rmse_stand": 0.29943632043459023}, {"method": "MDS", "var": "TA", "gap_len": 22.5, "idx_rep": 3, "rmse": 1.880445459034662, "rmse_stand": 0.2372918386717386}, {"method": "MDS", "var": "TA", "gap_len": 22.5, "idx_rep": 4, "rmse": 2.030413253818859, "rmse_stand": 0.2562161491828004}], "data-90166fd4a71f41e3483e1d308ae1df3f": [{"method": "KalmanFilter", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 0, "rmse": 190.09913902131657, "rmse_stand": 0.9318468267638063}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 1, "rmse": 49.21839339415338, "rmse_stand": 0.24126360560534468}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 2, "rmse": 26.177013703672745, "rmse_stand": 0.12831708380954235}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 3, "rmse": 10.297807264588364, "rmse_stand": 0.05047881369444763}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 4, "rmse": 5.383079865402994, "rmse_stand": 0.026387315148383866}, {"method": "ERA", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 0, "rmse": 226.71763952943755, "rmse_stand": 1.1113470268963015}, {"method": "ERA", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 1, "rmse": 106.967430378597, "rmse_stand": 0.5243435666176098}, {"method": "ERA", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 2, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "ERA", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 3, "rmse": 20.03160425427779, "rmse_stand": 0.09819290584605954}, {"method": "ERA", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 4, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "MDS", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 0, "rmse": 203.68295492825962, "rmse_stand": 0.9984333237537226}, {"method": "MDS", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 1, "rmse": 56.693166616168064, "rmse_stand": 0.2779041908471979}, {"method": "MDS", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 2, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "MDS", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 3, "rmse": 7.710506345616034, "rmse_stand": 0.037796125263349085}, {"method": "MDS", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 4, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 0, "rmse": 47.70346067201218, "rmse_stand": 0.2338375580327166}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 1, "rmse": 29.676779166986936, "rmse_stand": 0.1454725815050958}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 2, "rmse": 32.89706145333922, "rmse_stand": 0.16125808082545082}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 3, "rmse": 51.410734516408716, "rmse_stand": 0.2520102409056148}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 4, "rmse": 21.583705190775863, "rmse_stand": 0.10580114826072233}, {"method": "ERA", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 0, "rmse": 0.3225523213371747, "rmse_stand": 0.0015811189816574696}, {"method": "ERA", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 1, "rmse": 59.8714043805555, "rmse_stand": 0.29348359215691777}, {"method": "ERA", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 2, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "ERA", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 3, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "ERA", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 4, "rmse": 13.338528093459189, "rmse_stand": 0.06538412084126305}, {"method": "MDS", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 0, "rmse": 5.924459982644022, "rmse_stand": 0.02904110593839633}, {"method": "MDS", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 1, "rmse": 39.57447171991995, "rmse_stand": 0.19399007319505107}, {"method": "MDS", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 2, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "MDS", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 3, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "MDS", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 4, "rmse": 17.4763607256079, "rmse_stand": 0.08566735951240262}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 0, "rmse": 113.96809836865074, "rmse_stand": 0.5586601357790674}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 1, "rmse": 114.14234927322714, "rmse_stand": 0.559514296157311}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 2, "rmse": 24.311262989267203, "rmse_stand": 0.11917136178417244}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 3, "rmse": 70.71423825946418, "rmse_stand": 0.34663407140267155}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 4, "rmse": 65.94746344490703, "rmse_stand": 0.32326782152005307}, {"method": "ERA", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 0, "rmse": 128.36896992575737, "rmse_stand": 0.6292517572467384}, {"method": "ERA", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 1, "rmse": 202.27108194697533, "rmse_stand": 0.9915124646473813}, {"method": "ERA", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 2, "rmse": 8.929423209256019, "rmse_stand": 0.04377113292156075}, {"method": "ERA", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 3, "rmse": 63.874882284823045, "rmse_stand": 0.31310823748838557}, {"method": "ERA", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 4, "rmse": 63.59749815519475, "rmse_stand": 0.31174852843173495}, {"method": "MDS", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 0, "rmse": 197.7548021609146, "rmse_stand": 0.9693741161567746}, {"method": "MDS", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 1, "rmse": 126.35930456701931, "rmse_stand": 0.6194005801344254}, {"method": "MDS", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 2, "rmse": 11.69406587379872, "rmse_stand": 0.057323132722049426}, {"method": "MDS", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 3, "rmse": 75.86027950442896, "rmse_stand": 0.37185944711559565}, {"method": "MDS", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 4, "rmse": 93.75999514125422, "rmse_stand": 0.4596020497492653}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 0, "rmse": 123.92483025030573, "rmse_stand": 0.6074670323101339}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 1, "rmse": 66.1532423186051, "rmse_stand": 0.32427652882645003}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 2, "rmse": 34.1542955804012, "rmse_stand": 0.16742091584844634}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 3, "rmse": 52.67158213966747, "rmse_stand": 0.2581907889229028}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 4, "rmse": 27.97643102886275, "rmse_stand": 0.13713764624414704}, {"method": "ERA", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 0, "rmse": 166.69426640676306, "rmse_stand": 0.8171184992765513}, {"method": "ERA", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 1, "rmse": 106.04031443936782, "rmse_stand": 0.5197989376915632}, {"method": "ERA", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 2, "rmse": 34.402950433873485, "rmse_stand": 0.1686397968878896}, {"method": "ERA", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 3, "rmse": 70.29130814877944, "rmse_stand": 0.3445609106108163}, {"method": "ERA", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 4, "rmse": 38.020916921259705, "rmse_stand": 0.1863747040945477}, {"method": "MDS", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 0, "rmse": 187.9939061991956, "rmse_stand": 0.921527187574528}, {"method": "MDS", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 1, "rmse": 106.93530013475957, "rmse_stand": 0.5241860673994798}, {"method": "MDS", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 2, "rmse": 29.948687926633866, "rmse_stand": 0.14680545084974791}, {"method": "MDS", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 3, "rmse": 170.95760776247306, "rmse_stand": 0.8380169690654323}, {"method": "MDS", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 4, "rmse": 73.08215120668197, "rmse_stand": 0.35824134209983344}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L509" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="the_plot_stand" class="level3">
<h3 class="anchored" data-anchor-id="the_plot_stand">the_plot_stand</h3>
<blockquote class="blockquote">
<pre><code> the_plot_stand (data)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L519" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="the_plot_stand2" class="level3">
<h3 class="anchored" data-anchor-id="the_plot_stand2">the_plot_stand2</h3>
<blockquote class="blockquote">
<pre><code> the_plot_stand2 (data)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="bu">dict</span>(<span class="bu">zip</span>(scale_meteo.domain, scale_meteo.<span class="bu">range</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>{'TA': '#1B9E77',
 'SW_IN': '#D95F02',
 'LW_IN': '#7570B3',
 'VPD': '#E7298A',
 'WS': '#66A61E',
 'PA': '#E6AB02',
 'SWC': '#A6761D',
 'TS': '#666666'}</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>the_plot_stand(data_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div id="altair-viz-5364a3b2fc54439dbd094cae44332f1d"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-5364a3b2fc54439dbd094cae44332f1d") {
      outputDiv = document.getElementById("altair-viz-5364a3b2fc54439dbd094cae44332f1d");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.2.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.2.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}, "legend": {"orient": "bottom"}}, "data": {"name": "data-4df2c5234880b2411871d564e0b16182"}, "mark": {"type": "boxplot", "extent": "min-max"}, "encoding": {"color": {"field": "method", "scale": {"domain": ["KalmanFilter", "ERA", "MDS"], "scheme": "dark2"}, "sort": ["KalmanFilter", "ERA", "MDS"], "type": "ordinal"}, "x": {"axis": {"labelAngle": 0}, "field": "var", "sort": ["TA", "SW_IN", "LW_IN", "VPD", "WS", "PA", "P", "SWC", "TS"], "title": "gap_len [h]", "type": "ordinal"}, "xOffset": {"field": "method", "scale": {"domain": ["KalmanFilter", "ERA", "MDS"]}, "type": "nominal"}, "y": {"axis": {"grid": true}, "field": "rmse_stand", "title": "RMSE Standardized", "type": "quantitative"}}, "height": 300, "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.2.0.json", "datasets": {"data-4df2c5234880b2411871d564e0b16182": [{"method": "KalmanFilter", "var": "TA", "gap_len": 2.5, "idx_rep": 0, "rmse": 0.45859917867745875, "rmse_stand": 0.05787024654125715}, {"method": "KalmanFilter", "var": "TA", "gap_len": 2.5, "idx_rep": 1, "rmse": 0.1565318544722203, "rmse_stand": 0.019752623709425807}, {"method": "KalmanFilter", "var": "TA", "gap_len": 2.5, "idx_rep": 2, "rmse": 0.17439920963505967, "rmse_stand": 0.022007290303673988}, {"method": "KalmanFilter", "var": "TA", "gap_len": 2.5, "idx_rep": 3, "rmse": 0.36132286304577765, "rmse_stand": 0.04559502968529807}, {"method": "KalmanFilter", "var": "TA", "gap_len": 2.5, "idx_rep": 4, "rmse": 0.6554024098455221, "rmse_stand": 0.08270468157155182}, {"method": "ERA", "var": "TA", "gap_len": 2.5, "idx_rep": 0, "rmse": 1.4494880475533438, "rmse_stand": 0.18290968359869958}, {"method": "ERA", "var": "TA", "gap_len": 2.5, "idx_rep": 1, "rmse": 2.161609585470975, "rmse_stand": 0.2727717044716518}, {"method": "ERA", "var": "TA", "gap_len": 2.5, "idx_rep": 2, "rmse": 3.079831748651215, "rmse_stand": 0.3886413907544082}, {"method": "ERA", "var": "TA", "gap_len": 2.5, "idx_rep": 3, "rmse": 0.2689706303669617, "rmse_stand": 0.03394117873604142}, {"method": "ERA", "var": "TA", "gap_len": 2.5, "idx_rep": 4, "rmse": 0.9925782588793692, "rmse_stand": 0.12525261976807855}, {"method": "MDS", "var": "TA", "gap_len": 2.5, "idx_rep": 0, "rmse": 3.836379180880156, "rmse_stand": 0.4841094780490788}, {"method": "MDS", "var": "TA", "gap_len": 2.5, "idx_rep": 1, "rmse": 1.4774830321552226, "rmse_stand": 0.1864423472757291}, {"method": "MDS", "var": "TA", "gap_len": 2.5, "idx_rep": 2, "rmse": 1.9375648552665787, "rmse_stand": 0.24449968747722806}, {"method": "MDS", "var": "TA", "gap_len": 2.5, "idx_rep": 3, "rmse": 5.648068036692516, "rmse_stand": 0.712724978504755}, {"method": "MDS", "var": "TA", "gap_len": 2.5, "idx_rep": 4, "rmse": 0.3964013964302305, "rmse_stand": 0.05002156045475621}, {"method": "KalmanFilter", "var": "TA", "gap_len": 5.0, "idx_rep": 0, "rmse": 0.2688583185422039, "rmse_stand": 0.033927006200872516}, {"method": "KalmanFilter", "var": "TA", "gap_len": 5.0, "idx_rep": 1, "rmse": 1.2202396323108624, "rmse_stand": 0.15398101794444732}, {"method": "KalmanFilter", "var": "TA", "gap_len": 5.0, "idx_rep": 2, "rmse": 0.5364031724956462, "rmse_stand": 0.06768826740456896}, {"method": "KalmanFilter", "var": "TA", "gap_len": 5.0, "idx_rep": 3, "rmse": 0.8466554501787661, "rmse_stand": 0.10683874266552962}, {"method": "KalmanFilter", "var": "TA", "gap_len": 5.0, "idx_rep": 4, "rmse": 0.22290406604227006, "rmse_stand": 0.02812807753846262}, {"method": "ERA", "var": "TA", "gap_len": 5.0, "idx_rep": 0, "rmse": 0.6161552564086423, "rmse_stand": 0.07775211612652692}, {"method": "ERA", "var": "TA", "gap_len": 5.0, "idx_rep": 1, "rmse": 2.699802622415201, "rmse_stand": 0.34068583337299324}, {"method": "ERA", "var": "TA", "gap_len": 5.0, "idx_rep": 2, "rmse": 2.47888904552019, "rmse_stand": 0.31280893399412035}, {"method": "ERA", "var": "TA", "gap_len": 5.0, "idx_rep": 3, "rmse": 1.092673418730409, "rmse_stand": 0.13788354421689927}, {"method": "ERA", "var": "TA", "gap_len": 5.0, "idx_rep": 4, "rmse": 0.4736103883995789, "rmse_stand": 0.05976449853273876}, {"method": "MDS", "var": "TA", "gap_len": 5.0, "idx_rep": 0, "rmse": 0.37018423676457685, "rmse_stand": 0.04671323901851145}, {"method": "MDS", "var": "TA", "gap_len": 5.0, "idx_rep": 1, "rmse": 2.5049789719717106, "rmse_stand": 0.31610119997755914}, {"method": "MDS", "var": "TA", "gap_len": 5.0, "idx_rep": 2, "rmse": 1.3607584787271558, "rmse_stand": 0.1717129735690849}, {"method": "MDS", "var": "TA", "gap_len": 5.0, "idx_rep": 3, "rmse": 3.518030450205353, "rmse_stand": 0.44393731816127335}, {"method": "MDS", "var": "TA", "gap_len": 5.0, "idx_rep": 4, "rmse": 0.3487218153797257, "rmse_stand": 0.0440049140265314}, {"method": "KalmanFilter", "var": "TA", "gap_len": 10.0, "idx_rep": 0, "rmse": 0.3093641609454863, "rmse_stand": 0.03903840455313145}, {"method": "KalmanFilter", "var": "TA", "gap_len": 10.0, "idx_rep": 1, "rmse": 1.128727890568843, "rmse_stand": 0.14243322784307175}, {"method": "KalmanFilter", "var": "TA", "gap_len": 10.0, "idx_rep": 2, "rmse": 0.23575566323259534, "rmse_stand": 0.029749809832004575}, {"method": "KalmanFilter", "var": "TA", "gap_len": 10.0, "idx_rep": 3, "rmse": 0.7054704330482424, "rmse_stand": 0.08902272351600249}, {"method": "KalmanFilter", "var": "TA", "gap_len": 10.0, "idx_rep": 4, "rmse": 0.6711296732361712, "rmse_stand": 0.08468929177617732}, {"method": "ERA", "var": "TA", "gap_len": 10.0, "idx_rep": 0, "rmse": 0.6373100109052111, "rmse_stand": 0.0804216168913707}, {"method": "ERA", "var": "TA", "gap_len": 10.0, "idx_rep": 1, "rmse": 3.3073337448766793, "rmse_stand": 0.417349677254536}, {"method": "ERA", "var": "TA", "gap_len": 10.0, "idx_rep": 2, "rmse": 0.5084344598864242, "rmse_stand": 0.06415891896830497}, {"method": "ERA", "var": "TA", "gap_len": 10.0, "idx_rep": 3, "rmse": 1.0420521100213753, "rmse_stand": 0.13149568363746894}, {"method": "ERA", "var": "TA", "gap_len": 10.0, "idx_rep": 4, "rmse": 1.3107373306654544, "rmse_stand": 0.16540084675944816}, {"method": "MDS", "var": "TA", "gap_len": 10.0, "idx_rep": 0, "rmse": 1.909987068089248, "rmse_stand": 0.24101966959403665}, {"method": "MDS", "var": "TA", "gap_len": 10.0, "idx_rep": 1, "rmse": 0.9628557873659838, "rmse_stand": 0.12150196596347405}, {"method": "MDS", "var": "TA", "gap_len": 10.0, "idx_rep": 2, "rmse": 1.2267196441453094, "rmse_stand": 0.15479872521451082}, {"method": "MDS", "var": "TA", "gap_len": 10.0, "idx_rep": 3, "rmse": 2.680745456962698, "rmse_stand": 0.33828102561408196}, {"method": "MDS", "var": "TA", "gap_len": 10.0, "idx_rep": 4, "rmse": 1.3269395749489976, "rmse_stand": 0.16744539440542153}, {"method": "KalmanFilter", "var": "TA", "gap_len": 22.5, "idx_rep": 0, "rmse": 0.5864129798979331, "rmse_stand": 0.07399896314588557}, {"method": "KalmanFilter", "var": "TA", "gap_len": 22.5, "idx_rep": 1, "rmse": 0.2843142695520981, "rmse_stand": 0.03587737972324039}, {"method": "KalmanFilter", "var": "TA", "gap_len": 22.5, "idx_rep": 2, "rmse": 0.7435215897867138, "rmse_stand": 0.09382436713862241}, {"method": "KalmanFilter", "var": "TA", "gap_len": 22.5, "idx_rep": 3, "rmse": 0.5667248001907798, "rmse_stand": 0.07151452822629564}, {"method": "KalmanFilter", "var": "TA", "gap_len": 22.5, "idx_rep": 4, "rmse": 0.3841439659959281, "rmse_stand": 0.048474805566879976}, {"method": "ERA", "var": "TA", "gap_len": 22.5, "idx_rep": 0, "rmse": 1.667383605799484, "rmse_stand": 0.21040574173014598}, {"method": "ERA", "var": "TA", "gap_len": 22.5, "idx_rep": 1, "rmse": 1.3032615922284283, "rmse_stand": 0.16445748958276005}, {"method": "ERA", "var": "TA", "gap_len": 22.5, "idx_rep": 2, "rmse": 2.108127357527423, "rmse_stand": 0.26602282688841067}, {"method": "ERA", "var": "TA", "gap_len": 22.5, "idx_rep": 3, "rmse": 0.9962245284628918, "rmse_stand": 0.12571273947514577}, {"method": "ERA", "var": "TA", "gap_len": 22.5, "idx_rep": 4, "rmse": 0.7051317607369562, "rmse_stand": 0.08897998674048677}, {"method": "MDS", "var": "TA", "gap_len": 22.5, "idx_rep": 0, "rmse": 2.285323794678169, "rmse_stand": 0.28838309699120157}, {"method": "MDS", "var": "TA", "gap_len": 22.5, "idx_rep": 1, "rmse": 2.0471406981319173, "rmse_stand": 0.25832697138094185}, {"method": "MDS", "var": "TA", "gap_len": 22.5, "idx_rep": 2, "rmse": 2.372916288158608, "rmse_stand": 0.29943632043459023}, {"method": "MDS", "var": "TA", "gap_len": 22.5, "idx_rep": 3, "rmse": 1.880445459034662, "rmse_stand": 0.2372918386717386}, {"method": "MDS", "var": "TA", "gap_len": 22.5, "idx_rep": 4, "rmse": 2.030413253818859, "rmse_stand": 0.2562161491828004}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 0, "rmse": 190.09913902131657, "rmse_stand": 0.9318468267638063}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 1, "rmse": 49.21839339415338, "rmse_stand": 0.24126360560534468}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 2, "rmse": 26.177013703672745, "rmse_stand": 0.12831708380954235}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 3, "rmse": 10.297807264588364, "rmse_stand": 0.05047881369444763}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 4, "rmse": 5.383079865402994, "rmse_stand": 0.026387315148383866}, {"method": "ERA", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 0, "rmse": 226.71763952943755, "rmse_stand": 1.1113470268963015}, {"method": "ERA", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 1, "rmse": 106.967430378597, "rmse_stand": 0.5243435666176098}, {"method": "ERA", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 2, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "ERA", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 3, "rmse": 20.03160425427779, "rmse_stand": 0.09819290584605954}, {"method": "ERA", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 4, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "MDS", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 0, "rmse": 203.68295492825962, "rmse_stand": 0.9984333237537226}, {"method": "MDS", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 1, "rmse": 56.693166616168064, "rmse_stand": 0.2779041908471979}, {"method": "MDS", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 2, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "MDS", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 3, "rmse": 7.710506345616034, "rmse_stand": 0.037796125263349085}, {"method": "MDS", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 4, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 0, "rmse": 47.70346067201218, "rmse_stand": 0.2338375580327166}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 1, "rmse": 29.676779166986936, "rmse_stand": 0.1454725815050958}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 2, "rmse": 32.89706145333922, "rmse_stand": 0.16125808082545082}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 3, "rmse": 51.410734516408716, "rmse_stand": 0.2520102409056148}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 4, "rmse": 21.583705190775863, "rmse_stand": 0.10580114826072233}, {"method": "ERA", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 0, "rmse": 0.3225523213371747, "rmse_stand": 0.0015811189816574696}, {"method": "ERA", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 1, "rmse": 59.8714043805555, "rmse_stand": 0.29348359215691777}, {"method": "ERA", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 2, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "ERA", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 3, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "ERA", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 4, "rmse": 13.338528093459189, "rmse_stand": 0.06538412084126305}, {"method": "MDS", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 0, "rmse": 5.924459982644022, "rmse_stand": 0.02904110593839633}, {"method": "MDS", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 1, "rmse": 39.57447171991995, "rmse_stand": 0.19399007319505107}, {"method": "MDS", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 2, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "MDS", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 3, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "MDS", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 4, "rmse": 17.4763607256079, "rmse_stand": 0.08566735951240262}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 0, "rmse": 113.96809836865074, "rmse_stand": 0.5586601357790674}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 1, "rmse": 114.14234927322714, "rmse_stand": 0.559514296157311}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 2, "rmse": 24.311262989267203, "rmse_stand": 0.11917136178417244}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 3, "rmse": 70.71423825946418, "rmse_stand": 0.34663407140267155}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 4, "rmse": 65.94746344490703, "rmse_stand": 0.32326782152005307}, {"method": "ERA", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 0, "rmse": 128.36896992575737, "rmse_stand": 0.6292517572467384}, {"method": "ERA", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 1, "rmse": 202.27108194697533, "rmse_stand": 0.9915124646473813}, {"method": "ERA", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 2, "rmse": 8.929423209256019, "rmse_stand": 0.04377113292156075}, {"method": "ERA", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 3, "rmse": 63.874882284823045, "rmse_stand": 0.31310823748838557}, {"method": "ERA", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 4, "rmse": 63.59749815519475, "rmse_stand": 0.31174852843173495}, {"method": "MDS", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 0, "rmse": 197.7548021609146, "rmse_stand": 0.9693741161567746}, {"method": "MDS", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 1, "rmse": 126.35930456701931, "rmse_stand": 0.6194005801344254}, {"method": "MDS", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 2, "rmse": 11.69406587379872, "rmse_stand": 0.057323132722049426}, {"method": "MDS", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 3, "rmse": 75.86027950442896, "rmse_stand": 0.37185944711559565}, {"method": "MDS", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 4, "rmse": 93.75999514125422, "rmse_stand": 0.4596020497492653}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 0, "rmse": 123.92483025030573, "rmse_stand": 0.6074670323101339}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 1, "rmse": 66.1532423186051, "rmse_stand": 0.32427652882645003}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 2, "rmse": 34.1542955804012, "rmse_stand": 0.16742091584844634}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 3, "rmse": 52.67158213966747, "rmse_stand": 0.2581907889229028}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 4, "rmse": 27.97643102886275, "rmse_stand": 0.13713764624414704}, {"method": "ERA", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 0, "rmse": 166.69426640676306, "rmse_stand": 0.8171184992765513}, {"method": "ERA", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 1, "rmse": 106.04031443936782, "rmse_stand": 0.5197989376915632}, {"method": "ERA", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 2, "rmse": 34.402950433873485, "rmse_stand": 0.1686397968878896}, {"method": "ERA", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 3, "rmse": 70.29130814877944, "rmse_stand": 0.3445609106108163}, {"method": "ERA", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 4, "rmse": 38.020916921259705, "rmse_stand": 0.1863747040945477}, {"method": "MDS", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 0, "rmse": 187.9939061991956, "rmse_stand": 0.921527187574528}, {"method": "MDS", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 1, "rmse": 106.93530013475957, "rmse_stand": 0.5241860673994798}, {"method": "MDS", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 2, "rmse": 29.948687926633866, "rmse_stand": 0.14680545084974791}, {"method": "MDS", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 3, "rmse": 170.95760776247306, "rmse_stand": 0.8380169690654323}, {"method": "MDS", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 4, "rmse": 73.08215120668197, "rmse_stand": 0.35824134209983344}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>the_plot_stand2(data_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div id="altair-viz-cfe161ef477f49168bfddeb04182ad45"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-cfe161ef477f49168bfddeb04182ad45") {
      outputDiv = document.getElementById("altair-viz-cfe161ef477f49168bfddeb04182ad45");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.2.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.2.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-4df2c5234880b2411871d564e0b16182"}, "facet": {"field": "var", "sort": ["TA", "SW_IN", "LW_IN", "VPD", "WS", "PA", "P", "SWC", "TS"], "type": "ordinal"}, "spec": {"mark": {"type": "boxplot", "extent": "min-max"}, "encoding": {"color": {"field": "method", "scale": {"domain": ["KalmanFilter", "ERA", "MDS"], "scheme": "dark2"}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0}, "field": "gap_len", "title": "gap_len [h]", "type": "nominal"}, "xOffset": {"field": "method", "scale": {"domain": ["KalmanFilter", "ERA", "MDS"]}, "sort": ["KalmanFilter", "ERA", "MDS"], "type": "ordinal"}, "y": {"axis": {"grid": true}, "field": "rmse_stand", "title": "RMSE Standardized", "type": "quantitative"}}, "height": 200, "width": 250}, "columns": 3, "$schema": "https://vega.github.io/schema/vega-lite/v5.2.0.json", "datasets": {"data-4df2c5234880b2411871d564e0b16182": [{"method": "KalmanFilter", "var": "TA", "gap_len": 2.5, "idx_rep": 0, "rmse": 0.45859917867745875, "rmse_stand": 0.05787024654125715}, {"method": "KalmanFilter", "var": "TA", "gap_len": 2.5, "idx_rep": 1, "rmse": 0.1565318544722203, "rmse_stand": 0.019752623709425807}, {"method": "KalmanFilter", "var": "TA", "gap_len": 2.5, "idx_rep": 2, "rmse": 0.17439920963505967, "rmse_stand": 0.022007290303673988}, {"method": "KalmanFilter", "var": "TA", "gap_len": 2.5, "idx_rep": 3, "rmse": 0.36132286304577765, "rmse_stand": 0.04559502968529807}, {"method": "KalmanFilter", "var": "TA", "gap_len": 2.5, "idx_rep": 4, "rmse": 0.6554024098455221, "rmse_stand": 0.08270468157155182}, {"method": "ERA", "var": "TA", "gap_len": 2.5, "idx_rep": 0, "rmse": 1.4494880475533438, "rmse_stand": 0.18290968359869958}, {"method": "ERA", "var": "TA", "gap_len": 2.5, "idx_rep": 1, "rmse": 2.161609585470975, "rmse_stand": 0.2727717044716518}, {"method": "ERA", "var": "TA", "gap_len": 2.5, "idx_rep": 2, "rmse": 3.079831748651215, "rmse_stand": 0.3886413907544082}, {"method": "ERA", "var": "TA", "gap_len": 2.5, "idx_rep": 3, "rmse": 0.2689706303669617, "rmse_stand": 0.03394117873604142}, {"method": "ERA", "var": "TA", "gap_len": 2.5, "idx_rep": 4, "rmse": 0.9925782588793692, "rmse_stand": 0.12525261976807855}, {"method": "MDS", "var": "TA", "gap_len": 2.5, "idx_rep": 0, "rmse": 3.836379180880156, "rmse_stand": 0.4841094780490788}, {"method": "MDS", "var": "TA", "gap_len": 2.5, "idx_rep": 1, "rmse": 1.4774830321552226, "rmse_stand": 0.1864423472757291}, {"method": "MDS", "var": "TA", "gap_len": 2.5, "idx_rep": 2, "rmse": 1.9375648552665787, "rmse_stand": 0.24449968747722806}, {"method": "MDS", "var": "TA", "gap_len": 2.5, "idx_rep": 3, "rmse": 5.648068036692516, "rmse_stand": 0.712724978504755}, {"method": "MDS", "var": "TA", "gap_len": 2.5, "idx_rep": 4, "rmse": 0.3964013964302305, "rmse_stand": 0.05002156045475621}, {"method": "KalmanFilter", "var": "TA", "gap_len": 5.0, "idx_rep": 0, "rmse": 0.2688583185422039, "rmse_stand": 0.033927006200872516}, {"method": "KalmanFilter", "var": "TA", "gap_len": 5.0, "idx_rep": 1, "rmse": 1.2202396323108624, "rmse_stand": 0.15398101794444732}, {"method": "KalmanFilter", "var": "TA", "gap_len": 5.0, "idx_rep": 2, "rmse": 0.5364031724956462, "rmse_stand": 0.06768826740456896}, {"method": "KalmanFilter", "var": "TA", "gap_len": 5.0, "idx_rep": 3, "rmse": 0.8466554501787661, "rmse_stand": 0.10683874266552962}, {"method": "KalmanFilter", "var": "TA", "gap_len": 5.0, "idx_rep": 4, "rmse": 0.22290406604227006, "rmse_stand": 0.02812807753846262}, {"method": "ERA", "var": "TA", "gap_len": 5.0, "idx_rep": 0, "rmse": 0.6161552564086423, "rmse_stand": 0.07775211612652692}, {"method": "ERA", "var": "TA", "gap_len": 5.0, "idx_rep": 1, "rmse": 2.699802622415201, "rmse_stand": 0.34068583337299324}, {"method": "ERA", "var": "TA", "gap_len": 5.0, "idx_rep": 2, "rmse": 2.47888904552019, "rmse_stand": 0.31280893399412035}, {"method": "ERA", "var": "TA", "gap_len": 5.0, "idx_rep": 3, "rmse": 1.092673418730409, "rmse_stand": 0.13788354421689927}, {"method": "ERA", "var": "TA", "gap_len": 5.0, "idx_rep": 4, "rmse": 0.4736103883995789, "rmse_stand": 0.05976449853273876}, {"method": "MDS", "var": "TA", "gap_len": 5.0, "idx_rep": 0, "rmse": 0.37018423676457685, "rmse_stand": 0.04671323901851145}, {"method": "MDS", "var": "TA", "gap_len": 5.0, "idx_rep": 1, "rmse": 2.5049789719717106, "rmse_stand": 0.31610119997755914}, {"method": "MDS", "var": "TA", "gap_len": 5.0, "idx_rep": 2, "rmse": 1.3607584787271558, "rmse_stand": 0.1717129735690849}, {"method": "MDS", "var": "TA", "gap_len": 5.0, "idx_rep": 3, "rmse": 3.518030450205353, "rmse_stand": 0.44393731816127335}, {"method": "MDS", "var": "TA", "gap_len": 5.0, "idx_rep": 4, "rmse": 0.3487218153797257, "rmse_stand": 0.0440049140265314}, {"method": "KalmanFilter", "var": "TA", "gap_len": 10.0, "idx_rep": 0, "rmse": 0.3093641609454863, "rmse_stand": 0.03903840455313145}, {"method": "KalmanFilter", "var": "TA", "gap_len": 10.0, "idx_rep": 1, "rmse": 1.128727890568843, "rmse_stand": 0.14243322784307175}, {"method": "KalmanFilter", "var": "TA", "gap_len": 10.0, "idx_rep": 2, "rmse": 0.23575566323259534, "rmse_stand": 0.029749809832004575}, {"method": "KalmanFilter", "var": "TA", "gap_len": 10.0, "idx_rep": 3, "rmse": 0.7054704330482424, "rmse_stand": 0.08902272351600249}, {"method": "KalmanFilter", "var": "TA", "gap_len": 10.0, "idx_rep": 4, "rmse": 0.6711296732361712, "rmse_stand": 0.08468929177617732}, {"method": "ERA", "var": "TA", "gap_len": 10.0, "idx_rep": 0, "rmse": 0.6373100109052111, "rmse_stand": 0.0804216168913707}, {"method": "ERA", "var": "TA", "gap_len": 10.0, "idx_rep": 1, "rmse": 3.3073337448766793, "rmse_stand": 0.417349677254536}, {"method": "ERA", "var": "TA", "gap_len": 10.0, "idx_rep": 2, "rmse": 0.5084344598864242, "rmse_stand": 0.06415891896830497}, {"method": "ERA", "var": "TA", "gap_len": 10.0, "idx_rep": 3, "rmse": 1.0420521100213753, "rmse_stand": 0.13149568363746894}, {"method": "ERA", "var": "TA", "gap_len": 10.0, "idx_rep": 4, "rmse": 1.3107373306654544, "rmse_stand": 0.16540084675944816}, {"method": "MDS", "var": "TA", "gap_len": 10.0, "idx_rep": 0, "rmse": 1.909987068089248, "rmse_stand": 0.24101966959403665}, {"method": "MDS", "var": "TA", "gap_len": 10.0, "idx_rep": 1, "rmse": 0.9628557873659838, "rmse_stand": 0.12150196596347405}, {"method": "MDS", "var": "TA", "gap_len": 10.0, "idx_rep": 2, "rmse": 1.2267196441453094, "rmse_stand": 0.15479872521451082}, {"method": "MDS", "var": "TA", "gap_len": 10.0, "idx_rep": 3, "rmse": 2.680745456962698, "rmse_stand": 0.33828102561408196}, {"method": "MDS", "var": "TA", "gap_len": 10.0, "idx_rep": 4, "rmse": 1.3269395749489976, "rmse_stand": 0.16744539440542153}, {"method": "KalmanFilter", "var": "TA", "gap_len": 22.5, "idx_rep": 0, "rmse": 0.5864129798979331, "rmse_stand": 0.07399896314588557}, {"method": "KalmanFilter", "var": "TA", "gap_len": 22.5, "idx_rep": 1, "rmse": 0.2843142695520981, "rmse_stand": 0.03587737972324039}, {"method": "KalmanFilter", "var": "TA", "gap_len": 22.5, "idx_rep": 2, "rmse": 0.7435215897867138, "rmse_stand": 0.09382436713862241}, {"method": "KalmanFilter", "var": "TA", "gap_len": 22.5, "idx_rep": 3, "rmse": 0.5667248001907798, "rmse_stand": 0.07151452822629564}, {"method": "KalmanFilter", "var": "TA", "gap_len": 22.5, "idx_rep": 4, "rmse": 0.3841439659959281, "rmse_stand": 0.048474805566879976}, {"method": "ERA", "var": "TA", "gap_len": 22.5, "idx_rep": 0, "rmse": 1.667383605799484, "rmse_stand": 0.21040574173014598}, {"method": "ERA", "var": "TA", "gap_len": 22.5, "idx_rep": 1, "rmse": 1.3032615922284283, "rmse_stand": 0.16445748958276005}, {"method": "ERA", "var": "TA", "gap_len": 22.5, "idx_rep": 2, "rmse": 2.108127357527423, "rmse_stand": 0.26602282688841067}, {"method": "ERA", "var": "TA", "gap_len": 22.5, "idx_rep": 3, "rmse": 0.9962245284628918, "rmse_stand": 0.12571273947514577}, {"method": "ERA", "var": "TA", "gap_len": 22.5, "idx_rep": 4, "rmse": 0.7051317607369562, "rmse_stand": 0.08897998674048677}, {"method": "MDS", "var": "TA", "gap_len": 22.5, "idx_rep": 0, "rmse": 2.285323794678169, "rmse_stand": 0.28838309699120157}, {"method": "MDS", "var": "TA", "gap_len": 22.5, "idx_rep": 1, "rmse": 2.0471406981319173, "rmse_stand": 0.25832697138094185}, {"method": "MDS", "var": "TA", "gap_len": 22.5, "idx_rep": 2, "rmse": 2.372916288158608, "rmse_stand": 0.29943632043459023}, {"method": "MDS", "var": "TA", "gap_len": 22.5, "idx_rep": 3, "rmse": 1.880445459034662, "rmse_stand": 0.2372918386717386}, {"method": "MDS", "var": "TA", "gap_len": 22.5, "idx_rep": 4, "rmse": 2.030413253818859, "rmse_stand": 0.2562161491828004}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 0, "rmse": 190.09913902131657, "rmse_stand": 0.9318468267638063}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 1, "rmse": 49.21839339415338, "rmse_stand": 0.24126360560534468}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 2, "rmse": 26.177013703672745, "rmse_stand": 0.12831708380954235}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 3, "rmse": 10.297807264588364, "rmse_stand": 0.05047881369444763}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 4, "rmse": 5.383079865402994, "rmse_stand": 0.026387315148383866}, {"method": "ERA", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 0, "rmse": 226.71763952943755, "rmse_stand": 1.1113470268963015}, {"method": "ERA", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 1, "rmse": 106.967430378597, "rmse_stand": 0.5243435666176098}, {"method": "ERA", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 2, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "ERA", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 3, "rmse": 20.03160425427779, "rmse_stand": 0.09819290584605954}, {"method": "ERA", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 4, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "MDS", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 0, "rmse": 203.68295492825962, "rmse_stand": 0.9984333237537226}, {"method": "MDS", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 1, "rmse": 56.693166616168064, "rmse_stand": 0.2779041908471979}, {"method": "MDS", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 2, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "MDS", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 3, "rmse": 7.710506345616034, "rmse_stand": 0.037796125263349085}, {"method": "MDS", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 4, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 0, "rmse": 47.70346067201218, "rmse_stand": 0.2338375580327166}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 1, "rmse": 29.676779166986936, "rmse_stand": 0.1454725815050958}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 2, "rmse": 32.89706145333922, "rmse_stand": 0.16125808082545082}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 3, "rmse": 51.410734516408716, "rmse_stand": 0.2520102409056148}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 4, "rmse": 21.583705190775863, "rmse_stand": 0.10580114826072233}, {"method": "ERA", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 0, "rmse": 0.3225523213371747, "rmse_stand": 0.0015811189816574696}, {"method": "ERA", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 1, "rmse": 59.8714043805555, "rmse_stand": 0.29348359215691777}, {"method": "ERA", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 2, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "ERA", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 3, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "ERA", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 4, "rmse": 13.338528093459189, "rmse_stand": 0.06538412084126305}, {"method": "MDS", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 0, "rmse": 5.924459982644022, "rmse_stand": 0.02904110593839633}, {"method": "MDS", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 1, "rmse": 39.57447171991995, "rmse_stand": 0.19399007319505107}, {"method": "MDS", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 2, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "MDS", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 3, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "MDS", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 4, "rmse": 17.4763607256079, "rmse_stand": 0.08566735951240262}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 0, "rmse": 113.96809836865074, "rmse_stand": 0.5586601357790674}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 1, "rmse": 114.14234927322714, "rmse_stand": 0.559514296157311}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 2, "rmse": 24.311262989267203, "rmse_stand": 0.11917136178417244}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 3, "rmse": 70.71423825946418, "rmse_stand": 0.34663407140267155}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 4, "rmse": 65.94746344490703, "rmse_stand": 0.32326782152005307}, {"method": "ERA", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 0, "rmse": 128.36896992575737, "rmse_stand": 0.6292517572467384}, {"method": "ERA", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 1, "rmse": 202.27108194697533, "rmse_stand": 0.9915124646473813}, {"method": "ERA", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 2, "rmse": 8.929423209256019, "rmse_stand": 0.04377113292156075}, {"method": "ERA", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 3, "rmse": 63.874882284823045, "rmse_stand": 0.31310823748838557}, {"method": "ERA", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 4, "rmse": 63.59749815519475, "rmse_stand": 0.31174852843173495}, {"method": "MDS", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 0, "rmse": 197.7548021609146, "rmse_stand": 0.9693741161567746}, {"method": "MDS", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 1, "rmse": 126.35930456701931, "rmse_stand": 0.6194005801344254}, {"method": "MDS", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 2, "rmse": 11.69406587379872, "rmse_stand": 0.057323132722049426}, {"method": "MDS", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 3, "rmse": 75.86027950442896, "rmse_stand": 0.37185944711559565}, {"method": "MDS", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 4, "rmse": 93.75999514125422, "rmse_stand": 0.4596020497492653}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 0, "rmse": 123.92483025030573, "rmse_stand": 0.6074670323101339}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 1, "rmse": 66.1532423186051, "rmse_stand": 0.32427652882645003}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 2, "rmse": 34.1542955804012, "rmse_stand": 0.16742091584844634}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 3, "rmse": 52.67158213966747, "rmse_stand": 0.2581907889229028}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 4, "rmse": 27.97643102886275, "rmse_stand": 0.13713764624414704}, {"method": "ERA", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 0, "rmse": 166.69426640676306, "rmse_stand": 0.8171184992765513}, {"method": "ERA", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 1, "rmse": 106.04031443936782, "rmse_stand": 0.5197989376915632}, {"method": "ERA", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 2, "rmse": 34.402950433873485, "rmse_stand": 0.1686397968878896}, {"method": "ERA", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 3, "rmse": 70.29130814877944, "rmse_stand": 0.3445609106108163}, {"method": "ERA", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 4, "rmse": 38.020916921259705, "rmse_stand": 0.1863747040945477}, {"method": "MDS", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 0, "rmse": 187.9939061991956, "rmse_stand": 0.921527187574528}, {"method": "MDS", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 1, "rmse": 106.93530013475957, "rmse_stand": 0.5241860673994798}, {"method": "MDS", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 2, "rmse": 29.948687926633866, "rmse_stand": 0.14680545084974791}, {"method": "MDS", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 3, "rmse": 170.95760776247306, "rmse_stand": 0.8380169690654323}, {"method": "MDS", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 4, "rmse": 73.08215120668197, "rmse_stand": 0.35824134209983344}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>alt.Color(<span class="st">'color'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Color({
  shorthand: 'color'
})</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> alt.X(<span class="st">'gap_len'</span>)<span class="op">;</span> color <span class="op">=</span> alt.Color(<span class="st">'method'</span>)<span class="op">;</span> xOffset <span class="op">=</span> alt.XOffset(<span class="st">'method'</span>)<span class="op">;</span> y <span class="op">=</span> alt.Y(<span class="st">'rmse_stand'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>data_results.groupby([x.shorthand, color.shorthand, xOffset.shorthand]).agg({y.shorthand: [<span class="st">'median'</span>, <span class="kw">lambda</span> x: x.quantile(<span class="fl">.25</span>), <span class="kw">lambda</span> x: x.quantile(<span class="fl">.75</span>)]}).columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>MultiIndex([('rmse_stand',     'median'),
            ('rmse_stand', '&lt;lambda_0&gt;'),
            ('rmse_stand', '&lt;lambda_1&gt;')],
           )</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>data_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">method</th>
<th data-quarto-table-cell-role="th">var</th>
<th data-quarto-table-cell-role="th">gap_len</th>
<th data-quarto-table-cell-role="th">idx_rep</th>
<th data-quarto-table-cell-role="th">rmse</th>
<th data-quarto-table-cell-role="th">rmse_stand</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>KalmanFilter</td>
<td>TA</td>
<td>2.5</td>
<td>0</td>
<td>0.458599</td>
<td>0.057870</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>KalmanFilter</td>
<td>TA</td>
<td>2.5</td>
<td>1</td>
<td>0.156532</td>
<td>0.019753</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>KalmanFilter</td>
<td>TA</td>
<td>2.5</td>
<td>2</td>
<td>0.174399</td>
<td>0.022007</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>KalmanFilter</td>
<td>TA</td>
<td>2.5</td>
<td>3</td>
<td>0.361323</td>
<td>0.045595</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>KalmanFilter</td>
<td>TA</td>
<td>2.5</td>
<td>4</td>
<td>0.655402</td>
<td>0.082705</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MDS</td>
<td>SW_IN</td>
<td>22.5</td>
<td>0</td>
<td>187.993906</td>
<td>0.921527</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MDS</td>
<td>SW_IN</td>
<td>22.5</td>
<td>1</td>
<td>106.935300</td>
<td>0.524186</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MDS</td>
<td>SW_IN</td>
<td>22.5</td>
<td>2</td>
<td>29.948688</td>
<td>0.146805</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MDS</td>
<td>SW_IN</td>
<td>22.5</td>
<td>3</td>
<td>170.957608</td>
<td>0.838017</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>MDS</td>
<td>SW_IN</td>
<td>22.5</td>
<td>4</td>
<td>73.082151</td>
<td>0.358241</td>
</tr>
</tbody>
</table>

<p>120 rows  6 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>data_results.groupby([<span class="st">'gap_len'</span>, <span class="st">'method'</span>, <span class="st">'var'</span>]).agg(</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>        median <span class="op">=</span> pd.NamedAgg(y.shorthand, <span class="st">'median'</span>),</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>        q1 <span class="op">=</span> pd.NamedAgg(y.shorthand,<span class="kw">lambda</span> x: x.quantile(<span class="fl">.25</span>)),</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>        q3 <span class="op">=</span> pd.NamedAgg(y.shorthand,<span class="kw">lambda</span> x: x.quantile(<span class="fl">.75</span>))).reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">gap_len</th>
<th data-quarto-table-cell-role="th">method</th>
<th data-quarto-table-cell-role="th">var</th>
<th data-quarto-table-cell-role="th">median</th>
<th data-quarto-table-cell-role="th">q1</th>
<th data-quarto-table-cell-role="th">q3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2.5</td>
<td>KalmanFilter</td>
<td>TA</td>
<td>0.045595</td>
<td>0.022007</td>
<td>0.057870</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2.5</td>
<td>KalmanFilter</td>
<td>SW_IN</td>
<td>0.128317</td>
<td>0.050479</td>
<td>0.241264</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2.5</td>
<td>KalmanFilter</td>
<td>LW_IN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2.5</td>
<td>KalmanFilter</td>
<td>VPD</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2.5</td>
<td>KalmanFilter</td>
<td>WS</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">103</td>
<td>22.5</td>
<td>MDS</td>
<td>WS</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">104</td>
<td>22.5</td>
<td>MDS</td>
<td>PA</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">105</td>
<td>22.5</td>
<td>MDS</td>
<td>P</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">106</td>
<td>22.5</td>
<td>MDS</td>
<td>SWC</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">107</td>
<td>22.5</td>
<td>MDS</td>
<td>TS</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>108 rows  6 columns</p>
</div>
</div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L523" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="custom_boxplot_nooutlier" class="level3">
<h3 class="anchored" data-anchor-id="custom_boxplot_nooutlier">custom_boxplot_nooutlier</h3>
<blockquote class="blockquote">
<pre><code> custom_boxplot_nooutlier (data:pandas.core.frame.DataFrame,
                           x:altair.vegalite.v5.schema.channels.X,
                           y:altair.vegalite.v5.schema.channels.Y,
                           color:altair.vegalite.v5.schema.channels.Color,
                           xOffset:altair.vegalite.v5.schema.channels.XOff
                           set)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L534" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="the_plot_stand3" class="level3">
<h3 class="anchored" data-anchor-id="the_plot_stand3">the_plot_stand3</h3>
<blockquote class="blockquote">
<pre><code> the_plot_stand3 (data)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>the_plot_stand3(data_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div id="altair-viz-daa959db8620457d81c513f4ad285bef"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-daa959db8620457d81c513f4ad285bef") {
      outputDiv = document.getElementById("altair-viz-daa959db8620457d81c513f4ad285bef");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.2.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.2.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "layer": [{"mark": {"type": "bar", "size": 14}, "encoding": {"color": {"field": "method", "scale": {"domain": ["KalmanFilter", "ERA", "MDS"], "scheme": "dark2"}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0}, "field": "var", "scale": {"domain": ["TA", "SW_IN", "LW_IN", "VPD", "WS", "PA", "P"]}, "title": "variable", "type": "nominal"}, "xOffset": {"field": "method", "sort": ["KalmanFilter", "ERA", "MDS"], "type": "ordinal"}, "y": {"field": "q1", "title": "RMSE Standaridized", "type": "quantitative"}, "y2": {"field": "q3", "title": "RMSE Standaridized"}}}, {"mark": {"type": "tick", "color": "white", "size": 14}, "encoding": {"x": {"axis": {"labelAngle": 0}, "field": "var", "scale": {"domain": ["TA", "SW_IN", "LW_IN", "VPD", "WS", "PA", "P"]}, "title": "variable", "type": "nominal"}, "xOffset": {"field": "method", "sort": ["KalmanFilter", "ERA", "MDS"], "type": "ordinal"}, "y": {"field": "median", "type": "quantitative"}}}], "data": {"name": "data-e66e52270383a9b9a60ebff9cfe754d8"}, "width": 600, "$schema": "https://vega.github.io/schema/vega-lite/v5.2.0.json", "datasets": {"data-e66e52270383a9b9a60ebff9cfe754d8": [{"var": "TA", "method": "KalmanFilter", "median": 0.06277925697291306, "q1": 0.03538978634264842, "q3": 0.0857726497111336}, {"var": "TA", "method": "ERA", "median": 0.15117051689982966, "q1": 0.08684039427820775, "q3": 0.26771004628422096}, {"var": "TA", "method": "MDS", "median": 0.24275967853563235, "q1": 0.16428372710769384, "q3": 0.30360254032033246}, {"var": "SW_IN", "method": "KalmanFilter", "median": 0.23755058181903066, "q1": 0.13493250563549586, "q3": 0.3298659144705054}, {"var": "SW_IN", "method": "ERA", "median": 0.23992914812573274, "q1": 0.033223629436584926, "q3": 0.5209350949230749}, {"var": "SW_IN", "method": "MDS", "median": 0.2359471320211245, "q1": 0.035607370432110895, "q3": 0.5479896955832162}, {"var": "LW_IN", "method": "KalmanFilter", "median": null, "q1": null, "q3": null}, {"var": "LW_IN", "method": "ERA", "median": null, "q1": null, "q3": null}, {"var": "LW_IN", "method": "MDS", "median": null, "q1": null, "q3": null}, {"var": "VPD", "method": "KalmanFilter", "median": null, "q1": null, "q3": null}, {"var": "VPD", "method": "ERA", "median": null, "q1": null, "q3": null}, {"var": "VPD", "method": "MDS", "median": null, "q1": null, "q3": null}, {"var": "WS", "method": "KalmanFilter", "median": null, "q1": null, "q3": null}, {"var": "WS", "method": "ERA", "median": null, "q1": null, "q3": null}, {"var": "WS", "method": "MDS", "median": null, "q1": null, "q3": null}, {"var": "PA", "method": "KalmanFilter", "median": null, "q1": null, "q3": null}, {"var": "PA", "method": "ERA", "median": null, "q1": null, "q3": null}, {"var": "PA", "method": "MDS", "median": null, "q1": null, "q3": null}, {"var": "P", "method": "KalmanFilter", "median": null, "q1": null, "q3": null}, {"var": "P", "method": "ERA", "median": null, "q1": null, "q3": null}, {"var": "P", "method": "MDS", "median": null, "q1": null, "q3": null}, {"var": "SWC", "method": "KalmanFilter", "median": null, "q1": null, "q3": null}, {"var": "SWC", "method": "ERA", "median": null, "q1": null, "q3": null}, {"var": "SWC", "method": "MDS", "median": null, "q1": null, "q3": null}, {"var": "TS", "method": "KalmanFilter", "median": null, "q1": null, "q3": null}, {"var": "TS", "method": "ERA", "median": null, "q1": null, "q3": null}, {"var": "TS", "method": "MDS", "median": null, "q1": null, "q3": null}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<p>violin plots dont work</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _the_plot_violin(data, y_label):</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> alt.Chart(data).mark_area(orient<span class="op">=</span><span class="st">'horizontal'</span>).encode(</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> alt.X(<span class="st">'density:Q'</span>, title<span class="op">=</span><span class="st">'gap_len [h]'</span>, axis<span class="op">=</span>alt.Axis(labelAngle<span class="op">=</span><span class="dv">0</span>)),</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> alt.Y(<span class="st">'rmse'</span>, title<span class="op">=</span>y_label, scale<span class="op">=</span>alt.Scale(domainMin<span class="op">=-</span><span class="fl">.2</span> <span class="op">*</span>data[<span class="st">'rmse'</span>].mean())),</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>alt.Color(<span class="st">'method:N'</span>, scale<span class="op">=</span>alt.Scale(domain<span class="op">=</span>[<span class="st">"KalmanFilter"</span>, <span class="st">"ERA"</span>, <span class="st">"MDS"</span>], scheme<span class="op">=</span><span class="st">'dark2'</span>)),</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>        xOffset<span class="op">=</span>alt.XOffset(<span class="st">'method'</span>, scale<span class="op">=</span>alt.Scale(domain<span class="op">=</span>[<span class="st">"KalmanFilter"</span>, <span class="st">"ERA"</span>, <span class="st">"MDS"</span>])),</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>        column<span class="op">=</span>alt.Column(<span class="st">'gap_len'</span>)</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>    ).transform_density(</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'rmse'</span>,</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>    as_<span class="op">=</span>[<span class="st">'rmse'</span>, <span class="st">'density'</span>],</span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>    groupby<span class="op">=</span>[<span class="st">'method'</span>, <span class="st">'gap_len'</span>]</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>).properties(width<span class="op">=</span><span class="dv">250</span>, height<span class="op">=</span><span class="dv">200</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>facet_wrap(data_results, _the_plot_violin, <span class="st">"var"</span>, y_labels <span class="op">=</span> [<span class="ss">f"RMSE </span><span class="sc">{</span>var<span class="sc">}</span><span class="ss"> [</span><span class="sc">{</span>units_big[var]<span class="sc">}</span><span class="ss">]"</span> <span class="cf">for</span> var <span class="kw">in</span> data_results[<span class="st">'var'</span>].unique()])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div id="altair-viz-66c7f28b8395407da72b44aec2e2ff27"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-66c7f28b8395407da72b44aec2e2ff27") {
      outputDiv = document.getElementById("altair-viz-66c7f28b8395407da72b44aec2e2ff27");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.2.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.2.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "vconcat": [{"hconcat": [{"mark": {"type": "area", "orient": "horizontal"}, "encoding": {"color": {"field": "method", "scale": {"domain": ["KalmanFilter", "ERA", "MDS"], "scheme": "dark2"}, "type": "nominal"}, "column": {"field": "gap_len", "type": "nominal"}, "x": {"axis": {"labelAngle": 0}, "field": "density", "title": "gap_len [h]", "type": "quantitative"}, "xOffset": {"field": "method", "scale": {"domain": ["KalmanFilter", "ERA", "MDS"]}, "sort": ["KalmanFilter", "ERA", "MDS"], "type": "ordinal"}, "y": {"field": "rmse", "scale": {"domainMin": -0.26512848188338156}, "title": "RMSE TA [\u00b0C]", "type": "quantitative"}}, "height": 200, "title": "TA", "transform": [{"density": "rmse", "groupby": ["method", "gap_len"], "as": ["rmse", "density"]}], "width": 250}, {"data": {"name": "data-90166fd4a71f41e3483e1d308ae1df3f"}, "mark": {"type": "area", "orient": "horizontal"}, "encoding": {"color": {"field": "method", "scale": {"domain": ["KalmanFilter", "ERA", "MDS"], "scheme": "dark2"}, "type": "nominal"}, "column": {"field": "gap_len", "type": "nominal"}, "x": {"axis": {"labelAngle": 0}, "field": "density", "title": "gap_len [h]", "type": "quantitative"}, "xOffset": {"field": "method", "scale": {"domain": ["KalmanFilter", "ERA", "MDS"]}, "sort": ["KalmanFilter", "ERA", "MDS"], "type": "ordinal"}, "y": {"field": "rmse", "scale": {"domainMin": -12.911865865090348}, "title": "RMSE SW_IN [W m-2]", "type": "quantitative"}}, "height": 200, "title": "SW_IN", "transform": [{"density": "rmse", "groupby": ["method", "gap_len"], "as": ["rmse", "density"]}], "width": 250}]}], "data": {"name": "data-57b235acc3e0da4b249c35ef8dd6de1f"}, "resolve": {"scale": {"xOffset": "independent"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.2.0.json", "datasets": {"data-57b235acc3e0da4b249c35ef8dd6de1f": [{"method": "KalmanFilter", "var": "TA", "gap_len": 2.5, "idx_rep": 0, "rmse": 0.45859917867745875, "rmse_stand": 0.05787024654125715}, {"method": "KalmanFilter", "var": "TA", "gap_len": 2.5, "idx_rep": 1, "rmse": 0.1565318544722203, "rmse_stand": 0.019752623709425807}, {"method": "KalmanFilter", "var": "TA", "gap_len": 2.5, "idx_rep": 2, "rmse": 0.17439920963505967, "rmse_stand": 0.022007290303673988}, {"method": "KalmanFilter", "var": "TA", "gap_len": 2.5, "idx_rep": 3, "rmse": 0.36132286304577765, "rmse_stand": 0.04559502968529807}, {"method": "KalmanFilter", "var": "TA", "gap_len": 2.5, "idx_rep": 4, "rmse": 0.6554024098455221, "rmse_stand": 0.08270468157155182}, {"method": "ERA", "var": "TA", "gap_len": 2.5, "idx_rep": 0, "rmse": 1.4494880475533438, "rmse_stand": 0.18290968359869958}, {"method": "ERA", "var": "TA", "gap_len": 2.5, "idx_rep": 1, "rmse": 2.161609585470975, "rmse_stand": 0.2727717044716518}, {"method": "ERA", "var": "TA", "gap_len": 2.5, "idx_rep": 2, "rmse": 3.079831748651215, "rmse_stand": 0.3886413907544082}, {"method": "ERA", "var": "TA", "gap_len": 2.5, "idx_rep": 3, "rmse": 0.2689706303669617, "rmse_stand": 0.03394117873604142}, {"method": "ERA", "var": "TA", "gap_len": 2.5, "idx_rep": 4, "rmse": 0.9925782588793692, "rmse_stand": 0.12525261976807855}, {"method": "MDS", "var": "TA", "gap_len": 2.5, "idx_rep": 0, "rmse": 3.836379180880156, "rmse_stand": 0.4841094780490788}, {"method": "MDS", "var": "TA", "gap_len": 2.5, "idx_rep": 1, "rmse": 1.4774830321552226, "rmse_stand": 0.1864423472757291}, {"method": "MDS", "var": "TA", "gap_len": 2.5, "idx_rep": 2, "rmse": 1.9375648552665787, "rmse_stand": 0.24449968747722806}, {"method": "MDS", "var": "TA", "gap_len": 2.5, "idx_rep": 3, "rmse": 5.648068036692516, "rmse_stand": 0.712724978504755}, {"method": "MDS", "var": "TA", "gap_len": 2.5, "idx_rep": 4, "rmse": 0.3964013964302305, "rmse_stand": 0.05002156045475621}, {"method": "KalmanFilter", "var": "TA", "gap_len": 5.0, "idx_rep": 0, "rmse": 0.2688583185422039, "rmse_stand": 0.033927006200872516}, {"method": "KalmanFilter", "var": "TA", "gap_len": 5.0, "idx_rep": 1, "rmse": 1.2202396323108624, "rmse_stand": 0.15398101794444732}, {"method": "KalmanFilter", "var": "TA", "gap_len": 5.0, "idx_rep": 2, "rmse": 0.5364031724956462, "rmse_stand": 0.06768826740456896}, {"method": "KalmanFilter", "var": "TA", "gap_len": 5.0, "idx_rep": 3, "rmse": 0.8466554501787661, "rmse_stand": 0.10683874266552962}, {"method": "KalmanFilter", "var": "TA", "gap_len": 5.0, "idx_rep": 4, "rmse": 0.22290406604227006, "rmse_stand": 0.02812807753846262}, {"method": "ERA", "var": "TA", "gap_len": 5.0, "idx_rep": 0, "rmse": 0.6161552564086423, "rmse_stand": 0.07775211612652692}, {"method": "ERA", "var": "TA", "gap_len": 5.0, "idx_rep": 1, "rmse": 2.699802622415201, "rmse_stand": 0.34068583337299324}, {"method": "ERA", "var": "TA", "gap_len": 5.0, "idx_rep": 2, "rmse": 2.47888904552019, "rmse_stand": 0.31280893399412035}, {"method": "ERA", "var": "TA", "gap_len": 5.0, "idx_rep": 3, "rmse": 1.092673418730409, "rmse_stand": 0.13788354421689927}, {"method": "ERA", "var": "TA", "gap_len": 5.0, "idx_rep": 4, "rmse": 0.4736103883995789, "rmse_stand": 0.05976449853273876}, {"method": "MDS", "var": "TA", "gap_len": 5.0, "idx_rep": 0, "rmse": 0.37018423676457685, "rmse_stand": 0.04671323901851145}, {"method": "MDS", "var": "TA", "gap_len": 5.0, "idx_rep": 1, "rmse": 2.5049789719717106, "rmse_stand": 0.31610119997755914}, {"method": "MDS", "var": "TA", "gap_len": 5.0, "idx_rep": 2, "rmse": 1.3607584787271558, "rmse_stand": 0.1717129735690849}, {"method": "MDS", "var": "TA", "gap_len": 5.0, "idx_rep": 3, "rmse": 3.518030450205353, "rmse_stand": 0.44393731816127335}, {"method": "MDS", "var": "TA", "gap_len": 5.0, "idx_rep": 4, "rmse": 0.3487218153797257, "rmse_stand": 0.0440049140265314}, {"method": "KalmanFilter", "var": "TA", "gap_len": 10.0, "idx_rep": 0, "rmse": 0.3093641609454863, "rmse_stand": 0.03903840455313145}, {"method": "KalmanFilter", "var": "TA", "gap_len": 10.0, "idx_rep": 1, "rmse": 1.128727890568843, "rmse_stand": 0.14243322784307175}, {"method": "KalmanFilter", "var": "TA", "gap_len": 10.0, "idx_rep": 2, "rmse": 0.23575566323259534, "rmse_stand": 0.029749809832004575}, {"method": "KalmanFilter", "var": "TA", "gap_len": 10.0, "idx_rep": 3, "rmse": 0.7054704330482424, "rmse_stand": 0.08902272351600249}, {"method": "KalmanFilter", "var": "TA", "gap_len": 10.0, "idx_rep": 4, "rmse": 0.6711296732361712, "rmse_stand": 0.08468929177617732}, {"method": "ERA", "var": "TA", "gap_len": 10.0, "idx_rep": 0, "rmse": 0.6373100109052111, "rmse_stand": 0.0804216168913707}, {"method": "ERA", "var": "TA", "gap_len": 10.0, "idx_rep": 1, "rmse": 3.3073337448766793, "rmse_stand": 0.417349677254536}, {"method": "ERA", "var": "TA", "gap_len": 10.0, "idx_rep": 2, "rmse": 0.5084344598864242, "rmse_stand": 0.06415891896830497}, {"method": "ERA", "var": "TA", "gap_len": 10.0, "idx_rep": 3, "rmse": 1.0420521100213753, "rmse_stand": 0.13149568363746894}, {"method": "ERA", "var": "TA", "gap_len": 10.0, "idx_rep": 4, "rmse": 1.3107373306654544, "rmse_stand": 0.16540084675944816}, {"method": "MDS", "var": "TA", "gap_len": 10.0, "idx_rep": 0, "rmse": 1.909987068089248, "rmse_stand": 0.24101966959403665}, {"method": "MDS", "var": "TA", "gap_len": 10.0, "idx_rep": 1, "rmse": 0.9628557873659838, "rmse_stand": 0.12150196596347405}, {"method": "MDS", "var": "TA", "gap_len": 10.0, "idx_rep": 2, "rmse": 1.2267196441453094, "rmse_stand": 0.15479872521451082}, {"method": "MDS", "var": "TA", "gap_len": 10.0, "idx_rep": 3, "rmse": 2.680745456962698, "rmse_stand": 0.33828102561408196}, {"method": "MDS", "var": "TA", "gap_len": 10.0, "idx_rep": 4, "rmse": 1.3269395749489976, "rmse_stand": 0.16744539440542153}, {"method": "KalmanFilter", "var": "TA", "gap_len": 22.5, "idx_rep": 0, "rmse": 0.5864129798979331, "rmse_stand": 0.07399896314588557}, {"method": "KalmanFilter", "var": "TA", "gap_len": 22.5, "idx_rep": 1, "rmse": 0.2843142695520981, "rmse_stand": 0.03587737972324039}, {"method": "KalmanFilter", "var": "TA", "gap_len": 22.5, "idx_rep": 2, "rmse": 0.7435215897867138, "rmse_stand": 0.09382436713862241}, {"method": "KalmanFilter", "var": "TA", "gap_len": 22.5, "idx_rep": 3, "rmse": 0.5667248001907798, "rmse_stand": 0.07151452822629564}, {"method": "KalmanFilter", "var": "TA", "gap_len": 22.5, "idx_rep": 4, "rmse": 0.3841439659959281, "rmse_stand": 0.048474805566879976}, {"method": "ERA", "var": "TA", "gap_len": 22.5, "idx_rep": 0, "rmse": 1.667383605799484, "rmse_stand": 0.21040574173014598}, {"method": "ERA", "var": "TA", "gap_len": 22.5, "idx_rep": 1, "rmse": 1.3032615922284283, "rmse_stand": 0.16445748958276005}, {"method": "ERA", "var": "TA", "gap_len": 22.5, "idx_rep": 2, "rmse": 2.108127357527423, "rmse_stand": 0.26602282688841067}, {"method": "ERA", "var": "TA", "gap_len": 22.5, "idx_rep": 3, "rmse": 0.9962245284628918, "rmse_stand": 0.12571273947514577}, {"method": "ERA", "var": "TA", "gap_len": 22.5, "idx_rep": 4, "rmse": 0.7051317607369562, "rmse_stand": 0.08897998674048677}, {"method": "MDS", "var": "TA", "gap_len": 22.5, "idx_rep": 0, "rmse": 2.285323794678169, "rmse_stand": 0.28838309699120157}, {"method": "MDS", "var": "TA", "gap_len": 22.5, "idx_rep": 1, "rmse": 2.0471406981319173, "rmse_stand": 0.25832697138094185}, {"method": "MDS", "var": "TA", "gap_len": 22.5, "idx_rep": 2, "rmse": 2.372916288158608, "rmse_stand": 0.29943632043459023}, {"method": "MDS", "var": "TA", "gap_len": 22.5, "idx_rep": 3, "rmse": 1.880445459034662, "rmse_stand": 0.2372918386717386}, {"method": "MDS", "var": "TA", "gap_len": 22.5, "idx_rep": 4, "rmse": 2.030413253818859, "rmse_stand": 0.2562161491828004}], "data-90166fd4a71f41e3483e1d308ae1df3f": [{"method": "KalmanFilter", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 0, "rmse": 190.09913902131657, "rmse_stand": 0.9318468267638063}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 1, "rmse": 49.21839339415338, "rmse_stand": 0.24126360560534468}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 2, "rmse": 26.177013703672745, "rmse_stand": 0.12831708380954235}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 3, "rmse": 10.297807264588364, "rmse_stand": 0.05047881369444763}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 4, "rmse": 5.383079865402994, "rmse_stand": 0.026387315148383866}, {"method": "ERA", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 0, "rmse": 226.71763952943755, "rmse_stand": 1.1113470268963015}, {"method": "ERA", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 1, "rmse": 106.967430378597, "rmse_stand": 0.5243435666176098}, {"method": "ERA", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 2, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "ERA", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 3, "rmse": 20.03160425427779, "rmse_stand": 0.09819290584605954}, {"method": "ERA", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 4, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "MDS", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 0, "rmse": 203.68295492825962, "rmse_stand": 0.9984333237537226}, {"method": "MDS", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 1, "rmse": 56.693166616168064, "rmse_stand": 0.2779041908471979}, {"method": "MDS", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 2, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "MDS", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 3, "rmse": 7.710506345616034, "rmse_stand": 0.037796125263349085}, {"method": "MDS", "var": "SW_IN", "gap_len": 2.5, "idx_rep": 4, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 0, "rmse": 47.70346067201218, "rmse_stand": 0.2338375580327166}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 1, "rmse": 29.676779166986936, "rmse_stand": 0.1454725815050958}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 2, "rmse": 32.89706145333922, "rmse_stand": 0.16125808082545082}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 3, "rmse": 51.410734516408716, "rmse_stand": 0.2520102409056148}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 4, "rmse": 21.583705190775863, "rmse_stand": 0.10580114826072233}, {"method": "ERA", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 0, "rmse": 0.3225523213371747, "rmse_stand": 0.0015811189816574696}, {"method": "ERA", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 1, "rmse": 59.8714043805555, "rmse_stand": 0.29348359215691777}, {"method": "ERA", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 2, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "ERA", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 3, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "ERA", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 4, "rmse": 13.338528093459189, "rmse_stand": 0.06538412084126305}, {"method": "MDS", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 0, "rmse": 5.924459982644022, "rmse_stand": 0.02904110593839633}, {"method": "MDS", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 1, "rmse": 39.57447171991995, "rmse_stand": 0.19399007319505107}, {"method": "MDS", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 2, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "MDS", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 3, "rmse": 0.0, "rmse_stand": 0.0}, {"method": "MDS", "var": "SW_IN", "gap_len": 5.0, "idx_rep": 4, "rmse": 17.4763607256079, "rmse_stand": 0.08566735951240262}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 0, "rmse": 113.96809836865074, "rmse_stand": 0.5586601357790674}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 1, "rmse": 114.14234927322714, "rmse_stand": 0.559514296157311}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 2, "rmse": 24.311262989267203, "rmse_stand": 0.11917136178417244}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 3, "rmse": 70.71423825946418, "rmse_stand": 0.34663407140267155}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 4, "rmse": 65.94746344490703, "rmse_stand": 0.32326782152005307}, {"method": "ERA", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 0, "rmse": 128.36896992575737, "rmse_stand": 0.6292517572467384}, {"method": "ERA", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 1, "rmse": 202.27108194697533, "rmse_stand": 0.9915124646473813}, {"method": "ERA", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 2, "rmse": 8.929423209256019, "rmse_stand": 0.04377113292156075}, {"method": "ERA", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 3, "rmse": 63.874882284823045, "rmse_stand": 0.31310823748838557}, {"method": "ERA", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 4, "rmse": 63.59749815519475, "rmse_stand": 0.31174852843173495}, {"method": "MDS", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 0, "rmse": 197.7548021609146, "rmse_stand": 0.9693741161567746}, {"method": "MDS", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 1, "rmse": 126.35930456701931, "rmse_stand": 0.6194005801344254}, {"method": "MDS", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 2, "rmse": 11.69406587379872, "rmse_stand": 0.057323132722049426}, {"method": "MDS", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 3, "rmse": 75.86027950442896, "rmse_stand": 0.37185944711559565}, {"method": "MDS", "var": "SW_IN", "gap_len": 10.0, "idx_rep": 4, "rmse": 93.75999514125422, "rmse_stand": 0.4596020497492653}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 0, "rmse": 123.92483025030573, "rmse_stand": 0.6074670323101339}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 1, "rmse": 66.1532423186051, "rmse_stand": 0.32427652882645003}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 2, "rmse": 34.1542955804012, "rmse_stand": 0.16742091584844634}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 3, "rmse": 52.67158213966747, "rmse_stand": 0.2581907889229028}, {"method": "KalmanFilter", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 4, "rmse": 27.97643102886275, "rmse_stand": 0.13713764624414704}, {"method": "ERA", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 0, "rmse": 166.69426640676306, "rmse_stand": 0.8171184992765513}, {"method": "ERA", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 1, "rmse": 106.04031443936782, "rmse_stand": 0.5197989376915632}, {"method": "ERA", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 2, "rmse": 34.402950433873485, "rmse_stand": 0.1686397968878896}, {"method": "ERA", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 3, "rmse": 70.29130814877944, "rmse_stand": 0.3445609106108163}, {"method": "ERA", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 4, "rmse": 38.020916921259705, "rmse_stand": 0.1863747040945477}, {"method": "MDS", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 0, "rmse": 187.9939061991956, "rmse_stand": 0.921527187574528}, {"method": "MDS", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 1, "rmse": 106.93530013475957, "rmse_stand": 0.5241860673994798}, {"method": "MDS", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 2, "rmse": 29.948687926633866, "rmse_stand": 0.14680545084974791}, {"method": "MDS", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 3, "rmse": 170.95760776247306, "rmse_stand": 0.8380169690654323}, {"method": "MDS", "var": "SW_IN", "gap_len": 22.5, "idx_rep": 4, "rmse": 73.08215120668197, "rmse_stand": 0.35824134209983344}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</section>
<section id="gap-length" class="level3">
<h3 class="anchored" data-anchor-id="gap-length">Gap Length</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 18,20,25,30,40,50,60,70</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>gap_len <span class="op">=</span> ImpComparison(models_var, hai, hai_era, block_len<span class="op">=</span><span class="dv">100</span>).compare(gap_len <span class="op">=</span> <span class="bu">range</span>(<span class="dv">2</span>,<span class="dv">30</span>,<span class="dv">4</span>), var<span class="op">=</span>[<span class="st">'TA'</span>, <span class="st">'SW_IN'</span>, <span class="st">'VPD'</span>], n_rep<span class="op">=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b90833a54d784f82a1db6e76007b68a1","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L542" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="agg_gap_len" class="level3">
<h3 class="anchored" data-anchor-id="agg_gap_len">agg_gap_len</h3>
<blockquote class="blockquote">
<pre><code> agg_gap_len (data)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>gap_len_agg <span class="op">=</span> agg_gap_len(gap_len)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ).with_column(</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     (pl.col("Q3") - pl.col("Q1")).alias("IRQ")</span></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ).with_columns([</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     (pl.col("Q1") - 1.5 * pl.col("IRQ")).alias("min"),</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     (pl.col("Q3") + 1.5 * pl.col("IRQ")).alias("max"),</span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>rmse_df <span class="op">=</span> _get_era_rmse(hai, hai_era)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>gap_len_agg <span class="op">=</span> pd.merge(gap_len_agg, rmse_df, on<span class="op">=</span><span class="st">'var'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>_plot_gap_len(gap_len_agg[gap_len_agg[<span class="st">'var'</span>] <span class="op">==</span> <span class="st">'TA'</span>][gap_len_agg[<span class="st">'method'</span>] <span class="op">==</span> <span class="st">'ERA'</span>], <span class="st">"label"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_101448/837074991.py:1: UserWarning: Boolean Series key will be reindexed to match DataFrame index.
  _plot_gap_len(gap_len_agg[gap_len_agg['var'] == 'TA'][gap_len_agg['method'] == 'ERA'], "label")</code></pre>
</div>
<div class="cell-output cell-output-display">

<div id="altair-viz-88f20e87e36c404f91e173c1125478eb"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-88f20e87e36c404f91e173c1125478eb") {
      outputDiv = document.getElementById("altair-viz-88f20e87e36c404f91e173c1125478eb");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.2.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.2.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "layer": [{"mark": "line", "encoding": {"color": {"field": "var", "scale": {"domain": ["TA", "SW_IN", "LW_IN", "VPD", "WS", "PA", "SWC", "TS", "P"], "range": ["#1B9E77", "#D95F02", "#7570B3", "#E7298A", "#66A61E", "#E6AB02", "#A6761D", "#666666"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0}, "field": "gap_len", "title": "gap_len [h]", "type": "quantitative"}, "y": {"field": "median", "title": "label", "type": "quantitative"}}}, {"mark": "errorband", "encoding": {"color": {"field": "var", "type": "nominal"}, "x": {"field": "gap_len", "type": "quantitative"}, "y": {"field": "Q1", "title": "label", "type": "quantitative"}, "y2": {"field": "Q3"}}}, {"mark": {"type": "rule", "strokeDash": [2, 4]}, "encoding": {"y": {"datum": 1.8708585984196093}}}], "data": {"name": "data-cdc86819f3bcdfceeda47bc569e7489f"}, "height": 150, "width": 200, "$schema": "https://vega.github.io/schema/vega-lite/v5.2.0.json", "datasets": {"data-cdc86819f3bcdfceeda47bc569e7489f": [{"var": "TA", "gap_len": 2, "method": "ERA", "median": 1.1272286813242478, "Q1": 0.5001884644811393, "Q3": 1.1903589794679585, "min": 0.4842354799062128, "max": 3.9334707956205803, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 14, "method": "ERA", "median": 1.315567422391244, "Q1": 0.9636018739233397, "Q3": 2.088141415572368, "min": 0.3690604867188344, "max": 2.093863517178574, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 10, "method": "ERA", "median": 1.0020153192441719, "Q1": 0.9573586579751605, "Q3": 2.579533872621176, "min": 0.8493437466656242, "max": 4.742076950029386, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 6, "method": "ERA", "median": 0.9954016777160867, "Q1": 0.9729612873422387, "Q3": 1.1076475823413632, "min": 0.37736233693008303, "max": 1.1754862114603188, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 22, "method": "ERA", "median": 1.0205632134891365, "Q1": 0.7101659537165815, "Q3": 1.1481187973059552, "min": 0.20299608146688236, "max": 1.6575730478898685, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 26, "method": "ERA", "median": 1.4376500724339112, "Q1": 0.5602046672697124, "Q3": 1.4994901569430963, "min": 0.5262598802288291, "max": 3.97848791338155, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 18, "method": "ERA", "median": 2.353258379354039, "Q1": 2.0901267638324925, "Q3": 3.038045524858229, "min": 1.7848961532195022, "max": 6.661518991774908, "era_rmse": 1.8708585984196093}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>facet_wrap(gap_len_agg[gap_len_agg.method <span class="op">==</span> <span class="st">'KalmanFilter'</span>], _plot_gap_len, <span class="st">'var'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div id="altair-viz-f312fa4691344ea094d6bc1c35089687"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-f312fa4691344ea094d6bc1c35089687") {
      outputDiv = document.getElementById("altair-viz-f312fa4691344ea094d6bc1c35089687");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.2.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.2.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "vconcat": [{"hconcat": [{"layer": [{"mark": "line", "encoding": {"color": {"field": "var", "scale": {"domain": ["TA", "SW_IN", "LW_IN", "VPD", "WS", "PA", "SWC", "TS", "P"], "range": ["#1B9E77", "#D95F02", "#7570B3", "#E7298A", "#66A61E", "#E6AB02", "#A6761D", "#666666"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0}, "field": "gap_len", "title": "gap_len [h]", "type": "quantitative"}, "y": {"field": "median", "title": "VPD", "type": "quantitative"}}}, {"mark": "errorband", "encoding": {"color": {"field": "var", "type": "nominal"}, "x": {"field": "gap_len", "type": "quantitative"}, "y": {"field": "Q1", "title": "VPD", "type": "quantitative"}, "y2": {"field": "Q3"}}}, {"mark": {"type": "rule", "strokeDash": [2, 4]}, "encoding": {"y": {"datum": 2.0213771447538154}}}], "height": 150, "title": "VPD", "width": 200}, {"layer": [{"mark": "line", "encoding": {"color": {"field": "var", "scale": {"domain": ["TA", "SW_IN", "LW_IN", "VPD", "WS", "PA", "SWC", "TS", "P"], "range": ["#1B9E77", "#D95F02", "#7570B3", "#E7298A", "#66A61E", "#E6AB02", "#A6761D", "#666666"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0}, "field": "gap_len", "title": "gap_len [h]", "type": "quantitative"}, "y": {"field": "median", "title": "SW_IN", "type": "quantitative"}}}, {"mark": "errorband", "encoding": {"color": {"field": "var", "type": "nominal"}, "x": {"field": "gap_len", "type": "quantitative"}, "y": {"field": "Q1", "title": "SW_IN", "type": "quantitative"}, "y2": {"field": "Q3"}}}, {"mark": {"type": "rule", "strokeDash": [2, 4]}, "encoding": {"y": {"datum": 76.32033545126399}}}], "data": {"name": "data-9f8a93ae4081e96a3dc7a3cd16d982b5"}, "height": 150, "title": "SW_IN", "width": 200}, {"layer": [{"mark": "line", "encoding": {"color": {"field": "var", "scale": {"domain": ["TA", "SW_IN", "LW_IN", "VPD", "WS", "PA", "SWC", "TS", "P"], "range": ["#1B9E77", "#D95F02", "#7570B3", "#E7298A", "#66A61E", "#E6AB02", "#A6761D", "#666666"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0}, "field": "gap_len", "title": "gap_len [h]", "type": "quantitative"}, "y": {"field": "median", "title": "TA", "type": "quantitative"}}}, {"mark": "errorband", "encoding": {"color": {"field": "var", "type": "nominal"}, "x": {"field": "gap_len", "type": "quantitative"}, "y": {"field": "Q1", "title": "TA", "type": "quantitative"}, "y2": {"field": "Q3"}}}, {"mark": {"type": "rule", "strokeDash": [2, 4]}, "encoding": {"y": {"datum": 1.8708585984196093}}}], "data": {"name": "data-6dc3363b6c91e917022d9587ccfcfb63"}, "height": 150, "title": "TA", "width": 200}]}], "data": {"name": "data-0ef3bf655015f66e5714edc84c840040"}, "resolve": {"scale": {"xOffset": "independent"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.2.0.json", "datasets": {"data-0ef3bf655015f66e5714edc84c840040": [{"var": "VPD", "gap_len": 10, "method": "KalmanFilter", "median": 0.3605661614639632, "Q1": 0.35136619972907635, "Q3": 0.46395317947519515, "min": 0.23891963838031047, "max": 0.6037027150064932, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 14, "method": "KalmanFilter", "median": 0.5989348637219304, "Q1": 0.4974370905305588, "Q3": 0.6396483574456444, "min": 0.1741143220417429, "max": 0.7561332312011135, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 6, "method": "KalmanFilter", "median": 0.42878041927386534, "Q1": 0.25940467647244375, "Q3": 0.5525450786158211, "min": 0.1359355072347983, "max": 0.6294939419450126, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 2, "method": "KalmanFilter", "median": 0.12290399691893641, "Q1": 0.12103198074144896, "Q3": 0.25881270973549364, "min": 0.08189984655453901, "max": 0.36648715046172, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 18, "method": "KalmanFilter", "median": 1.2729181205749251, "Q1": 0.4615642436161817, "Q3": 1.2858047791512703, "min": 0.37659925548446826, "max": 1.370339444032966, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 26, "method": "KalmanFilter", "median": 0.6891155781736783, "Q1": 0.40355494985861373, "Q3": 0.747372292492185, "min": 0.3578558644499335, "max": 0.7552564943103787, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 22, "method": "KalmanFilter", "median": 0.40850307196296454, "Q1": 0.31315145906517605, "Q3": 0.46334184032259135, "min": 0.22236475773067021, "max": 0.8185222889851576, "era_rmse": 2.0213771447538154}], "data-9f8a93ae4081e96a3dc7a3cd16d982b5": [{"var": "SW_IN", "gap_len": 6, "method": "KalmanFilter", "median": 22.114842695507893, "Q1": 16.12927660367226, "Q3": 58.09095845016319, "min": 6.670707494377743, "max": 62.4200319457178, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 18, "method": "KalmanFilter", "median": 31.454074618774648, "Q1": 21.643733797447247, "Q3": 34.49859919766036, "min": 14.837164492269796, "max": 69.02923777254661, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 10, "method": "KalmanFilter", "median": 40.49848532315204, "Q1": 18.73688822775988, "Q3": 74.3515057514631, "min": 8.615819800200308, "max": 88.80409272117284, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 2, "method": "KalmanFilter", "median": 7.388243066122261, "Q1": 4.447138308763487, "Q3": 7.92672620005313, "min": 4.0286246763603994, "max": 18.03763045579744, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 26, "method": "KalmanFilter", "median": 40.10247526138136, "Q1": 38.45375541586152, "Q3": 48.8113959815118, "min": 22.114619148773254, "max": 89.02236493471096, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 22, "method": "KalmanFilter", "median": 36.86766878598706, "Q1": 33.539661404425594, "Q3": 39.70374220742256, "min": 24.932832865127057, "max": 131.6906200706711, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 14, "method": "KalmanFilter", "median": 18.28202697614254, "Q1": 17.135357047047794, "Q3": 35.03887303603277, "min": 16.594718954256525, "max": 61.833408888830526, "era_rmse": 76.32033545126399}], "data-6dc3363b6c91e917022d9587ccfcfb63": [{"var": "TA", "gap_len": 18, "method": "KalmanFilter", "median": 0.7892692799387534, "Q1": 0.7694960591813025, "Q3": 1.0142957738540772, "min": 0.5899143919884873, "max": 1.858187490178607, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 22, "method": "KalmanFilter", "median": 0.40609455540121386, "Q1": 0.32694332937780296, "Q3": 0.43710392559254363, "min": 0.31137162752144654, "max": 1.2928167651580846, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 26, "method": "KalmanFilter", "median": 0.33690196567190084, "Q1": 0.33417968196446857, "Q3": 0.8502822431395163, "min": 0.3310707608222629, "max": 0.8553908535145169, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 6, "method": "KalmanFilter", "median": 0.5544092640092761, "Q1": 0.4321611165108127, "Q3": 0.5993793665554448, "min": 0.4070976095313098, "max": 0.6143150802531336, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 2, "method": "KalmanFilter", "median": 0.1673359958759639, "Q1": 0.12606306889599694, "Q3": 0.1886831137945215, "min": 0.045003115202803375, "max": 0.5227324501653158, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 14, "method": "KalmanFilter", "median": 0.3034634378073511, "Q1": 0.2733425312914704, "Q3": 0.5061523217015034, "min": 0.20807946562886648, "max": 0.9533692973963396, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 10, "method": "KalmanFilter", "median": 0.3181738723488461, "Q1": 0.1914495993388031, "Q3": 0.5098087165163488, "min": 0.15014943720841942, "max": 1.4308844527863829, "era_rmse": 1.8708585984196093}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L578" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_gap_len" class="level3">
<h3 class="anchored" data-anchor-id="plot_gap_len">plot_gap_len</h3>
<blockquote class="blockquote">
<pre><code> plot_gap_len (data, df, control)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>plot_gap_len(gap_len, hai, hai_era)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>ValueError: median encoding field is specified without a type; the type cannot be inferred because it does not match any column in the data.</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>alt.VConcatChart(...)</code></pre>
</div>
</div>
<p>we actually dont care of different methods</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>_plot_gap_len(gap_len_agg, y_label<span class="op">=</span><span class="st">""</span>).facet(column<span class="op">=</span><span class="st">'method'</span>, row<span class="op">=</span><span class="st">'var'</span>).resolve_scale(y<span class="op">=</span><span class="st">'independent'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div id="altair-viz-73fc15ac5977498097514710712bf92d"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-73fc15ac5977498097514710712bf92d") {
      outputDiv = document.getElementById("altair-viz-73fc15ac5977498097514710712bf92d");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.2.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.2.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-3e79937d693199519bb3989173166804"}, "facet": {"column": {"field": "method", "type": "nominal"}, "row": {"field": "var", "type": "nominal"}}, "spec": {"layer": [{"mark": "line", "encoding": {"color": {"field": "var", "scale": {"domain": ["TA", "SW_IN", "LW_IN", "VPD", "WS", "PA", "SWC", "TS", "P"], "range": ["#1B9E77", "#D95F02", "#7570B3", "#E7298A", "#66A61E", "#E6AB02", "#A6761D", "#666666"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0}, "field": "gap_len", "title": "gap_len [h]", "type": "quantitative"}, "y": {"field": "median", "title": "", "type": "quantitative"}}}, {"mark": "errorband", "encoding": {"color": {"field": "var", "type": "nominal"}, "x": {"field": "gap_len", "type": "quantitative"}, "y": {"field": "Q1", "title": "", "type": "quantitative"}, "y2": {"field": "Q3"}}}, {"mark": {"type": "rule", "strokeDash": [2, 4]}, "encoding": {"y": {"datum": 2.0213771447538154}}}], "height": 150, "width": 200}, "resolve": {"scale": {"y": "independent"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.2.0.json", "datasets": {"data-3e79937d693199519bb3989173166804": [{"var": "VPD", "gap_len": 22, "method": "MDS", "median": 0.7364909241812936, "Q1": 0.6531645602744988, "Q3": 0.8704569263929876, "min": 0.4269233536623631, "max": 2.8840375431562766, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 10, "method": "KalmanFilter", "median": 0.3605661614639632, "Q1": 0.35136619972907635, "Q3": 0.46395317947519515, "min": 0.23891963838031047, "max": 0.6037027150064932, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 14, "method": "KalmanFilter", "median": 0.5989348637219304, "Q1": 0.4974370905305588, "Q3": 0.6396483574456444, "min": 0.1741143220417429, "max": 0.7561332312011135, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 26, "method": "MDS", "median": 1.6652676895217595, "Q1": 1.4118046963772772, "Q3": 3.5168436800820255, "min": 0.2889748094996143, "max": 4.163432024859298, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 14, "method": "ERA", "median": 0.5344805221628086, "Q1": 0.42910255184512713, "Q3": 1.6027728873959117, "min": 0.42127781807258735, "max": 2.0552305744820245, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 10, "method": "ERA", "median": 0.4741866721028756, "Q1": 0.278025358555654, "Q3": 1.9470279145405183, "min": 0.0, "max": 2.695353947072629, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 6, "method": "KalmanFilter", "median": 0.42878041927386534, "Q1": 0.25940467647244375, "Q3": 0.5525450786158211, "min": 0.1359355072347983, "max": 0.6294939419450126, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 2, "method": "MDS", "median": 1.1393854307899365, "Q1": 0.7472213197792535, "Q3": 1.3657808888095249, "min": 0.5398347133440518, "max": 1.5736705493911207, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 18, "method": "MDS", "median": 3.4977834683171127, "Q1": 2.0818117616288543, "Q3": 4.507851317191385, "min": 1.8403246060370253, "max": 5.208939043826832, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 2, "method": "KalmanFilter", "median": 0.12290399691893641, "Q1": 0.12103198074144896, "Q3": 0.25881270973549364, "min": 0.08189984655453901, "max": 0.36648715046172, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 6, "method": "MDS", "median": 1.186525020121122, "Q1": 0.42953858914076304, "Q3": 4.500579155770977, "min": 0.08602796277986377, "max": 9.349075064848995, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 18, "method": "KalmanFilter", "median": 1.2729181205749251, "Q1": 0.4615642436161817, "Q3": 1.2858047791512703, "min": 0.37659925548446826, "max": 1.370339444032966, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 22, "method": "ERA", "median": 0.39300242886133546, "Q1": 0.3273686412482529, "Q3": 0.4916517152323473, "min": 0.24738183588790982, "max": 0.6214973853525049, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 26, "method": "ERA", "median": 0.5747599498921268, "Q1": 0.5628745932197576, "Q3": 1.1717935628113656, "min": 0.3632710367671034, "max": 1.638260381295683, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 26, "method": "KalmanFilter", "median": 0.6891155781736783, "Q1": 0.40355494985861373, "Q3": 0.747372292492185, "min": 0.3578558644499335, "max": 0.7552564943103787, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 14, "method": "MDS", "median": 1.0659684951815511, "Q1": 0.7055164290235848, "Q3": 1.3834101113466666, "min": 0.33770685514072807, "max": 3.2759150939987065, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 22, "method": "KalmanFilter", "median": 0.40850307196296454, "Q1": 0.31315145906517605, "Q3": 0.46334184032259135, "min": 0.22236475773067021, "max": 0.8185222889851576, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 10, "method": "MDS", "median": 1.6567363637127752, "Q1": 0.4299250761296341, "Q3": 2.350358755435643, "min": 0.04734071885495621, "max": 3.903995070308658, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 18, "method": "ERA", "median": 1.4571880455178048, "Q1": 1.2445275319484812, "Q3": 1.5447404312699269, "min": 1.0135333958209984, "max": 4.087458725581622, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 2, "method": "ERA", "median": 1.2070149129153294, "Q1": 0.5595270324121973, "Q3": 1.950452255247485, "min": 0.031384709652950406, "max": 4.907029447639376, "era_rmse": 2.0213771447538154}, {"var": "VPD", "gap_len": 6, "method": "ERA", "median": 1.0116697418953808, "Q1": 0.5647934725779562, "Q3": 1.424642879227399, "min": 0.5322715472388131, "max": 4.595073793386421, "era_rmse": 2.0213771447538154}, {"var": "SW_IN", "gap_len": 2, "method": "ERA", "median": 0.0, "Q1": 0.0, "Q3": 0.0, "min": 0.0, "max": 12.361634378188011, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 26, "method": "ERA", "median": 64.19621378423162, "Q1": 45.76997638148329, "Q3": 74.84294226167633, "min": 21.267570432829995, "max": 131.58849123235547, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 22, "method": "ERA", "median": 42.46023435735863, "Q1": 0.0, "Q3": 52.644670622097074, "min": 0.0, "max": 153.91079943147707, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 10, "method": "ERA", "median": 21.30681625912234, "Q1": 0.9157101069661728, "Q3": 61.83232935770737, "min": 0.0, "max": 107.84787972973785, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 18, "method": "MDS", "median": 5.595650943840907, "Q1": 0.0, "Q3": 128.15504004392943, "min": 0.0, "max": 157.28959506052942, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 14, "method": "ERA", "median": 0.0, "Q1": 0.0, "Q3": 8.253610495673133, "min": 0.0, "max": 84.28448573729331, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 6, "method": "MDS", "median": 9.526603251764447, "Q1": 0.0, "Q3": 185.1428202945792, "min": 0.0, "max": 313.32136438304457, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 6, "method": "KalmanFilter", "median": 22.114842695507893, "Q1": 16.12927660367226, "Q3": 58.09095845016319, "min": 6.670707494377743, "max": 62.4200319457178, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 18, "method": "KalmanFilter", "median": 31.454074618774648, "Q1": 21.643733797447247, "Q3": 34.49859919766036, "min": 14.837164492269796, "max": 69.02923777254661, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 26, "method": "MDS", "median": 35.273075689721786, "Q1": 20.36580041318005, "Q3": 119.58139008302992, "min": 13.386830127469654, "max": 221.87387940134087, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 2, "method": "MDS", "median": 4.579968461803106, "Q1": 0.0, "Q3": 18.13302588587404, "min": 0.0, "max": 25.813305892719576, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 22, "method": "MDS", "median": 35.64888354719587, "Q1": 4.645037175376651, "Q3": 60.719796726577606, "min": 1.0552593987131798, "max": 147.63684011449465, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 10, "method": "MDS", "median": 18.404955960486244, "Q1": 5.410294064661893, "Q3": 70.80075896079057, "min": 0.0, "max": 165.86506629652186, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 10, "method": "KalmanFilter", "median": 40.49848532315204, "Q1": 18.73688822775988, "Q3": 74.3515057514631, "min": 8.615819800200308, "max": 88.80409272117284, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 2, "method": "KalmanFilter", "median": 7.388243066122261, "Q1": 4.447138308763487, "Q3": 7.92672620005313, "min": 4.0286246763603994, "max": 18.03763045579744, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 26, "method": "KalmanFilter", "median": 40.10247526138136, "Q1": 38.45375541586152, "Q3": 48.8113959815118, "min": 22.114619148773254, "max": 89.02236493471096, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 22, "method": "KalmanFilter", "median": 36.86766878598706, "Q1": 33.539661404425594, "Q3": 39.70374220742256, "min": 24.932832865127057, "max": 131.6906200706711, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 18, "method": "ERA", "median": 27.264476316873086, "Q1": 0.0, "Q3": 32.31752539515776, "min": 0.0, "max": 115.96314023046769, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 14, "method": "MDS", "median": 0.5410703842517032, "Q1": 0.0, "Q3": 52.26411146034226, "min": 0.0, "max": 75.58556304001937, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 6, "method": "ERA", "median": 0.1824869858373468, "Q1": 0.0, "Q3": 65.76345308249356, "min": 0.0, "max": 185.07142284759507, "era_rmse": 76.32033545126399}, {"var": "SW_IN", "gap_len": 14, "method": "KalmanFilter", "median": 18.28202697614254, "Q1": 17.135357047047794, "Q3": 35.03887303603277, "min": 16.594718954256525, "max": 61.833408888830526, "era_rmse": 76.32033545126399}, {"var": "TA", "gap_len": 18, "method": "KalmanFilter", "median": 0.7892692799387534, "Q1": 0.7694960591813025, "Q3": 1.0142957738540772, "min": 0.5899143919884873, "max": 1.858187490178607, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 6, "method": "MDS", "median": 1.4784348297436394, "Q1": 1.2030200948826912, "Q3": 2.659855998058391, "min": 0.45425585899267634, "max": 3.9193036888042823, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 22, "method": "KalmanFilter", "median": 0.40609455540121386, "Q1": 0.32694332937780296, "Q3": 0.43710392559254363, "min": 0.31137162752144654, "max": 1.2928167651580846, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 26, "method": "KalmanFilter", "median": 0.33690196567190084, "Q1": 0.33417968196446857, "Q3": 0.8502822431395163, "min": 0.3310707608222629, "max": 0.8553908535145169, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 22, "method": "MDS", "median": 1.9591780059590524, "Q1": 1.7085379115401504, "Q3": 2.729915541007495, "min": 1.5000233539608567, "max": 6.550038918965228, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 6, "method": "KalmanFilter", "median": 0.5544092640092761, "Q1": 0.4321611165108127, "Q3": 0.5993793665554448, "min": 0.4070976095313098, "max": 0.6143150802531336, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 2, "method": "ERA", "median": 1.1272286813242478, "Q1": 0.5001884644811393, "Q3": 1.1903589794679585, "min": 0.4842354799062128, "max": 3.9334707956205803, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 26, "method": "MDS", "median": 2.248410233429836, "Q1": 1.216354841994922, "Q3": 4.829910313073221, "min": 1.187838773265977, "max": 5.709268731368027, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 18, "method": "MDS", "median": 1.9656731993647245, "Q1": 0.6776875603588415, "Q3": 2.278252112045248, "min": 0.43569497398567264, "max": 3.5663566393150137, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 14, "method": "ERA", "median": 1.315567422391244, "Q1": 0.9636018739233397, "Q3": 2.088141415572368, "min": 0.3690604867188344, "max": 2.093863517178574, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 10, "method": "ERA", "median": 1.0020153192441719, "Q1": 0.9573586579751605, "Q3": 2.579533872621176, "min": 0.8493437466656242, "max": 4.742076950029386, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 6, "method": "ERA", "median": 0.9954016777160867, "Q1": 0.9729612873422387, "Q3": 1.1076475823413632, "min": 0.37736233693008303, "max": 1.1754862114603188, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 2, "method": "KalmanFilter", "median": 0.1673359958759639, "Q1": 0.12606306889599694, "Q3": 0.1886831137945215, "min": 0.045003115202803375, "max": 0.5227324501653158, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 22, "method": "ERA", "median": 1.0205632134891365, "Q1": 0.7101659537165815, "Q3": 1.1481187973059552, "min": 0.20299608146688236, "max": 1.6575730478898685, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 2, "method": "MDS", "median": 1.8686678758884967, "Q1": 1.523412760309911, "Q3": 4.263428711517779, "min": 0.6114568293919607, "max": 8.930648206227916, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 26, "method": "ERA", "median": 1.4376500724339112, "Q1": 0.5602046672697124, "Q3": 1.4994901569430963, "min": 0.5262598802288291, "max": 3.97848791338155, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 18, "method": "ERA", "median": 2.353258379354039, "Q1": 2.0901267638324925, "Q3": 3.038045524858229, "min": 1.7848961532195022, "max": 6.661518991774908, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 14, "method": "MDS", "median": 1.3680522020637007, "Q1": 0.7465366309432685, "Q3": 1.5336247709294406, "min": 0.7457362757985674, "max": 3.8304106139580067, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 10, "method": "MDS", "median": 3.0698345919704098, "Q1": 2.5246630358453506, "Q3": 3.877640204541465, "min": 0.6895645982156486, "max": 5.116988136477713, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 14, "method": "KalmanFilter", "median": 0.3034634378073511, "Q1": 0.2733425312914704, "Q3": 0.5061523217015034, "min": 0.20807946562886648, "max": 0.9533692973963396, "era_rmse": 1.8708585984196093}, {"var": "TA", "gap_len": 10, "method": "KalmanFilter", "median": 0.3181738723488461, "Q1": 0.1914495993388031, "Q3": 0.5098087165163488, "min": 0.15014943720841942, "max": 1.4308844527863829, "era_rmse": 1.8708585984196093}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</section>
<section id="control" class="level3">
<h3 class="anchored" data-anchor-id="control">Control</h3>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L598" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_compare" class="level3">
<h3 class="anchored" data-anchor-id="plot_compare">plot_compare</h3>
<blockquote class="blockquote">
<pre><code> plot_compare (data, compare, scale_domain=None)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/training.py#L283" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_control" class="level3">
<h3 class="anchored" data-anchor-id="plot_control">plot_control</h3>
<blockquote class="blockquote">
<pre><code> plot_control (data)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>plot_control(k_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>SchemaValidationError: Invalid specification

        altair.vegalite.v5.schema.core.Scale-&gt;0, validating 'type'

        True is not of type 'null'
        True is not of type 'string'
        True is not of type 'number'
        True is not of type 'boolean'
        True is not of type 'object'
        True is not of type 'object'
        </code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L608" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_control_loss" class="level3">
<h3 class="anchored" data-anchor-id="plot_control_loss">plot_control_loss</h3>
<blockquote class="blockquote">
<pre><code> plot_control_loss (data)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>plot_control_loss(k_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L612" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_control_lh" class="level3">
<h3 class="anchored" data-anchor-id="plot_control_lh">plot_control_lh</h3>
<blockquote class="blockquote">
<pre><code> plot_control_lh (data)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>plot_control_lh(k_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="gap-multiple-variables" class="level3">
<h3 class="anchored" data-anchor-id="gap-multiple-variables">Gap Multiple variables</h3>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L616" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_other_var" class="level3">
<h3 class="anchored" data-anchor-id="plot_other_var">plot_other_var</h3>
<blockquote class="blockquote">
<pre><code> plot_other_var (data)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>plot_other_var(k_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="single-var-vs-generic" class="level3">
<h3 class="anchored" data-anchor-id="single-var-vs-generic">Single var vs Generic</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>base_path <span class="op">=</span> here(<span class="st">"analysis/results/trained_14feb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L620" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="l_model-2" class="level3">
<h3 class="anchored" data-anchor-id="l_model-2">l_model</h3>
<blockquote class="blockquote">
<pre><code> l_model (x)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>models_generic <span class="op">=</span> [</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'type'</span>: <span class="st">'Generic'</span>,  <span class="st">'var'</span>: <span class="st">'TA'</span>, <span class="st">'model'</span>: l_model(<span class="st">"1_gap_varying_12-336_v1.pickle"</span>)},</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'type'</span>: <span class="st">'Generic'</span>,  <span class="st">'var'</span>: <span class="st">'SW_IN'</span>, <span class="st">'model'</span>: l_model(<span class="st">"1_gap_varying_12-336_v1.pickle"</span>)},</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'type'</span>: <span class="st">'Only one var'</span>, <span class="st">'var'</span>: <span class="st">'TA'</span>,    <span class="st">'model'</span>: l_model(<span class="st">"TA_specialized_gap_12-336_v2.pickle.pickle"</span>)},</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'type'</span>: <span class="st">'Only one var'</span>, <span class="st">'var'</span>: <span class="st">'SW_IN'</span>, <span class="st">'model'</span>: l_model(<span class="st">"SW_IN_specialized_gap_12-336_v2.pickle.pickle"</span>)},</span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>models_generic <span class="op">=</span> pd.DataFrame.from_records(models_generic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Col:</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>    col_name: <span class="bu">str</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dream_models_TA = [</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     Col('type'),  Col('model'),</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     'only TA',  l_model("trained_4_feb_All_gap_varying_12_v2.pickle"),</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     'generic',  l_model("trained_4_feb_TA_gap_12_v1.pickle"),</span></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tribble ... not for now</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>comp_generic <span class="op">=</span> KalmanImpComparison(models_generic, hai, hai_era, <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>k_results_generic <span class="op">=</span> comp_generic.compare(n_rep <span class="op">=</span><span class="dv">3</span>, gap_len <span class="op">=</span> [<span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">24</span>], var <span class="op">=</span> [<span class="st">'TA'</span>, <span class="st">'SW_IN'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>k_results_generic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L623" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_generic" class="level3">
<h3 class="anchored" data-anchor-id="plot_generic">plot_generic</h3>
<blockquote class="blockquote">
<pre><code> plot_generic (data)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>_plot_compare(k_results_generic, compare<span class="op">=</span><span class="st">'type'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>plot_generic(k_results_generic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="short-gaps-vs-generic" class="level3">
<h3 class="anchored" data-anchor-id="short-gaps-vs-generic">Short gaps vs Generic</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># models_short_gap = [</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     {'type': 'Short gap',  'var': 'TA', 'model': l_model("trained_4_feb_All_gap_varying_12_v2.pickle")},</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     {'type': 'Long gap',  'var': 'TA', 'model': l_model("trained_4_feb_TA_gap_12_v1.pickle")},</span></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ]</span></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a><span class="co"># models_short_gap = pd.DataFrame.from_records(models_short_gap)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="timeseries" class="level3">
<h3 class="anchored" data-anchor-id="timeseries">Timeseries</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>comp_ts <span class="op">=</span> ImpComparison(models <span class="op">=</span> models_var, df <span class="op">=</span> hai, control <span class="op">=</span> hai_era, block_len <span class="op">=</span> <span class="dv">100</span>, rmse<span class="op">=</span><span class="va">False</span>, time_series <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>res_ts <span class="op">=</span> comp_ts.compare(gap_len <span class="op">=</span> [<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>], var<span class="op">=</span>[<span class="st">"TA"</span>, <span class="st">'SW_IN'</span>], n_rep<span class="op">=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>res_ts.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>test_ts <span class="op">=</span> res_ts.query(<span class="st">'method == "KalmanFilter" and var == "TA"'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>row_res <span class="op">=</span> test_ts.iloc[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>pred_all <span class="op">=</span> row_res.pred[<span class="dv">0</span>]</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>targ <span class="op">=</span>  row_res.targ[<span class="dv">0</span>]</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>var <span class="op">=</span> row_res[<span class="st">'var'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(pred_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>targ.mask[var]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(row_res.index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>np.argmin(row_res.targ[<span class="dv">0</span>].mask[<span class="st">'TA'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>row_res.targ[<span class="dv">0</span>].mask[<span class="st">'TA'</span>].index[<span class="dv">47</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L627" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="unnest_predictions" class="level3">
<h3 class="anchored" data-anchor-id="unnest_predictions">unnest_predictions</h3>
<blockquote class="blockquote">
<pre><code> unnest_predictions (row_res:pandas.core.series.Series, ctx_len:int=50)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>unnest_predictions(row_res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>res_ts_plot <span class="op">=</span> pd.concat([unnest_predictions(row) <span class="cf">for</span> _,row <span class="kw">in</span> res_ts.iterrows()])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>plot_points(res_ts_plot.query(<span class="st">'var == "TA" and method == "KalmanFilter" and idx_rep == 0 and gap_len==2.5'</span>), y<span class="op">=</span> <span class="st">"measurement"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>plot_missing_area(res_ts_plot.query(<span class="st">'var == "TA" and method == "KalmanFilter" and idx_rep == 0 and gap_len==2.5'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>plot_line(res_ts_plot.query(<span class="st">'var == "TA" and idx_rep == 0 and gap_len==2.5'</span>), y<span class="op">=</span> <span class="st">"mean"</span>, color<span class="op">=</span><span class="st">'method'</span>, scale<span class="op">=</span>alt.Scale())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>plot_error(res_ts_plot.query(<span class="st">'var == "TA" and idx_rep == 0 and gap_len==2.5'</span>).copy(), y<span class="op">=</span> <span class="st">"mean"</span>, color<span class="op">=</span><span class="st">'method'</span>, scale<span class="op">=</span>alt.Scale())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>_plot_timeseries(res_ts_plot.query(<span class="st">'var == "TA" and idx_rep == 0 and gap_len==2.5'</span>).copy(), <span class="st">"TA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>_plot_timeseries(res_ts_plot.query(<span class="st">'var == "SW_IN" and idx_rep == 0 and gap_len==10'</span>).copy(), <span class="st">"SW_IN"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>data_ts <span class="op">=</span> pd.concat([unnest_predictions(row) <span class="cf">for</span> _,row <span class="kw">in</span> res_ts.iterrows()])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L674" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_timeseries" class="level3">
<h3 class="anchored" data-anchor-id="plot_timeseries">plot_timeseries</h3>
<blockquote class="blockquote">
<pre><code> plot_timeseries (data, idx_rep:int|None=None, gap_len:int|None=None,
                  max_idx:int=3, ctx_len={6.0: 50, 12.0: 50, 168.0: 384},
                  scale_color=Scale({   domain: ['KalmanFilter', 'ERA',
                  'MDS'],   scheme: 'dark2' }), compare='method')</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>plot_timeseries(res_ts, idx_rep<span class="op">=</span><span class="st">'random'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="scatter-plot" class="level3">
<h3 class="anchored" data-anchor-id="scatter-plot">Scatter plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>data_ts.query(<span class="st">'var == "TA" and gap_len==2.5'</span>).copy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>_plot_scatter(data_ts.query(<span class="st">'var == "TA" and gap_len==10 and idx_rep ==0'</span>).copy(), x<span class="op">=</span><span class="st">"measurement"</span>, y<span class="op">=</span> <span class="st">"mean"</span>, color<span class="op">=</span><span class="st">'method'</span>, scale<span class="op">=</span>alt.Scale())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="table" class="level2">
<h2 class="anchored" data-anchor-id="table">Table</h2>
<section id="the-table" class="level3">
<h3 class="anchored" data-anchor-id="the-table">The Table</h3>
<p>A table where in the rows there is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> data_results.groupby([<span class="st">'method'</span>, <span class="st">'var'</span>, <span class="st">'gap_len'</span>]).agg({<span class="st">'rmse'</span>: [<span class="st">'mean'</span>, <span class="st">'std'</span>]}).unstack(level<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>t_idx <span class="op">=</span> t.columns.droplevel()</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>t_idx.names <span class="op">=</span> [<span class="st">'RMSE'</span>, <span class="va">None</span>]</span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>t2 <span class="op">=</span> t.copy()</span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a>t2.columns <span class="op">=</span> t_idx</span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a>t2 <span class="op">=</span> t2.sort_index(axis<span class="op">=</span><span class="dv">1</span>, level<span class="op">=</span><span class="dv">1</span>).swaplevel(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a>t2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'data_results' is not defined</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>row <span class="op">=</span> t2.iloc[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 't2' is not defined</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>row</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'row' is not defined</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>np.argmin(row.iloc[[<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">4</span>]]) <span class="op">*</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'row' is not defined</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L716" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="style_the_table" class="level3">
<h3 class="anchored" data-anchor-id="style_the_table">style_the_table</h3>
<blockquote class="blockquote">
<pre><code> style_the_table (style, cols=[0, 2, 4])</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L712" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="highlight_min_method" class="level3">
<h3 class="anchored" data-anchor-id="highlight_min_method">highlight_min_method</h3>
<blockquote class="blockquote">
<pre><code> highlight_min_method (row, props, cols)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #| export</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="co"># renames_table_latex = {name: f"\parbox{{2.1cm}}</span><span class="re">{{{</span><span class="co">val</span><span class="re">}}}</span><span class="co">" for name, val in </span></span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                  {'SW_IN': "Shortwave radiation incoming \\textbf{SW IN} [\si{W/m^2}]",</span></span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                'LW_IN': 'Longwave radiation incoming \\textbf{LW IN} [$W/m^2$]',</span></span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                'TA': "Air Temperature \\textbf{TA} [$C$]",</span></span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                'VPD': "Vapuour Pressure Deficit \\textbf{VPD} [$hPa$]",</span></span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                'PA': "Air Pressure \\textbf{PA} [$hPa$]",</span></span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                'P': "Precipitation \\textbf{P} [$mm$]",</span></span>
<span id="cb216-9"><a href="#cb216-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                'WS': "Wind Speed \\textbf{WS} [$m/s$]",</span></span>
<span id="cb216-10"><a href="#cb216-10" aria-hidden="true" tabindex="-1"></a><span class="co">#           }.items()}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>t2.style.pipe(style_the_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>t3 <span class="op">=</span> t2.rename(index <span class="op">=</span> renames_table_latex).style.<span class="bu">apply</span>(highlight_min_method, props<span class="op">=</span><span class="st">"font-weight: bold"</span>, axis<span class="op">=</span><span class="dv">1</span>).format_index(precision<span class="op">=</span><span class="dv">0</span>).<span class="bu">format</span>(precision<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>t3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(t3.to_latex(convert_css<span class="op">=</span><span class="va">True</span>, hrules<span class="op">=</span><span class="va">True</span>, clines<span class="op">=</span><span class="st">"skip-last;data"</span>, column_format<span class="op">=</span><span class="st">"p</span><span class="sc">{2.1cm}</span><span class="st">c|rr|rr|rr"</span>, caption<span class="op">=</span><span class="st">"caption"</span>, label<span class="op">=</span><span class="st">"table"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L747" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="the_table" class="level3">
<h3 class="anchored" data-anchor-id="the_table">the_table</h3>
<blockquote class="blockquote">
<pre><code> the_table (data, y='rmse', y_name='RMSE')</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>the_table(data_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L757" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="the_table_latex" class="level3">
<h3 class="anchored" data-anchor-id="the_table_latex">the_table_latex</h3>
<blockquote class="blockquote">
<pre><code> the_table_latex (table, file, caption='', label='', stand=False)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>the_table_latex(the_table(data_results), <span class="st">"test_table.tex"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="table-compare" class="level3">
<h3 class="anchored" data-anchor-id="table-compare">Table compare</h3>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L768" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="table_compare" class="level3">
<h3 class="anchored" data-anchor-id="table_compare">table_compare</h3>
<blockquote class="blockquote">
<pre><code> table_compare (data, compare:str, y='rmse_stand', compare_ascending=True)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>table_compare(k_results, <span class="st">'use_control'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">use_control</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">False</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">True</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">RMSE Standardized</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">diff.</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">Variable</th>
<th data-quarto-table-cell-role="th">Gap [$h$]</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">TA</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.071531</td>
<td>0.080346</td>
<td>0.042377</td>
<td>0.031936</td>
<td>0.029154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.254662</td>
<td>0.154330</td>
<td>0.079730</td>
<td>0.044252</td>
<td>0.174932</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.518039</td>
<td>0.435547</td>
<td>0.127106</td>
<td>0.091420</td>
<td>0.390933</td>
</tr>
<tr class="even">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">SW_IN</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.126355</td>
<td>0.103091</td>
<td>0.302880</td>
<td>0.222587</td>
<td>0.176525</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.531083</td>
<td>0.468922</td>
<td>0.259730</td>
<td>0.144197</td>
<td>0.271353</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.651510</td>
<td>0.359853</td>
<td>0.309855</td>
<td>0.252639</td>
<td>0.341655</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">LW_IN</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.117033</td>
<td>0.081575</td>
<td>0.218013</td>
<td>0.157215</td>
<td>0.100980</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.260864</td>
<td>0.127380</td>
<td>0.210059</td>
<td>0.164418</td>
<td>0.050804</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.648803</td>
<td>0.225924</td>
<td>0.531998</td>
<td>0.237676</td>
<td>0.116805</td>
</tr>
<tr class="even">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">VPD</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.080883</td>
<td>0.040920</td>
<td>0.061606</td>
<td>0.016222</td>
<td>0.019277</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.206404</td>
<td>0.118284</td>
<td>0.079571</td>
<td>0.051189</td>
<td>0.126833</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.386051</td>
<td>0.262311</td>
<td>0.250002</td>
<td>0.192650</td>
<td>0.136050</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">WS</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.300485</td>
<td>0.158529</td>
<td>0.502712</td>
<td>0.560973</td>
<td>0.202226</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.533166</td>
<td>0.333133</td>
<td>0.456949</td>
<td>0.250417</td>
<td>0.076217</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.576789</td>
<td>0.276542</td>
<td>0.572316</td>
<td>0.360507</td>
<td>0.004473</td>
</tr>
<tr class="even">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">PA</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.053446</td>
<td>0.045544</td>
<td>0.034332</td>
<td>0.014184</td>
<td>0.019114</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.154374</td>
<td>0.070122</td>
<td>0.104465</td>
<td>0.080144</td>
<td>0.049909</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.388000</td>
<td>0.335828</td>
<td>0.080165</td>
<td>0.059638</td>
<td>0.307834</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">P</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.057974</td>
<td>0.046056</td>
<td>0.471970</td>
<td>0.828965</td>
<td>0.413996</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.453741</td>
<td>0.447474</td>
<td>0.252101</td>
<td>0.107018</td>
<td>0.201640</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.452073</td>
<td>0.504036</td>
<td>0.436604</td>
<td>0.381016</td>
<td>0.015469</td>
</tr>
<tr class="even">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">SWC</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.057809</td>
<td>0.039351</td>
<td>0.037269</td>
<td>0.029069</td>
<td>0.020541</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.260036</td>
<td>0.172584</td>
<td>0.039388</td>
<td>0.030187</td>
<td>0.220648</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.383962</td>
<td>0.195432</td>
<td>0.270892</td>
<td>0.302199</td>
<td>0.113070</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">TS</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.120985</td>
<td>0.071894</td>
<td>0.059529</td>
<td>0.015747</td>
<td>0.061456</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.422910</td>
<td>0.397447</td>
<td>0.213845</td>
<td>0.156284</td>
<td>0.209065</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.887094</td>
<td>1.348264</td>
<td>0.246851</td>
<td>0.171585</td>
<td>0.640243</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">RMSE Standardized</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">diff.</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">use_control</th>
<th data-quarto-table-cell-role="th">False</th>
<th data-quarto-table-cell-role="th">False</th>
<th data-quarto-table-cell-role="th">True</th>
<th data-quarto-table-cell-role="th">True</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">Variable</th>
<th data-quarto-table-cell-role="th">Gap [$h$]</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">TA</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.071531</td>
<td>0.080346</td>
<td>0.042377</td>
<td>0.031936</td>
<td>0.029154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.254662</td>
<td>0.154330</td>
<td>0.079730</td>
<td>0.044252</td>
<td>0.174932</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.518039</td>
<td>0.435547</td>
<td>0.127106</td>
<td>0.091420</td>
<td>0.390933</td>
</tr>
<tr class="even">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">SW_IN</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.126355</td>
<td>0.103091</td>
<td>0.302880</td>
<td>0.222587</td>
<td>0.176525</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.531083</td>
<td>0.468922</td>
<td>0.259730</td>
<td>0.144197</td>
<td>0.271353</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.651510</td>
<td>0.359853</td>
<td>0.309855</td>
<td>0.252639</td>
<td>0.341655</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">LW_IN</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.117033</td>
<td>0.081575</td>
<td>0.218013</td>
<td>0.157215</td>
<td>0.100980</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.260864</td>
<td>0.127380</td>
<td>0.210059</td>
<td>0.164418</td>
<td>0.050804</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.648803</td>
<td>0.225924</td>
<td>0.531998</td>
<td>0.237676</td>
<td>0.116805</td>
</tr>
<tr class="even">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">VPD</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.080883</td>
<td>0.040920</td>
<td>0.061606</td>
<td>0.016222</td>
<td>0.019277</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.206404</td>
<td>0.118284</td>
<td>0.079571</td>
<td>0.051189</td>
<td>0.126833</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.386051</td>
<td>0.262311</td>
<td>0.250002</td>
<td>0.192650</td>
<td>0.136050</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">WS</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.300485</td>
<td>0.158529</td>
<td>0.502712</td>
<td>0.560973</td>
<td>0.202226</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.533166</td>
<td>0.333133</td>
<td>0.456949</td>
<td>0.250417</td>
<td>0.076217</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.576789</td>
<td>0.276542</td>
<td>0.572316</td>
<td>0.360507</td>
<td>0.004473</td>
</tr>
<tr class="even">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">PA</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.053446</td>
<td>0.045544</td>
<td>0.034332</td>
<td>0.014184</td>
<td>0.019114</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.154374</td>
<td>0.070122</td>
<td>0.104465</td>
<td>0.080144</td>
<td>0.049909</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.388000</td>
<td>0.335828</td>
<td>0.080165</td>
<td>0.059638</td>
<td>0.307834</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">P</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.057974</td>
<td>0.046056</td>
<td>0.471970</td>
<td>0.828965</td>
<td>0.413996</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.453741</td>
<td>0.447474</td>
<td>0.252101</td>
<td>0.107018</td>
<td>0.201640</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.452073</td>
<td>0.504036</td>
<td>0.436604</td>
<td>0.381016</td>
<td>0.015469</td>
</tr>
<tr class="even">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">SWC</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.057809</td>
<td>0.039351</td>
<td>0.037269</td>
<td>0.029069</td>
<td>0.020541</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.260036</td>
<td>0.172584</td>
<td>0.039388</td>
<td>0.030187</td>
<td>0.220648</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.383962</td>
<td>0.195432</td>
<td>0.270892</td>
<td>0.302199</td>
<td>0.113070</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">TS</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.120985</td>
<td>0.071894</td>
<td>0.059529</td>
<td>0.015747</td>
<td>0.061456</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.422910</td>
<td>0.397447</td>
<td>0.213845</td>
<td>0.156284</td>
<td>0.209065</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.887094</td>
<td>1.348264</td>
<td>0.246851</td>
<td>0.171585</td>
<td>0.640243</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>d.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>MultiIndex([('mean', False),
            ( 'std', False),
            ('mean',  True),
            ( 'std',  True),
            (    '',    '')],
           names=['RMSE Standardized', 'use_control'])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>d.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>MultiIndex([('rmse_stand', 'mean', False),
            ('rmse_stand', 'mean',  True),
            ('rmse_stand',  'std', False),
            ('rmse_stand',  'std',  True)],
           names=[None, None, 'use_control'])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>d.iloc[:, <span class="dv">0</span>] <span class="op">-</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">rmse_stand</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">mean</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">use_control</th>
<th data-quarto-table-cell-role="th">False</th>
<th data-quarto-table-cell-role="th">True</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">var</th>
<th data-quarto-table-cell-role="th">gap_len</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">TA</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.071531</td>
<td>0.042377</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.254662</td>
<td>0.079730</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.518039</td>
<td>0.127106</td>
</tr>
<tr class="even">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">SW_IN</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.126355</td>
<td>0.302880</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.531083</td>
<td>0.259730</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.651510</td>
<td>0.309855</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">LW_IN</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.117033</td>
<td>0.218013</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.260864</td>
<td>0.210059</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.648803</td>
<td>0.531998</td>
</tr>
<tr class="even">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">VPD</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.080883</td>
<td>0.061606</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.206404</td>
<td>0.079571</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.386051</td>
<td>0.250002</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">WS</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.300485</td>
<td>0.502712</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.533166</td>
<td>0.456949</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.576789</td>
<td>0.572316</td>
</tr>
<tr class="even">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">PA</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.053446</td>
<td>0.034332</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.154374</td>
<td>0.104465</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.388000</td>
<td>0.080165</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">P</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.057974</td>
<td>0.471970</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.453741</td>
<td>0.252101</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.452073</td>
<td>0.436604</td>
</tr>
<tr class="even">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">SWC</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.057809</td>
<td>0.037269</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.260036</td>
<td>0.039388</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.383962</td>
<td>0.270892</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">TS</td>
<td data-quarto-table-cell-role="th">3.0</td>
<td>0.120985</td>
<td>0.059529</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6.0</td>
<td>0.422910</td>
<td>0.213845</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12.0</td>
<td>0.887094</td>
<td>0.246851</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L781" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="table_compare_latex" class="level3">
<h3 class="anchored" data-anchor-id="table_compare_latex">table_compare_latex</h3>
<blockquote class="blockquote">
<pre><code> table_compare_latex (table, file, caption='', label='')</code></pre>
</blockquote>
</section>
<section id="table-gap-single" class="level3">
<h3 class="anchored" data-anchor-id="table-gap-single">Table gap single</h3>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L790" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="table_compare3" class="level3">
<h3 class="anchored" data-anchor-id="table_compare3">table_compare3</h3>
<blockquote class="blockquote">
<pre><code> table_compare3 (data, compare:str, y='rmse_stand',
                 compare_ascending=True)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L799" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="table_compare3_latex" class="level3">
<h3 class="anchored" data-anchor-id="table_compare3_latex">table_compare3_latex</h3>
<blockquote class="blockquote">
<pre><code> table_compare3_latex (table, file, caption='', label='')</code></pre>
</blockquote>
</section>
<section id="gap-len-table" class="level3">
<h3 class="anchored" data-anchor-id="gap-len-table">Gap len table</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> gap_len.groupby([<span class="st">'var'</span>, <span class="st">'gap_len'</span>]).agg({<span class="st">'rmse'</span>: [<span class="st">'mean'</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>(g.droplevel(level<span class="op">=</span><span class="dv">0</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a> .reset_index()</span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a> .melt(id_vars<span class="op">=</span>[<span class="st">'var'</span>, <span class="st">'gap_len'</span>], var_name<span class="op">=</span><span class="st">'rmse'</span>)</span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a> .pivot(index <span class="op">=</span> [<span class="st">'var'</span>, <span class="st">'rmse'</span>], columns<span class="op">=</span>[<span class="st">'gap_len'</span>])</span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a> .droplevel(level<span class="op">=</span><span class="dv">0</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>g.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L808" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="table_gap_len" class="level3">
<h3 class="anchored" data-anchor-id="table_gap_len">table_gap_len</h3>
<blockquote class="blockquote">
<pre><code> table_gap_len (data, y='rmse')</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>table_gap_len(gap_len)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'gap_len' is not defined</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/mone27/meteo_imp/blob/master/meteo_imp/kalman/results.py#L824" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="table_gap_len_latex" class="level3">
<h3 class="anchored" data-anchor-id="table_gap_len_latex">table_gap_len_latex</h3>
<blockquote class="blockquote">
<pre><code> table_gap_len_latex (table, file, caption='', label='')</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>[<span class="ss">f"</span><span class="sc">{</span>col<span class="sc">:.0f}</span><span class="ss">"</span> <span class="cf">for</span> col <span class="kw">in</span> <span class="bu">list</span>(table_gap_len(gap_len).columns)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>['1', '3', '5', '7', '9', '11', '13']</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>table_gap_len_latex(table_gap_len(gap_len), <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_cf270_row0_col2, #T_cf270_row1_col0, #T_cf270_row3_col0 {
  font-weight: bold;
}
</style>

<table id="T_cf270" data-quarto-postprocess="true" class="table table-sm table-striped">
<thead>
<tr class="header">
<th class="blank" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_cf270_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">1</th>
<th id="T_cf270_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">3</th>
<th id="T_cf270_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">5</th>
<th id="T_cf270_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">7</th>
<th id="T_cf270_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">9</th>
<th id="T_cf270_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">11</th>
<th id="T_cf270_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">13</th>
</tr>
<tr class="odd">
<th class="index_name level0" data-quarto-table-cell-role="th">Variable</th>
<th class="index_name level1" data-quarto-table-cell-role="th">RMSE</th>
<th class="blank col0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col1" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col2" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col3" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col4" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col5" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col6" data-quarto-table-cell-role="th">&nbsp;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_cf270_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">\parbox{2.1cm}{\textbf{TA} [\si{C}]}</td>
<td id="T_cf270_level1_row0" class="row_heading level1 row0" data-quarto-table-cell-role="th">mean</td>
<td id="T_cf270_row0_col0" class="data row0 col0">1.452</td>
<td id="T_cf270_row0_col1" class="data row0 col1">1.617</td>
<td id="T_cf270_row0_col2" class="data row0 col2">1.169</td>
<td id="T_cf270_row0_col3" class="data row0 col3">1.900</td>
<td id="T_cf270_row0_col4" class="data row0 col4">1.600</td>
<td id="T_cf270_row0_col5" class="data row0 col5">1.656</td>
<td id="T_cf270_row0_col6" class="data row0 col6">0.980</td>
</tr>
<tr class="even">
<td id="T_cf270_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">\parbox{2.1cm}{\textbf{SW\_IN} [\si{W/m^2}]}</td>
<td id="T_cf270_level1_row1" class="row_heading level1 row1" data-quarto-table-cell-role="th">mean</td>
<td id="T_cf270_row1_col0" class="data row1 col0">32.173</td>
<td id="T_cf270_row1_col1" class="data row1 col1">47.047</td>
<td id="T_cf270_row1_col2" class="data row1 col2">61.438</td>
<td id="T_cf270_row1_col3" class="data row1 col3">33.085</td>
<td id="T_cf270_row1_col4" class="data row1 col4">48.179</td>
<td id="T_cf270_row1_col5" class="data row1 col5">40.442</td>
<td id="T_cf270_row1_col6" class="data row1 col6">48.532</td>
</tr>
<tr class="odd">
<td id="T_cf270_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">\parbox{2.1cm}{\textbf{LW\_IN} [\si{W/m^2}]}</td>
<td id="T_cf270_level1_row2" class="row_heading level1 row2" data-quarto-table-cell-role="th">mean</td>
<td id="T_cf270_row2_col0" class="data row2 col0">-</td>
<td id="T_cf270_row2_col1" class="data row2 col1">-</td>
<td id="T_cf270_row2_col2" class="data row2 col2">-</td>
<td id="T_cf270_row2_col3" class="data row2 col3">-</td>
<td id="T_cf270_row2_col4" class="data row2 col4">-</td>
<td id="T_cf270_row2_col5" class="data row2 col5">-</td>
<td id="T_cf270_row2_col6" class="data row2 col6">-</td>
</tr>
<tr class="even">
<td id="T_cf270_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">\parbox{2.1cm}{\textbf{VPD} [\si{hPa}]}</td>
<td id="T_cf270_level1_row3" class="row_heading level1 row3" data-quarto-table-cell-role="th">mean</td>
<td id="T_cf270_row3_col0" class="data row3 col0">1.162</td>
<td id="T_cf270_row3_col1" class="data row3 col1">0.725</td>
<td id="T_cf270_row3_col2" class="data row3 col2">1.526</td>
<td id="T_cf270_row3_col3" class="data row3 col3">1.711</td>
<td id="T_cf270_row3_col4" class="data row3 col4">2.078</td>
<td id="T_cf270_row3_col5" class="data row3 col5">1.284</td>
<td id="T_cf270_row3_col6" class="data row3 col6">1.759</td>
</tr>
<tr class="odd">
<td id="T_cf270_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">\parbox{2.1cm}{\textbf{WS} [\si{m/s}]}</td>
<td id="T_cf270_level1_row4" class="row_heading level1 row4" data-quarto-table-cell-role="th">mean</td>
<td id="T_cf270_row4_col0" class="data row4 col0">-</td>
<td id="T_cf270_row4_col1" class="data row4 col1">-</td>
<td id="T_cf270_row4_col2" class="data row4 col2">-</td>
<td id="T_cf270_row4_col3" class="data row4 col3">-</td>
<td id="T_cf270_row4_col4" class="data row4 col4">-</td>
<td id="T_cf270_row4_col5" class="data row4 col5">-</td>
<td id="T_cf270_row4_col6" class="data row4 col6">-</td>
</tr>
<tr class="even">
<td id="T_cf270_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">\parbox{2.1cm}{\textbf{PA} [\si{hPa}]}</td>
<td id="T_cf270_level1_row5" class="row_heading level1 row5" data-quarto-table-cell-role="th">mean</td>
<td id="T_cf270_row5_col0" class="data row5 col0">-</td>
<td id="T_cf270_row5_col1" class="data row5 col1">-</td>
<td id="T_cf270_row5_col2" class="data row5 col2">-</td>
<td id="T_cf270_row5_col3" class="data row5 col3">-</td>
<td id="T_cf270_row5_col4" class="data row5 col4">-</td>
<td id="T_cf270_row5_col5" class="data row5 col5">-</td>
<td id="T_cf270_row5_col6" class="data row5 col6">-</td>
</tr>
<tr class="odd">
<td id="T_cf270_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">\parbox{2.1cm}{\textbf{P} [\si{mm}]}</td>
<td id="T_cf270_level1_row6" class="row_heading level1 row6" data-quarto-table-cell-role="th">mean</td>
<td id="T_cf270_row6_col0" class="data row6 col0">-</td>
<td id="T_cf270_row6_col1" class="data row6 col1">-</td>
<td id="T_cf270_row6_col2" class="data row6 col2">-</td>
<td id="T_cf270_row6_col3" class="data row6 col3">-</td>
<td id="T_cf270_row6_col4" class="data row6 col4">-</td>
<td id="T_cf270_row6_col5" class="data row6 col5">-</td>
<td id="T_cf270_row6_col6" class="data row6 col6">-</td>
</tr>
<tr class="even">
<td id="T_cf270_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">\parbox{2.1cm}{\textbf{SWC} [\si{\%}]}</td>
<td id="T_cf270_level1_row7" class="row_heading level1 row7" data-quarto-table-cell-role="th">mean</td>
<td id="T_cf270_row7_col0" class="data row7 col0">-</td>
<td id="T_cf270_row7_col1" class="data row7 col1">-</td>
<td id="T_cf270_row7_col2" class="data row7 col2">-</td>
<td id="T_cf270_row7_col3" class="data row7 col3">-</td>
<td id="T_cf270_row7_col4" class="data row7 col4">-</td>
<td id="T_cf270_row7_col5" class="data row7 col5">-</td>
<td id="T_cf270_row7_col6" class="data row7 col6">-</td>
</tr>
<tr class="odd">
<td id="T_cf270_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">\parbox{2.1cm}{\textbf{TS} [\si{C}]}</td>
<td id="T_cf270_level1_row8" class="row_heading level1 row8" data-quarto-table-cell-role="th">mean</td>
<td id="T_cf270_row8_col0" class="data row8 col0">-</td>
<td id="T_cf270_row8_col1" class="data row8 col1">-</td>
<td id="T_cf270_row8_col2" class="data row8 col2">-</td>
<td id="T_cf270_row8_col3" class="data row8 col3">-</td>
<td id="T_cf270_row8_col4" class="data row8 col4">-</td>
<td id="T_cf270_row8_col5" class="data row8 col5">-</td>
<td id="T_cf270_row8_col6" class="data row8 col6">-</td>
</tr>
</tbody>
</table>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script type="application/vnd.jupyter.widget-state+json">
{"state":{},"version_major":2,"version_minor":0}
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>